<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"shayne007.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.23.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="IntroductionRedis supports multiple deployment modes, each designed for different use cases, scalability requirements, and availability needs. Understanding these modes is crucial for designing robust">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis Deployment Modes: Theory, Practice, and Interview Insights">
<meta property="og:url" content="https://shayne007.github.io/2025/06/10/Redis-Deployment-Modes-Theory-Practice-and-Interview-Insights/index.html">
<meta property="og:site_name" content="Charlie Feng&#39;s Tech Space">
<meta property="og:description" content="IntroductionRedis supports multiple deployment modes, each designed for different use cases, scalability requirements, and availability needs. Understanding these modes is crucial for designing robust">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-06-10T08:21:06.000Z">
<meta property="article:modified_time" content="2025-06-10T09:17:39.321Z">
<meta property="article:author" content="Charlie Feng">
<meta property="article:tag" content="redis">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://shayne007.github.io/2025/06/10/Redis-Deployment-Modes-Theory-Practice-and-Interview-Insights/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://shayne007.github.io/2025/06/10/Redis-Deployment-Modes-Theory-Practice-and-Interview-Insights/","path":"2025/06/10/Redis-Deployment-Modes-Theory-Practice-and-Interview-Insights/","title":"Redis Deployment Modes: Theory, Practice, and Interview Insights"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Redis Deployment Modes: Theory, Practice, and Interview Insights | Charlie Feng's Tech Space</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"cdn":false,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.5.0/mermaid.min.js","integrity":"sha256-2obLuIPcceEhkE3G09G33hBdmE55ivVcZUlcKcGNHjU="}}</script>
  <script src="/js/third-party/tags/mermaid.js" defer></script>





  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Charlie Feng's Tech Space</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">You will survive with skills</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Introduction"><span class="nav-number">1.</span> <span class="nav-text">Introduction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Standalone-Redis"><span class="nav-number">2.</span> <span class="nav-text">Standalone Redis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Overview"><span class="nav-number">2.1.</span> <span class="nav-text">Overview</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Architecture"><span class="nav-number">2.2.</span> <span class="nav-text">Architecture</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Configuration-Example"><span class="nav-number">2.3.</span> <span class="nav-text">Configuration Example</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Best-Practices"><span class="nav-number">2.4.</span> <span class="nav-text">Best Practices</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Limitations-and-Use-Cases"><span class="nav-number">2.5.</span> <span class="nav-text">Limitations and Use Cases</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RDB-Operation-Impact-Analysis"><span class="nav-number">2.6.</span> <span class="nav-text">RDB Operation Impact Analysis</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Redis-Replication-Master-Slave"><span class="nav-number">3.</span> <span class="nav-text">Redis Replication (Master-Slave)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Overview-1"><span class="nav-number">3.1.</span> <span class="nav-text">Overview</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Architecture-1"><span class="nav-number">3.2.</span> <span class="nav-text">Architecture</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Configuration"><span class="nav-number">3.3.</span> <span class="nav-text">Configuration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Replication-Process-Flow"><span class="nav-number">3.4.</span> <span class="nav-text">Replication Process Flow</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Best-Practices-1"><span class="nav-number">3.5.</span> <span class="nav-text">Best Practices</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Production-Showcase"><span class="nav-number">3.6.</span> <span class="nav-text">Production Showcase</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Redis-Sentinel"><span class="nav-number">4.</span> <span class="nav-text">Redis Sentinel</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Overview-2"><span class="nav-number">4.1.</span> <span class="nav-text">Overview</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Architecture-2"><span class="nav-number">4.2.</span> <span class="nav-text">Architecture</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sentinel-Configuration"><span class="nav-number">4.3.</span> <span class="nav-text">Sentinel Configuration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Failover-Process"><span class="nav-number">4.4.</span> <span class="nav-text">Failover Process</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Best-Practices-2"><span class="nav-number">4.5.</span> <span class="nav-text">Best Practices</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Production-Monitoring-Script"><span class="nav-number">4.6.</span> <span class="nav-text">Production Monitoring Script</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Redis-Cluster"><span class="nav-number">5.</span> <span class="nav-text">Redis Cluster</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Overview-3"><span class="nav-number">5.1.</span> <span class="nav-text">Overview</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Architecture-3"><span class="nav-number">5.2.</span> <span class="nav-text">Architecture</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hash-Slot-Distribution"><span class="nav-number">5.3.</span> <span class="nav-text">Hash Slot Distribution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cluster-Configuration"><span class="nav-number">5.4.</span> <span class="nav-text">Cluster Configuration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Data-Distribution-and-Client-Routing"><span class="nav-number">5.5.</span> <span class="nav-text">Data Distribution and Client Routing</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Advanced-Operations"><span class="nav-number">5.6.</span> <span class="nav-text">Advanced Operations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Client-Implementation-Best-Practices"><span class="nav-number">5.7.</span> <span class="nav-text">Client Implementation Best Practices</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Limitations-and-Considerations"><span class="nav-number">5.8.</span> <span class="nav-text">Limitations and Considerations</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Deployment-Architecture-Comparison"><span class="nav-number">6.</span> <span class="nav-text">Deployment Architecture Comparison</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Feature-Matrix"><span class="nav-number">6.1.</span> <span class="nav-text">Feature Matrix</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Decision-Flow-Chart"><span class="nav-number">6.2.</span> <span class="nav-text">Decision Flow Chart</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Production-Considerations"><span class="nav-number">7.</span> <span class="nav-text">Production Considerations</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Hardware-Sizing-Guidelines"><span class="nav-number">7.1.</span> <span class="nav-text">Hardware Sizing Guidelines</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Security-Best-Practices"><span class="nav-number">7.2.</span> <span class="nav-text">Security Best Practices</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Backup-and-Recovery-Strategy"><span class="nav-number">7.3.</span> <span class="nav-text">Backup and Recovery Strategy</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Monitoring-and-Operations"><span class="nav-number">8.</span> <span class="nav-text">Monitoring and Operations</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Key-Performance-Metrics"><span class="nav-number">8.1.</span> <span class="nav-text">Key Performance Metrics</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Alerting-Thresholds"><span class="nav-number">8.2.</span> <span class="nav-text">Alerting Thresholds</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Troubleshooting-Common-Issues"><span class="nav-number">8.3.</span> <span class="nav-text">Troubleshooting Common Issues</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Conclusion"><span class="nav-number">9.</span> <span class="nav-text">Conclusion</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Charlie Feng</p>
  <div class="site-description" itemprop="description">This place is for thinking and sharing.</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">28</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://shayne007.github.io/2025/06/10/Redis-Deployment-Modes-Theory-Practice-and-Interview-Insights/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Charlie Feng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Charlie Feng's Tech Space">
      <meta itemprop="description" content="This place is for thinking and sharing.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Redis Deployment Modes: Theory, Practice, and Interview Insights | Charlie Feng's Tech Space">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Redis Deployment Modes: Theory, Practice, and Interview Insights
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2025-06-10 16:21:06 / Modified: 17:17:39" itemprop="dateCreated datePublished" datetime="2025-06-10T16:21:06+08:00">2025-06-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/redis/" itemprop="url" rel="index"><span itemprop="name">redis</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Redis supports multiple deployment modes, each designed for different use cases, scalability requirements, and availability needs. Understanding these modes is crucial for designing robust, scalable systems.</p>
<p><strong>🎯 Common Interview Question</strong>: <em>“How do you decide which Redis deployment mode to use for a given application?”</em></p>
<p><strong>Answer Framework</strong>: Consider these factors:</p>
<ul>
<li><strong>Data size</strong>: Single instance practical limits (~25GB operational recommendation)</li>
<li><strong>Availability requirements</strong>: RTO&#x2F;RPO expectations</li>
<li><strong>Read&#x2F;write patterns</strong>: Read-heavy vs write-heavy workloads</li>
<li><strong>Geographic distribution</strong>: Single vs multi-region</li>
<li><strong>Operational complexity</strong>: Team expertise and maintenance overhead</li>
</ul>
<h2 id="Standalone-Redis"><a href="#Standalone-Redis" class="headerlink" title="Standalone Redis"></a>Standalone Redis</h2><h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p>Standalone Redis is the simplest deployment mode where a single Redis instance handles all operations. It’s ideal for development, testing, and small-scale applications.</p>
<h3 id="Architecture"><a href="#Architecture" class="headerlink" title="Architecture"></a>Architecture</h3><pre>
<code class="mermaid">
graph TB
A[Client Applications] --&gt; B[Redis Instance]
B --&gt; C[Disk Storage]

style B fill:#ff9999
style A fill:#99ccff
style C fill:#99ff99
</code>
</pre>

<h3 id="Configuration-Example"><a href="#Configuration-Example" class="headerlink" title="Configuration Example"></a>Configuration Example</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># redis.conf for standalone</span><br><span class="line">port 6379</span><br><span class="line">bind 127.0.0.1</span><br><span class="line">maxmemory 2gb</span><br><span class="line">maxmemory-policy allkeys-lru</span><br><span class="line">save 900 1</span><br><span class="line">save 300 10</span><br><span class="line">save 60 10000</span><br><span class="line">appendonly yes</span><br><span class="line">appendfsync everysec</span><br></pre></td></tr></table></figure>

<h3 id="Best-Practices"><a href="#Best-Practices" class="headerlink" title="Best Practices"></a>Best Practices</h3><ol>
<li><p><strong>Memory Management</strong></p>
<ul>
<li>Set <code>maxmemory</code> to 75% of available RAM</li>
<li>Choose appropriate eviction policy based on use case</li>
<li>Monitor memory fragmentation ratio</li>
</ul>
</li>
<li><p><strong>Persistence Configuration</strong></p>
<ul>
<li>Use AOF for critical data (better durability)</li>
<li>RDB for faster restarts and backups</li>
<li>Consider hybrid persistence for optimal balance</li>
</ul>
</li>
<li><p><strong>Security</strong></p>
<ul>
<li>Enable AUTH with strong passwords</li>
<li>Use TLS for client connections</li>
<li>Bind to specific interfaces, avoid 0.0.0.0</li>
</ul>
</li>
</ol>
<h3 id="Limitations-and-Use-Cases"><a href="#Limitations-and-Use-Cases" class="headerlink" title="Limitations and Use Cases"></a>Limitations and Use Cases</h3><p><strong>Limitations:</strong></p>
<ul>
<li>Single point of failure</li>
<li>Limited by single machine resources</li>
<li>No automatic failover</li>
</ul>
<p><strong>Optimal Use Cases:</strong></p>
<ul>
<li>Development and testing environments</li>
<li>Applications with &lt; 25GB data (to avoid RDB performance impact)</li>
<li>Non-critical applications where downtime is acceptable</li>
<li>Cache-only scenarios with acceptable data loss</li>
</ul>
<p><strong>🎯 Interview Insight</strong>: <em>“When would you NOT use standalone Redis?”</em><br>Answer: When you need high availability (&gt;99.9% uptime), <strong>data sizes exceed 25GB</strong> (RDB operations impact performance), or when application criticality requires zero data loss guarantees.</p>
<h3 id="RDB-Operation-Impact-Analysis"><a href="#RDB-Operation-Impact-Analysis" class="headerlink" title="RDB Operation Impact Analysis"></a>RDB Operation Impact Analysis</h3><p><strong>Critical Production Insight</strong>: The <strong>25GB threshold</strong> is where RDB operations start significantly impacting online business:</p>
<pre>
<code class="mermaid">
graph LR
A[BGSAVE Command] --&gt; B[&quot;fork() syscall&quot;]
B --&gt; C[Copy-on-Write Memory]
C --&gt; D[Memory Usage Spike]
D --&gt; E[Potential OOM]

F[Write Operations] --&gt; G[COW Page Copies]
G --&gt; H[Increased Latency]
H --&gt; I[Client Timeouts]

style D fill:#ff9999
style E fill:#ff6666
style H fill:#ffcc99
style I fill:#ff9999
</code>
</pre>

<p><strong>Real-world Impact at 25GB+:</strong></p>
<ul>
<li><strong>Memory spike</strong>: Up to 2x memory usage during fork</li>
<li><strong>Latency impact</strong>: P99 latencies can spike from 1ms to 100ms+</li>
<li><strong>CPU impact</strong>: Fork operation can freeze Redis for 100ms-1s</li>
<li><strong>I&#x2F;O saturation</strong>: Large RDB writes competing with normal operations</li>
</ul>
<p><strong>Mitigation Strategies:</strong></p>
<ol>
<li><strong>Disable automatic RDB</strong>: Use <code>save &quot;&quot;</code> and only manual BGSAVE during low traffic</li>
<li><strong>AOF-only persistence</strong>: More predictable performance impact</li>
<li><strong>Slave-based backups</strong>: Perform RDB operations on slave instances</li>
<li><strong>Memory optimization</strong>: Use compression, optimize data structures</li>
</ol>
<h2 id="Redis-Replication-Master-Slave"><a href="#Redis-Replication-Master-Slave" class="headerlink" title="Redis Replication (Master-Slave)"></a>Redis Replication (Master-Slave)</h2><h3 id="Overview-1"><a href="#Overview-1" class="headerlink" title="Overview"></a>Overview</h3><p>Redis replication creates exact copies of the master instance on one or more slave instances. It provides read scalability and basic redundancy.</p>
<h3 id="Architecture-1"><a href="#Architecture-1" class="headerlink" title="Architecture"></a>Architecture</h3><pre>
<code class="mermaid">
graph TB
A[Client - Writes] --&gt; B[Redis Master]
C[Client - Reads] --&gt; D[Redis Slave 1]
E[Client - Reads] --&gt; F[Redis Slave 2]

B --&gt; D
B --&gt; F

B --&gt; G[Disk Storage Master]
D --&gt; H[Disk Storage Slave 1]
F --&gt; I[Disk Storage Slave 2]

style B fill:#ff9999
style D fill:#ffcc99
style F fill:#ffcc99
</code>
</pre>

<h3 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h3><p><strong>Master Configuration:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># master.conf</span><br><span class="line">port 6379</span><br><span class="line">bind 0.0.0.0</span><br><span class="line">requirepass masterpassword123</span><br><span class="line">masterauth slavepassword123</span><br></pre></td></tr></table></figure>

<p><strong>Slave Configuration:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># slave.conf</span><br><span class="line">port 6380</span><br><span class="line">bind 0.0.0.0</span><br><span class="line">slaveof 192.168.1.100 6379</span><br><span class="line">masterauth masterpassword123</span><br><span class="line">requirepass slavepassword123</span><br><span class="line">slave-read-only yes</span><br></pre></td></tr></table></figure>

<h3 id="Replication-Process-Flow"><a href="#Replication-Process-Flow" class="headerlink" title="Replication Process Flow"></a>Replication Process Flow</h3><pre>
<code class="mermaid">
sequenceDiagram
participant M as Master
participant S as Slave
participant C as Client

Note over S: Initial Connection
S-&gt;&gt;M: PSYNC replicationid offset
M-&gt;&gt;S: +FULLRESYNC runid offset
M-&gt;&gt;S: RDB snapshot
Note over S: Load RDB data
M-&gt;&gt;S: Replication backlog commands

Note over M,S: Ongoing Replication
C-&gt;&gt;M: SET key value
M-&gt;&gt;S: SET key value
C-&gt;&gt;S: GET key
S-&gt;&gt;C: value
</code>
</pre>

<h3 id="Best-Practices-1"><a href="#Best-Practices-1" class="headerlink" title="Best Practices"></a>Best Practices</h3><ol>
<li><p><strong>Network Optimization</strong></p>
<ul>
<li>Use <code>repl-diskless-sync yes</code> for fast networks</li>
<li>Configure <code>repl-backlog-size</code> based on network latency</li>
<li>Monitor replication lag with <code>INFO replication</code></li>
</ul>
</li>
<li><p><strong>Slave Configuration</strong></p>
<ul>
<li>Set <code>slave-read-only yes</code> to prevent accidental writes</li>
<li>Use <code>slave-priority</code> for failover preferences</li>
<li>Configure appropriate <code>slave-serve-stale-data</code> behavior</li>
</ul>
</li>
<li><p><strong>Monitoring Key Metrics</strong></p>
<ul>
<li>Replication offset difference</li>
<li>Last successful sync time</li>
<li>Number of connected slaves</li>
</ul>
</li>
</ol>
<h3 id="Production-Showcase"><a href="#Production-Showcase" class="headerlink" title="Production Showcase"></a>Production Showcase</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># Production deployment script for master-slave setup</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Start master</span></span><br><span class="line">redis-server /etc/redis/master.conf --daemonize <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Wait for master to be ready</span></span><br><span class="line">redis-cli ping</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start slaves</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..2&#125;; <span class="keyword">do</span></span><br><span class="line">    redis-server /etc/redis/slave<span class="variable">$&#123;i&#125;</span>.conf --daemonize <span class="built_in">yes</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Verify replication</span></span><br><span class="line">redis-cli -p 6379 INFO replication</span><br></pre></td></tr></table></figure>

<p><strong>🎯 Interview Question</strong>: <em>“How do you handle slave promotion in a master-slave setup?”</em></p>
<p><strong>Answer</strong>: Manual promotion involves:</p>
<ol>
<li>Stop writes to current master</li>
<li>Ensure slave is caught up (<code>LASTSAVE</code> comparison)</li>
<li>Execute <code>SLAVEOF NO ONE</code> on chosen slave</li>
<li>Update application configuration to point to new master</li>
<li>Configure other slaves to replicate from new master</li>
</ol>
<p><strong>Limitation</strong>: No automatic failover - requires manual intervention or external tooling.</p>
<h2 id="Redis-Sentinel"><a href="#Redis-Sentinel" class="headerlink" title="Redis Sentinel"></a>Redis Sentinel</h2><h3 id="Overview-2"><a href="#Overview-2" class="headerlink" title="Overview"></a>Overview</h3><p>Redis Sentinel provides high availability for Redis through automatic failover, monitoring, and configuration management. It’s the recommended solution for automatic failover in non-clustered environments.</p>
<h3 id="Architecture-2"><a href="#Architecture-2" class="headerlink" title="Architecture"></a>Architecture</h3><pre>
<code class="mermaid">
graph TB
subgraph &quot;Redis Instances&quot;
    M[Redis Master]
    S1[Redis Slave 1]
    S2[Redis Slave 2]
end

subgraph &quot;Sentinel Cluster&quot;
    SE1[Sentinel 1]
    SE2[Sentinel 2]
    SE3[Sentinel 3]
end

subgraph &quot;Applications&quot;
    A1[App Instance 1]
    A2[App Instance 2]
end

M --&gt; S1
M --&gt; S2

SE1 -.-&gt; M
SE1 -.-&gt; S1
SE1 -.-&gt; S2
SE2 -.-&gt; M
SE2 -.-&gt; S1
SE2 -.-&gt; S2
SE3 -.-&gt; M
SE3 -.-&gt; S1
SE3 -.-&gt; S2

A1 --&gt; SE1
A2 --&gt; SE2

style M fill:#ff9999
style S1 fill:#ffcc99
style S2 fill:#ffcc99
style SE1 fill:#99ccff
style SE2 fill:#99ccff
style SE3 fill:#99ccff
</code>
</pre>

<h3 id="Sentinel-Configuration"><a href="#Sentinel-Configuration" class="headerlink" title="Sentinel Configuration"></a>Sentinel Configuration</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># sentinel.conf</span><br><span class="line">port 26379</span><br><span class="line">bind 0.0.0.0</span><br><span class="line"></span><br><span class="line"># Monitor master named &quot;mymaster&quot;</span><br><span class="line">sentinel monitor mymaster 192.168.1.100 6379 2</span><br><span class="line">sentinel auth-pass mymaster masterpassword123</span><br><span class="line"></span><br><span class="line"># Failover configuration</span><br><span class="line">sentinel down-after-milliseconds mymaster 5000</span><br><span class="line">sentinel failover-timeout mymaster 10000</span><br><span class="line">sentinel parallel-syncs mymaster 1</span><br><span class="line"></span><br><span class="line"># Notification scripts</span><br><span class="line">sentinel notification-script mymaster /path/to/notify.sh</span><br><span class="line">sentinel client-reconfig-script mymaster /path/to/reconfig.sh</span><br></pre></td></tr></table></figure>

<h3 id="Failover-Process"><a href="#Failover-Process" class="headerlink" title="Failover Process"></a>Failover Process</h3><pre>
<code class="mermaid">
sequenceDiagram
participant S1 as Sentinel 1
participant S2 as Sentinel 2
participant S3 as Sentinel 3
participant M as Master
participant SL as Slave
participant A as Application

Note over S1,S3: Normal Monitoring
S1-&gt;&gt;M: PING
M--xS1: No Response
S1-&gt;&gt;S2: Master seems down
S1-&gt;&gt;S3: Master seems down

Note over S1,S3: Quorum Check
S2-&gt;&gt;M: PING
M--xS2: No Response
S3-&gt;&gt;M: PING
M--xS3: No Response

Note over S1,S3: Failover Decision
S1-&gt;&gt;S2: Start failover?
S2-&gt;&gt;S1: Agreed
S1-&gt;&gt;SL: SLAVEOF NO ONE
S1-&gt;&gt;A: New master notification
</code>
</pre>

<h3 id="Best-Practices-2"><a href="#Best-Practices-2" class="headerlink" title="Best Practices"></a>Best Practices</h3><ol>
<li><p><strong>Quorum Configuration</strong></p>
<ul>
<li>Use odd number of sentinels (3, 5, 7)</li>
<li>Set quorum to majority (e.g., 2 for 3 sentinels)</li>
<li>Deploy sentinels across different failure domains</li>
</ul>
</li>
<li><p><strong>Timing Parameters</strong></p>
<ul>
<li><code>down-after-milliseconds</code>: 5-30 seconds based on network conditions</li>
<li><code>failover-timeout</code>: 2-3x down-after-milliseconds</li>
<li><code>parallel-syncs</code>: Usually 1 to avoid overwhelming new master</li>
</ul>
</li>
<li><p><strong>Client Integration</strong></p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis.sentinel</span><br><span class="line"></span><br><span class="line"><span class="comment"># Python client example</span></span><br><span class="line">sentinels = [(<span class="string">&#x27;localhost&#x27;</span>, <span class="number">26379</span>), (<span class="string">&#x27;localhost&#x27;</span>, <span class="number">26380</span>), (<span class="string">&#x27;localhost&#x27;</span>, <span class="number">26381</span>)]</span><br><span class="line">sentinel = redis.sentinel.Sentinel(sentinels, socket_timeout=<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Discover master</span></span><br><span class="line">master = sentinel.master_for(<span class="string">&#x27;mymaster&#x27;</span>, socket_timeout=<span class="number">0.1</span>)</span><br><span class="line">slave = sentinel.slave_for(<span class="string">&#x27;mymaster&#x27;</span>, socket_timeout=<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use connections</span></span><br><span class="line">master.<span class="built_in">set</span>(<span class="string">&#x27;key&#x27;</span>, <span class="string">&#x27;value&#x27;</span>)</span><br><span class="line">value = slave.get(<span class="string">&#x27;key&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Production-Monitoring-Script"><a href="#Production-Monitoring-Script" class="headerlink" title="Production Monitoring Script"></a>Production Monitoring Script</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># Sentinel health check script</span></span><br><span class="line"></span><br><span class="line">SENTINEL_PORT=26379</span><br><span class="line">MASTER_NAME=<span class="string">&quot;mymaster&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Check sentinel status</span></span><br><span class="line"><span class="keyword">for</span> port <span class="keyword">in</span> 26379 26380 26381; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Checking Sentinel on port <span class="variable">$port</span>&quot;</span></span><br><span class="line">    redis-cli -p <span class="variable">$port</span> SENTINEL masters | grep -A 20 <span class="variable">$MASTER_NAME</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;---&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Check master discovery</span></span><br><span class="line">redis-cli -p <span class="variable">$SENTINEL_PORT</span> SENTINEL get-master-addr-by-name <span class="variable">$MASTER_NAME</span></span><br></pre></td></tr></table></figure>

<p><strong>🎯 Interview Question</strong>: <em>“How does Redis Sentinel handle split-brain scenarios?”</em></p>
<p><strong>Answer</strong>: Sentinel prevents split-brain through:</p>
<ol>
<li><strong>Quorum requirement</strong>: Only majority can initiate failover</li>
<li><strong>Epoch mechanism</strong>: Each failover gets unique epoch number</li>
<li><strong>Leader election</strong>: Only one sentinel leads failover process</li>
<li><strong>Configuration propagation</strong>: All sentinels must agree on new configuration</li>
</ol>
<p><strong>Key Point</strong>: Even if network partitions occur, only the partition with quorum majority can perform failover, preventing multiple masters.</p>
<h2 id="Redis-Cluster"><a href="#Redis-Cluster" class="headerlink" title="Redis Cluster"></a>Redis Cluster</h2><h3 id="Overview-3"><a href="#Overview-3" class="headerlink" title="Overview"></a>Overview</h3><p>Redis Cluster provides horizontal scaling and high availability through data sharding across multiple nodes. It’s designed for applications requiring both high performance and large data sets.</p>
<h3 id="Architecture-3"><a href="#Architecture-3" class="headerlink" title="Architecture"></a>Architecture</h3><pre>
<code class="mermaid">
graph TB
subgraph &quot;Redis Cluster&quot;
    subgraph &quot;Shard 1&quot;
        M1[Master 1&lt;br&#x2F;&gt;Slots 0-5460]
        S1[Slave 1]
    end
    
    subgraph &quot;Shard 2&quot;
        M2[Master 2&lt;br&#x2F;&gt;Slots 5461-10922]
        S2[Slave 2]
    end
    
    subgraph &quot;Shard 3&quot;
        M3[Master 3&lt;br&#x2F;&gt;Slots 10923-16383]
        S3[Slave 3]
    end
end

M1 --&gt; S1
M2 --&gt; S2
M3 --&gt; S3

M1 -.-&gt; M2
M1 -.-&gt; M3
M2 -.-&gt; M3

A[Application] --&gt; M1
A --&gt; M2
A --&gt; M3

style M1 fill:#ff9999
style M2 fill:#ff9999
style M3 fill:#ff9999
style S1 fill:#ffcc99
style S2 fill:#ffcc99
style S3 fill:#ffcc99
</code>
</pre>

<h3 id="Hash-Slot-Distribution"><a href="#Hash-Slot-Distribution" class="headerlink" title="Hash Slot Distribution"></a>Hash Slot Distribution</h3><p>Redis Cluster uses consistent hashing with 16,384 slots:</p>
<pre>
<code class="mermaid">
graph LR
A[Key] --&gt; B[CRC16]
B --&gt; C[% 16384]
C --&gt; D[Hash Slot]
D --&gt; E[Node Assignment]

F[Example: user:1000] --&gt; G[CRC16 &#x3D; 31949]
G --&gt; H[31949 % 16384 &#x3D; 15565]
H --&gt; I[Slot 15565 → Node 3]
</code>
</pre>

<h3 id="Cluster-Configuration"><a href="#Cluster-Configuration" class="headerlink" title="Cluster Configuration"></a>Cluster Configuration</h3><p><strong>Node Configuration:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># cluster-node.conf</span><br><span class="line">port 7000</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file nodes-7000.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">appendonly yes</span><br></pre></td></tr></table></figure>

<p><strong>Cluster Setup Script:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># Create 6-node cluster (3 masters, 3 slaves)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Start nodes</span></span><br><span class="line"><span class="keyword">for</span> port <span class="keyword">in</span> 7000 7001 7002 7003 7004 7005; <span class="keyword">do</span></span><br><span class="line">    redis-server --port <span class="variable">$port</span> --cluster-enabled <span class="built_in">yes</span> \</span><br><span class="line">                 --cluster-config-file nodes-<span class="variable">$&#123;port&#125;</span>.conf \</span><br><span class="line">                 --cluster-node-timeout 5000 \</span><br><span class="line">                 --appendonly <span class="built_in">yes</span> --daemonize <span class="built_in">yes</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create cluster</span></span><br><span class="line">redis-cli --cluster create 127.0.0.1:7000 127.0.0.1:7001 127.0.0.1:7002 \</span><br><span class="line">                           127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005 \</span><br><span class="line">                           --cluster-replicas 1</span><br></pre></td></tr></table></figure>

<h3 id="Data-Distribution-and-Client-Routing"><a href="#Data-Distribution-and-Client-Routing" class="headerlink" title="Data Distribution and Client Routing"></a>Data Distribution and Client Routing</h3><pre>
<code class="mermaid">
sequenceDiagram
participant C as Client
participant N1 as Node 1
participant N2 as Node 2
participant N3 as Node 3

C-&gt;&gt;N1: GET user:1000
Note over N1: Check slot ownership
alt Key belongs to N1
    N1-&gt;&gt;C: value
else Key belongs to N2
    N1-&gt;&gt;C: MOVED 15565 192.168.1.102:7001
    C-&gt;&gt;N2: GET user:1000
    N2-&gt;&gt;C: value
end
</code>
</pre>

<h3 id="Advanced-Operations"><a href="#Advanced-Operations" class="headerlink" title="Advanced Operations"></a>Advanced Operations</h3><p><strong>Resharding Example:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Move 1000 slots from node 1 to node 4</span></span><br><span class="line">redis-cli --cluster reshard 127.0.0.1:7000 \</span><br><span class="line">          --cluster-from 1a2b3c4d... \</span><br><span class="line">          --cluster-to 5e6f7g8h... \</span><br><span class="line">          --cluster-slots 1000</span><br></pre></td></tr></table></figure>

<p><strong>Adding New Nodes:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Add new master</span></span><br><span class="line">redis-cli --cluster add-node 127.0.0.1:7006 127.0.0.1:7000</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add new slave</span></span><br><span class="line">redis-cli --cluster add-node 127.0.0.1:7007 127.0.0.1:7000 --cluster-slave</span><br></pre></td></tr></table></figure>

<h3 id="Client-Implementation-Best-Practices"><a href="#Client-Implementation-Best-Practices" class="headerlink" title="Client Implementation Best Practices"></a>Client Implementation Best Practices</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis.cluster</span><br><span class="line"></span><br><span class="line"><span class="comment"># Python cluster client</span></span><br><span class="line">startup_nodes = [</span><br><span class="line">    &#123;<span class="string">&quot;host&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>, <span class="string">&quot;port&quot;</span>: <span class="string">&quot;7000&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;host&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>, <span class="string">&quot;port&quot;</span>: <span class="string">&quot;7001&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;host&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>, <span class="string">&quot;port&quot;</span>: <span class="string">&quot;7002&quot;</span>&#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">cluster = redis.cluster.RedisCluster(</span><br><span class="line">    startup_nodes=startup_nodes,</span><br><span class="line">    decode_responses=<span class="literal">True</span>,</span><br><span class="line">    skip_full_coverage_check=<span class="literal">True</span>,</span><br><span class="line">    health_check_interval=<span class="number">30</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Hash tags for multi-key operations</span></span><br><span class="line">cluster.mset(&#123;</span><br><span class="line">    <span class="string">&quot;user:&#123;1000&#125;:name&quot;</span>: <span class="string">&quot;Alice&quot;</span>,</span><br><span class="line">    <span class="string">&quot;user:&#123;1000&#125;:email&quot;</span>: <span class="string">&quot;alice@example.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;user:&#123;1000&#125;:age&quot;</span>: <span class="string">&quot;30&quot;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="Limitations-and-Considerations"><a href="#Limitations-and-Considerations" class="headerlink" title="Limitations and Considerations"></a>Limitations and Considerations</h3><ol>
<li><strong>Multi-key Operations</strong>: Limited to same hash slot</li>
<li><strong>Lua Scripts</strong>: All keys must be in same slot</li>
<li><strong>Database Selection</strong>: Only database 0 supported</li>
<li><strong>Client Complexity</strong>: Requires cluster-aware clients</li>
</ol>
<p><strong>🎯 Interview Question</strong>: <em>“How do you handle hotspot keys in Redis Cluster?”</em></p>
<p><strong>Answer Strategies</strong>:</p>
<ol>
<li><strong>Hash tags</strong>: Distribute related hot keys across slots</li>
<li><strong>Client-side caching</strong>: Cache frequently accessed data</li>
<li><strong>Read replicas</strong>: Use slave nodes for read operations</li>
<li><strong>Application-level sharding</strong>: Pre-shard at application layer</li>
<li><strong>Monitoring</strong>: Use <code>redis-cli --hotkeys</code> to identify patterns</li>
</ol>
<h2 id="Deployment-Architecture-Comparison"><a href="#Deployment-Architecture-Comparison" class="headerlink" title="Deployment Architecture Comparison"></a>Deployment Architecture Comparison</h2><h3 id="Feature-Matrix"><a href="#Feature-Matrix" class="headerlink" title="Feature Matrix"></a>Feature Matrix</h3><table>
<thead>
<tr>
<th>Feature</th>
<th>Standalone</th>
<th>Replication</th>
<th>Sentinel</th>
<th>Cluster</th>
</tr>
</thead>
<tbody><tr>
<td><strong>High Availability</strong></td>
<td>❌</td>
<td>❌</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td><strong>Automatic Failover</strong></td>
<td>❌</td>
<td>❌</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td><strong>Horizontal Scaling</strong></td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
<td>✅</td>
</tr>
<tr>
<td><strong>Read Scaling</strong></td>
<td>❌</td>
<td>✅</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td><strong>Operational Complexity</strong></td>
<td>Low</td>
<td>Low</td>
<td>Medium</td>
<td>High</td>
</tr>
<tr>
<td><strong>Multi-key Operations</strong></td>
<td>✅</td>
<td>✅</td>
<td>✅</td>
<td>Limited</td>
</tr>
<tr>
<td><strong>Max Data Size</strong></td>
<td>Single Node</td>
<td>Single Node</td>
<td>Single Node</td>
<td>Multi-Node</td>
</tr>
</tbody></table>
<h3 id="Decision-Flow-Chart"><a href="#Decision-Flow-Chart" class="headerlink" title="Decision Flow Chart"></a>Decision Flow Chart</h3><pre>
<code class="mermaid">
flowchart TD
A[Start: Redis Deployment Decision] --&gt; B{Data Size &gt; 25GB?}
B --&gt;|Yes| C{Can tolerate RDB impact?}
C --&gt;|No| D[Consider Redis Cluster]
C --&gt;|Yes| E{High Availability Required?}
B --&gt;|No| E
E --&gt;|No| F{Read Scaling Needed?}
F --&gt;|Yes| G[Master-Slave Replication]
F --&gt;|No| H[Standalone Redis]
E --&gt;|Yes| I{Automatic Failover Needed?}
I --&gt;|Yes| J[Redis Sentinel]
I --&gt;|No| G

style D fill:#ff6b6b
style J fill:#4ecdc4
style G fill:#45b7d1
style H fill:#96ceb4
</code>
</pre>

<h2 id="Production-Considerations"><a href="#Production-Considerations" class="headerlink" title="Production Considerations"></a>Production Considerations</h2><h3 id="Hardware-Sizing-Guidelines"><a href="#Hardware-Sizing-Guidelines" class="headerlink" title="Hardware Sizing Guidelines"></a>Hardware Sizing Guidelines</h3><p><strong>CPU Requirements:</strong></p>
<ul>
<li>Standalone&#x2F;Replication: 2-4 cores</li>
<li>Sentinel: 1-2 cores per sentinel</li>
<li>Cluster: 4-8 cores per node</li>
</ul>
<p><strong>Memory Guidelines:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Total RAM = (Dataset Size × 1.5) + OS overhead</span><br><span class="line">Example: 100GB dataset = 150GB + 16GB = 166GB total RAM</span><br></pre></td></tr></table></figure>

<p><strong>Network Considerations:</strong></p>
<ul>
<li>Replication: 1Gbps minimum for large datasets</li>
<li>Cluster: Low latency (&lt;1ms) between nodes</li>
<li>Client connections: Plan for connection pooling</li>
</ul>
<h3 id="Security-Best-Practices"><a href="#Security-Best-Practices" class="headerlink" title="Security Best Practices"></a>Security Best Practices</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># Production security configuration</span><br><span class="line">bind 127.0.0.1 10.0.0.0/8</span><br><span class="line">protected-mode yes</span><br><span class="line">requirepass your-secure-password-here</span><br><span class="line">rename-command FLUSHDB &quot;&quot;</span><br><span class="line">rename-command FLUSHALL &quot;&quot;</span><br><span class="line">rename-command CONFIG &quot;CONFIG_b9f8e7a6d2c1&quot;</span><br><span class="line"></span><br><span class="line"># TLS configuration</span><br><span class="line">tls-port 6380</span><br><span class="line">tls-cert-file /path/to/redis.crt</span><br><span class="line">tls-key-file /path/to/redis.key</span><br><span class="line">tls-ca-cert-file /path/to/ca.crt</span><br></pre></td></tr></table></figure>

<h3 id="Backup-and-Recovery-Strategy"><a href="#Backup-and-Recovery-Strategy" class="headerlink" title="Backup and Recovery Strategy"></a>Backup and Recovery Strategy</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># Comprehensive backup script</span></span><br><span class="line"></span><br><span class="line">REDIS_HOST=<span class="string">&quot;localhost&quot;</span></span><br><span class="line">REDIS_PORT=<span class="string">&quot;6379&quot;</span></span><br><span class="line">BACKUP_DIR=<span class="string">&quot;/var/backups/redis&quot;</span></span><br><span class="line">DATE=$(<span class="built_in">date</span> +%Y%m%d_%H%M%S)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create RDB backup</span></span><br><span class="line">redis-cli -h <span class="variable">$REDIS_HOST</span> -p <span class="variable">$REDIS_PORT</span> BGSAVE</span><br><span class="line"><span class="built_in">sleep</span> 5</span><br><span class="line"></span><br><span class="line"><span class="comment"># Wait for background save to complete</span></span><br><span class="line"><span class="keyword">while</span> [ $(redis-cli -h <span class="variable">$REDIS_HOST</span> -p <span class="variable">$REDIS_PORT</span> LASTSAVE) -eq <span class="variable">$LASTSAVE</span> ]; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">sleep</span> 1</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy files</span></span><br><span class="line"><span class="built_in">cp</span> /var/lib/redis/dump.rdb <span class="variable">$BACKUP_DIR</span>/dump_<span class="variable">$DATE</span>.rdb</span><br><span class="line"><span class="built_in">cp</span> /var/lib/redis/appendonly.aof <span class="variable">$BACKUP_DIR</span>/aof_<span class="variable">$DATE</span>.aof</span><br><span class="line"></span><br><span class="line"><span class="comment"># Compress and upload to S3</span></span><br><span class="line">tar -czf <span class="variable">$BACKUP_DIR</span>/redis_backup_<span class="variable">$DATE</span>.tar.gz <span class="variable">$BACKUP_DIR</span>/*_<span class="variable">$DATE</span>.*</span><br><span class="line">aws s3 <span class="built_in">cp</span> <span class="variable">$BACKUP_DIR</span>/redis_backup_<span class="variable">$DATE</span>.tar.gz s3://redis-backups/</span><br></pre></td></tr></table></figure>

<h2 id="Monitoring-and-Operations"><a href="#Monitoring-and-Operations" class="headerlink" title="Monitoring and Operations"></a>Monitoring and Operations</h2><h3 id="Key-Performance-Metrics"><a href="#Key-Performance-Metrics" class="headerlink" title="Key Performance Metrics"></a>Key Performance Metrics</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># Redis monitoring script</span></span><br><span class="line"></span><br><span class="line">redis-cli INFO all | grep -E <span class="string">&quot;(used_memory_human|connected_clients|total_commands_processed|keyspace_hits|keyspace_misses|role|master_repl_offset)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Cluster-specific monitoring</span></span><br><span class="line"><span class="keyword">if</span> redis-cli CLUSTER NODES &amp;&gt;/dev/null; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;=== Cluster Status ===&quot;</span></span><br><span class="line">    redis-cli CLUSTER NODES</span><br><span class="line">    redis-cli CLUSTER INFO</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<h3 id="Alerting-Thresholds"><a href="#Alerting-Thresholds" class="headerlink" title="Alerting Thresholds"></a>Alerting Thresholds</h3><table>
<thead>
<tr>
<th>Metric</th>
<th>Warning</th>
<th>Critical</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Memory Usage</strong></td>
<td>&gt;80%</td>
<td>&gt;90%</td>
</tr>
<tr>
<td><strong>Hit Ratio</strong></td>
<td>&lt;90%</td>
<td>&lt;80%</td>
</tr>
<tr>
<td><strong>Connected Clients</strong></td>
<td>&gt;80% max</td>
<td>&gt;95% max</td>
</tr>
<tr>
<td><strong>Replication Lag</strong></td>
<td>&gt;10s</td>
<td>&gt;30s</td>
</tr>
<tr>
<td><strong>Cluster State</strong></td>
<td>degraded</td>
<td>fail</td>
</tr>
</tbody></table>
<h3 id="Troubleshooting-Common-Issues"><a href="#Troubleshooting-Common-Issues" class="headerlink" title="Troubleshooting Common Issues"></a>Troubleshooting Common Issues</h3><p><strong>Memory Fragmentation:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Check fragmentation ratio</span></span><br><span class="line">redis-cli INFO memory | grep mem_fragmentation_ratio</span><br><span class="line"></span><br><span class="line"><span class="comment"># If ratio &gt; 1.5, consider:</span></span><br><span class="line"><span class="comment"># 1. Restart Redis during maintenance window</span></span><br><span class="line"><span class="comment"># 2. Enable active defragmentation</span></span><br><span class="line">CONFIG SET activedefrag <span class="built_in">yes</span></span><br></pre></td></tr></table></figure>

<p><strong>Slow Queries:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Enable slow log</span></span><br><span class="line">CONFIG SET slowlog-log-slower-than 10000</span><br><span class="line">CONFIG SET slowlog-max-len 128</span><br><span class="line"></span><br><span class="line"><span class="comment"># Check slow queries</span></span><br><span class="line">SLOWLOG GET 10</span><br></pre></td></tr></table></figure>

<p><strong>🎯 Interview Question</strong>: <em>“How do you handle Redis memory pressure in production?”</em></p>
<p><strong>Comprehensive Answer</strong>:</p>
<ol>
<li><strong>Immediate actions</strong>: Check <code>maxmemory-policy</code>, verify no memory leaks</li>
<li><strong>Short-term</strong>: Scale vertically, optimize data structures, enable compression</li>
<li><strong>Long-term</strong>: Implement data archiving, consider clustering, optimize application usage patterns</li>
<li><strong>Monitoring</strong>: Set up alerts for memory usage, track key expiration patterns</li>
</ol>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Choosing the right Redis deployment mode depends on your specific requirements for availability, scalability, and operational complexity. Start simple with standalone or replication for smaller applications, progress to Sentinel for high availability needs, and adopt Cluster for large-scale, horizontally distributed systems.</p>
<p><strong>Final Interview Insight</strong>: The key to Redis success in production is not just choosing the right deployment mode, but also implementing proper monitoring, backup strategies, and operational procedures. Always plan for failure scenarios and test your disaster recovery procedures regularly.</p>
<p>Remember: <strong>“The best Redis deployment is the simplest one that meets your requirements.”</strong></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/redis/" rel="tag"># redis</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/06/10/Kafka-Duplicate-Message-Consumption/" rel="prev" title="Kafka Duplicate Message Consumption">
                  <i class="fa fa-angle-left"></i> Kafka Duplicate Message Consumption
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/06/10/Redis-Cache-Problems-Penetration-Breakdown-and-Avalanche/" rel="next" title="Redis Cache Problems:Penetration,Breakdown and Avalanche">
                  Redis Cache Problems:Penetration,Breakdown and Avalanche <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Charlie Feng</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
