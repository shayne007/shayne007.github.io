<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"shayne007.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.23.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="Redis is an in-memory data structure store that serves as a database, cache, and message broker. Understanding its data types and their underlying implementations is crucial for optimal performance an">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis Data Types and Data Structures: Complete Guide">
<meta property="og:url" content="https://shayne007.github.io/2025/06/09/Redis-Data-Types-and-Data-Structures-Complete-Guide/index.html">
<meta property="og:site_name" content="Charlie Feng&#39;s Tech Space">
<meta property="og:description" content="Redis is an in-memory data structure store that serves as a database, cache, and message broker. Understanding its data types and their underlying implementations is crucial for optimal performance an">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-06-09T13:40:29.000Z">
<meta property="article:modified_time" content="2025-06-18T11:46:45.240Z">
<meta property="article:author" content="Charlie Feng">
<meta property="article:tag" content="redis">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://shayne007.github.io/2025/06/09/Redis-Data-Types-and-Data-Structures-Complete-Guide/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://shayne007.github.io/2025/06/09/Redis-Data-Types-and-Data-Structures-Complete-Guide/","path":"2025/06/09/Redis-Data-Types-and-Data-Structures-Complete-Guide/","title":"Redis Data Types and Data Structures: Complete Guide"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Redis Data Types and Data Structures: Complete Guide | Charlie Feng's Tech Space</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"cdn":false,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.5.0/mermaid.min.js","integrity":"sha256-2obLuIPcceEhkE3G09G33hBdmE55ivVcZUlcKcGNHjU="}}</script>
  <script src="/js/third-party/tags/mermaid.js" defer></script>





  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Charlie Feng's Tech Space</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">You will survive with skills</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#String-Data-Type-and-SDS-Implementation"><span class="nav-number">1.</span> <span class="nav-text">String Data Type and SDS Implementation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#What-is-SDS-Simple-Dynamic-String"><span class="nav-number">1.1.</span> <span class="nav-text">What is SDS (Simple Dynamic String)?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SDS-vs-C-String-Comparison"><span class="nav-number">1.2.</span> <span class="nav-text">SDS vs C String Comparison</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SDS-Implementation-Details"><span class="nav-number">1.3.</span> <span class="nav-text">SDS Implementation Details</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#String%E2%80%99s-Internal-encoding-representation"><span class="nav-number">1.4.</span> <span class="nav-text">String’s Internal encoding&#x2F;representation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#String-Use-Cases-and-Examples"><span class="nav-number">1.5.</span> <span class="nav-text">String Use Cases and Examples</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#User-Session-Caching"><span class="nav-number">1.5.1.</span> <span class="nav-text">User Session Caching</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Atomic-Counters"><span class="nav-number">1.5.2.</span> <span class="nav-text">Atomic Counters</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Distributed-Locks-with-SETNX"><span class="nav-number">1.5.3.</span> <span class="nav-text">Distributed Locks with SETNX</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#List-Data-Type-Implementation"><span class="nav-number">2.</span> <span class="nav-text">List Data Type Implementation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Evolution-of-List-Implementation"><span class="nav-number">2.1.</span> <span class="nav-text">Evolution of List Implementation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Quicklist-Structure"><span class="nav-number">2.2.</span> <span class="nav-text">Quicklist Structure</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#List-Use-Cases-and-Examples"><span class="nav-number">2.3.</span> <span class="nav-text">List Use Cases and Examples</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Message-Queue-Implementation"><span class="nav-number">2.3.1.</span> <span class="nav-text">Message Queue Implementation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Latest-Articles-List"><span class="nav-number">2.3.2.</span> <span class="nav-text">Latest Articles List</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Activity-Feed"><span class="nav-number">2.3.3.</span> <span class="nav-text">Activity Feed</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Set-Data-Type-Implementation"><span class="nav-number">3.</span> <span class="nav-text">Set Data Type Implementation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Dual-Implementation-Strategy"><span class="nav-number">3.1.</span> <span class="nav-text">Dual Implementation Strategy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IntSet-Implementation"><span class="nav-number">3.2.</span> <span class="nav-text">IntSet Implementation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IntSet-vs-Hash-Table"><span class="nav-number">3.3.</span> <span class="nav-text">IntSet vs Hash Table</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Set-Use-Cases-and-Examples"><span class="nav-number">3.4.</span> <span class="nav-text">Set Use Cases and Examples</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Tag-System"><span class="nav-number">3.4.1.</span> <span class="nav-text">Tag System</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#User-Interests-and-Recommendations"><span class="nav-number">3.4.2.</span> <span class="nav-text">User Interests and Recommendations</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Social-Features-Mutual-Friends"><span class="nav-number">3.4.3.</span> <span class="nav-text">Social Features: Mutual Friends</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Online-Users-Tracking"><span class="nav-number">3.4.4.</span> <span class="nav-text">Online Users Tracking</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Sorted-Set-ZSet-Implementation"><span class="nav-number">4.</span> <span class="nav-text">Sorted Set (ZSet) Implementation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Hybrid-Data-Structure"><span class="nav-number">4.1.</span> <span class="nav-text">Hybrid Data Structure</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Skip-List-Structure"><span class="nav-number">4.2.</span> <span class="nav-text">Skip List Structure</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Skip-List-Advantages"><span class="nav-number">4.3.</span> <span class="nav-text">Skip List Advantages</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ZSet-Use-Cases-and-Examples"><span class="nav-number">4.4.</span> <span class="nav-text">ZSet Use Cases and Examples</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Leaderboard-System"><span class="nav-number">4.4.1.</span> <span class="nav-text">Leaderboard System</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Time-based-Delayed-Queue"><span class="nav-number">4.4.2.</span> <span class="nav-text">Time-based Delayed Queue</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Trending-Content"><span class="nav-number">4.4.3.</span> <span class="nav-text">Trending Content</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hash-Data-Type-Implementation"><span class="nav-number">5.</span> <span class="nav-text">Hash Data Type Implementation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Adaptive-Data-Structure"><span class="nav-number">5.1.</span> <span class="nav-text">Adaptive Data Structure</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Configuration-Thresholds"><span class="nav-number">5.2.</span> <span class="nav-text">Configuration Thresholds</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hash-Use-Cases-and-Examples"><span class="nav-number">5.3.</span> <span class="nav-text">Hash Use Cases and Examples</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Object-Storage"><span class="nav-number">5.3.1.</span> <span class="nav-text">Object Storage</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Shopping-Cart"><span class="nav-number">5.3.2.</span> <span class="nav-text">Shopping Cart</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Configuration-Management"><span class="nav-number">5.3.3.</span> <span class="nav-text">Configuration Management</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Advanced-Data-Types"><span class="nav-number">6.</span> <span class="nav-text">Advanced Data Types</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Bitmap-Space-Efficient-Boolean-Arrays"><span class="nav-number">6.1.</span> <span class="nav-text">Bitmap: Space-Efficient Boolean Arrays</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Use-Case-1-User-Activity-Tracking"><span class="nav-number">6.1.1.</span> <span class="nav-text">Use Case 1: User Activity Tracking</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Use-Case-2-Feature-Flags"><span class="nav-number">6.1.2.</span> <span class="nav-text">Use Case 2: Feature Flags</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Use-Case-3-A-B-Testing"><span class="nav-number">6.1.3.</span> <span class="nav-text">Use Case 3:  A&#x2F;B Testing</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HyperLogLog-Probabilistic-Counting"><span class="nav-number">6.2.</span> <span class="nav-text">HyperLogLog: Probabilistic Counting</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Algorithm-Principle"><span class="nav-number">6.2.1.</span> <span class="nav-text">Algorithm Principle</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Use-Case-1-Unique-Visitors"><span class="nav-number">6.2.2.</span> <span class="nav-text">Use Case 1: Unique Visitors</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Use-Case-2-Unique-Event-Counting"><span class="nav-number">6.2.3.</span> <span class="nav-text">Use Case 2: Unique Event Counting</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Use-Case-3-Real-time-Analytics"><span class="nav-number">6.2.4.</span> <span class="nav-text">Use Case 3: Real-time Analytics</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Accuracy-vs-Memory-Trade-off"><span class="nav-number">6.2.5.</span> <span class="nav-text">Accuracy vs. Memory Trade-off</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Stream-Radix-Tree-Consumer-Groups"><span class="nav-number">6.3.</span> <span class="nav-text">Stream: Radix Tree + Consumer Groups</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Stream-Entry-Structure"><span class="nav-number">6.3.1.</span> <span class="nav-text">Stream Entry Structure</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Use-Case-1-Event-Sourcing"><span class="nav-number">6.3.2.</span> <span class="nav-text">Use Case 1: Event Sourcing</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Use-Case-2-Message-Queues-with-Consumer-Groups"><span class="nav-number">6.3.3.</span> <span class="nav-text">Use Case 2: Message Queues with Consumer Groups</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Use-Case-3-Real-time-Data-Processing"><span class="nav-number">6.3.4.</span> <span class="nav-text">Use Case 3: Real-time Data Processing</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Geospatial-Sorted-Set-with-Geohash"><span class="nav-number">6.4.</span> <span class="nav-text">Geospatial: Sorted Set with Geohash</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Geohash-Encoding"><span class="nav-number">6.4.1.</span> <span class="nav-text">Geohash Encoding</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Use-Case-1-Location-Services"><span class="nav-number">6.4.2.</span> <span class="nav-text">Use Case 1: Location Services</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Use-Case-2-Delivery-Services"><span class="nav-number">6.4.3.</span> <span class="nav-text">Use Case 2: Delivery Services</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Use-Case-3-Store-Locator"><span class="nav-number">6.4.4.</span> <span class="nav-text">Use Case 3: Store Locator</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Choosing-the-Right-Data-Type"><span class="nav-number">7.</span> <span class="nav-text">Choosing the Right Data Type</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Decision-Matrix"><span class="nav-number">7.1.</span> <span class="nav-text">Decision Matrix</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Use-Case-Mapping-Table"><span class="nav-number">7.2.</span> <span class="nav-text">Use Case Mapping Table</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Performance-Characteristics"><span class="nav-number">7.3.</span> <span class="nav-text">Performance Characteristics</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Best-Practices-and-Interview-Insights"><span class="nav-number">8.</span> <span class="nav-text">Best Practices and Interview Insights</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Memory-Optimization-Strategies"><span class="nav-number">8.1.</span> <span class="nav-text">Memory Optimization Strategies</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Common-Anti-Patterns-to-Avoid"><span class="nav-number">8.2.</span> <span class="nav-text">Common Anti-Patterns to Avoid</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Key-Design-Patterns"><span class="nav-number">8.3.</span> <span class="nav-text">Key Design Patterns</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Hierarchical-Key-Naming"><span class="nav-number">8.3.1.</span> <span class="nav-text">Hierarchical Key Naming</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Atomic-Operations-with-Lua-Scripts"><span class="nav-number">8.3.2.</span> <span class="nav-text">Atomic Operations with Lua Scripts</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Advanced-Implementation-Details"><span class="nav-number">9.</span> <span class="nav-text">Advanced Implementation Details</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Memory-Layout-Optimization"><span class="nav-number">9.1.</span> <span class="nav-text">Memory Layout Optimization</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Configuration-Tuning-for-Production"><span class="nav-number">9.2.</span> <span class="nav-text">Configuration Tuning for Production</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Monitoring-and-Debugging"><span class="nav-number">9.3.</span> <span class="nav-text">Monitoring and Debugging</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Real-World-Architecture-Patterns"><span class="nav-number">10.</span> <span class="nav-text">Real-World Architecture Patterns</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Microservices-Data-Patterns"><span class="nav-number">10.1.</span> <span class="nav-text">Microservices Data Patterns</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#E-commerce-Platform-Integration"><span class="nav-number">10.2.</span> <span class="nav-text">E-commerce Platform Integration</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Production-Deployment-Considerations"><span class="nav-number">11.</span> <span class="nav-text">Production Deployment Considerations</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#High-Availability-Patterns"><span class="nav-number">11.1.</span> <span class="nav-text">High Availability Patterns</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Performance-Monitoring"><span class="nav-number">11.2.</span> <span class="nav-text">Performance Monitoring</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Key-Takeaways-and-Interview-Excellence"><span class="nav-number">12.</span> <span class="nav-text">Key Takeaways and Interview Excellence</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Essential-Concepts-to-Master"><span class="nav-number">12.1.</span> <span class="nav-text">Essential Concepts to Master</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Critical-Interview-Questions-and-Expert-Answers"><span class="nav-number">12.2.</span> <span class="nav-text">Critical Interview Questions and Expert Answers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Redis-Command-Cheat-Sheet-for-Data-Types"><span class="nav-number">12.3.</span> <span class="nav-text">Redis Command Cheat Sheet for Data Types</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Conclusion"><span class="nav-number">13.</span> <span class="nav-text">Conclusion</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#External-References"><span class="nav-number">14.</span> <span class="nav-text">External References</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Charlie Feng</p>
  <div class="site-description" itemprop="description">This place is for thinking and sharing.</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">52</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://shayne007.github.io/2025/06/09/Redis-Data-Types-and-Data-Structures-Complete-Guide/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Charlie Feng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Charlie Feng's Tech Space">
      <meta itemprop="description" content="This place is for thinking and sharing.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Redis Data Types and Data Structures: Complete Guide | Charlie Feng's Tech Space">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Redis Data Types and Data Structures: Complete Guide
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-06-09 21:40:29" itemprop="dateCreated datePublished" datetime="2025-06-09T21:40:29+08:00">2025-06-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-06-18 19:46:45" itemprop="dateModified" datetime="2025-06-18T19:46:45+08:00">2025-06-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/redis/" itemprop="url" rel="index"><span itemprop="name">redis</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>Redis is an in-memory data structure store that serves as a database, cache, and message broker. Understanding its data types and their underlying implementations is crucial for optimal performance and design decisions in production systems.</p>
<h2 id="String-Data-Type-and-SDS-Implementation"><a href="#String-Data-Type-and-SDS-Implementation" class="headerlink" title="String Data Type and SDS Implementation"></a>String Data Type and SDS Implementation</h2><h3 id="What-is-SDS-Simple-Dynamic-String"><a href="#What-is-SDS-Simple-Dynamic-String" class="headerlink" title="What is SDS (Simple Dynamic String)?"></a>What is SDS (Simple Dynamic String)?</h3><p>Redis implements strings using Simple Dynamic String (SDS) instead of traditional C strings. This design choice addresses several limitations of C strings and provides additional functionality.</p>
<pre>
<code class="mermaid">
graph TD
A[SDS Structure] --&gt; B[len: used length]
A --&gt; C[alloc: allocated space]
A --&gt; D[flags: type info]
A --&gt; E[buf: character array]

F[C String] --&gt; G[null-terminated]
F --&gt; H[no length info]
F --&gt; I[buffer overflow risk]
</code>
</pre>

<h3 id="SDS-vs-C-String-Comparison"><a href="#SDS-vs-C-String-Comparison" class="headerlink" title="SDS vs C String Comparison"></a>SDS vs C String Comparison</h3><table>
<thead>
<tr>
<th>Feature</th>
<th>C String</th>
<th>SDS</th>
</tr>
</thead>
<tbody><tr>
<td>Length tracking</td>
<td>O(n) strlen()</td>
<td>O(1) access</td>
</tr>
<tr>
<td>Memory safety</td>
<td>Buffer overflow risk</td>
<td>Safe append operations</td>
</tr>
<tr>
<td>Binary safety</td>
<td>Null-terminated only</td>
<td>Can store binary data</td>
</tr>
<tr>
<td>Memory efficiency</td>
<td>Fixed allocation</td>
<td>Dynamic resizing</td>
</tr>
</tbody></table>
<h3 id="SDS-Implementation-Details"><a href="#SDS-Implementation-Details" class="headerlink" title="SDS Implementation Details"></a>SDS Implementation Details</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sdshdr</span> &#123;</span></span><br><span class="line">    <span class="type">int</span> len;      <span class="comment">// used length</span></span><br><span class="line">    <span class="type">int</span> <span class="built_in">free</span>;     <span class="comment">// available space</span></span><br><span class="line">    <span class="type">char</span> buf[];   <span class="comment">// character array</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>Key advantages:</strong></p>
<ul>
<li><strong>O(1) length operations</strong>: No need to traverse the string</li>
<li><strong>Buffer overflow prevention</strong>: Automatic memory management</li>
<li><strong>Binary safe</strong>: Can store any byte sequence</li>
<li><strong>Space pre-allocation</strong>: Reduces memory reallocations</li>
</ul>
<h3 id="String’s-Internal-encoding-representation"><a href="#String’s-Internal-encoding-representation" class="headerlink" title="String’s Internal encoding&#x2F;representation"></a>String’s Internal encoding&#x2F;representation</h3><ul>
<li><strong>RAW</strong><br>Used for strings longer than 44 bytes (in Redis 6.0+, previously 39 bytes)<br>Stores the string data in a separate memory allocation<br>Uses a standard SDS (Simple Dynamic String) structure<br>More memory overhead due to separate allocation, but handles large strings efficiently</li>
<li><strong>EMBSTR (Embedded String)</strong><br>Used for strings 44 bytes or shorter that cannot be represented as integers<br>Embeds the string data directly within the Redis object structure in a single memory allocation<br>More memory-efficient than RAW for short strings<br>Read-only - if you modify an EMBSTR, Redis converts it to RAW encoding</li>
<li><strong>INT</strong><br>Used when the string value can be represented as a 64-bit signed integer<br>Examples: “123”, “-456”, “0”<br>Stores the integer directly in the Redis object structure<br>Most memory-efficient encoding for numeric strings<br>Redis can perform certain operations (like INCR) directly on the integer without conversion</li>
</ul>
<h3 id="String-Use-Cases-and-Examples"><a href="#String-Use-Cases-and-Examples" class="headerlink" title="String Use Cases and Examples"></a>String Use Cases and Examples</h3><h4 id="User-Session-Caching"><a href="#User-Session-Caching" class="headerlink" title="User Session Caching"></a>User Session Caching</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Store user session data</span></span><br><span class="line">SET user:session:12345 <span class="string">&#x27;&#123;&quot;user_id&quot;:12345,&quot;username&quot;:&quot;john&quot;,&quot;role&quot;:&quot;admin&quot;&#125;&#x27;</span></span><br><span class="line">EXPIRE user:session:12345 3600</span><br><span class="line"></span><br><span class="line"><span class="comment"># Retrieve session</span></span><br><span class="line">GET user:session:12345</span><br></pre></td></tr></table></figure>

<h4 id="Atomic-Counters"><a href="#Atomic-Counters" class="headerlink" title="Atomic Counters"></a>Atomic Counters</h4><p>Page view counter</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INCR page:views:homepage</span><br><span class="line">INCRBY user:points:123 50</span><br></pre></td></tr></table></figure>
<p>Rate limiting</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">is_rate_limited</span>(<span class="params">user_id, limit=<span class="number">100</span>, window=<span class="number">3600</span></span>):</span><br><span class="line">    key = <span class="string">f&quot;rate_limit:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">    current = r.incr(key)</span><br><span class="line">    <span class="keyword">if</span> current == <span class="number">1</span>:</span><br><span class="line">        r.expire(key, window)</span><br><span class="line">    <span class="keyword">return</span> current &gt; limit</span><br></pre></td></tr></table></figure>

<h4 id="Distributed-Locks-with-SETNX"><a href="#Distributed-Locks-with-SETNX" class="headerlink" title="Distributed Locks with SETNX"></a>Distributed Locks with SETNX</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">acquire_lock</span>(<span class="params">redis_client, lock_key, timeout=<span class="number">10</span></span>):</span><br><span class="line">    identifier = <span class="built_in">str</span>(uuid.uuid4())</span><br><span class="line">    end = time.time() + timeout</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> time.time() &lt; end:</span><br><span class="line">        <span class="keyword">if</span> redis_client.<span class="built_in">set</span>(lock_key, identifier, nx=<span class="literal">True</span>, ex=timeout):</span><br><span class="line">            <span class="keyword">return</span> identifier</span><br><span class="line">        time.sleep(<span class="number">0.001</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">release_lock</span>(<span class="params">redis_client, lock_key, identifier</span>):</span><br><span class="line">    pipe = redis_client.pipeline(<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            pipe.watch(lock_key)</span><br><span class="line">            <span class="keyword">if</span> pipe.get(lock_key) == identifier:</span><br><span class="line">                pipe.multi()</span><br><span class="line">                pipe.delete(lock_key)</span><br><span class="line">                pipe.execute()</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            pipe.unwatch()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> redis.WatchError:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<p><strong>Interview Question</strong>: <em>Why does Redis use SDS instead of C strings?</em><br><strong>Answer</strong>: SDS provides O(1) length operations, prevents buffer overflows, supports binary data, and offers efficient memory management through pre-allocation strategies, making it superior for database operations.</p>
<h2 id="List-Data-Type-Implementation"><a href="#List-Data-Type-Implementation" class="headerlink" title="List Data Type Implementation"></a>List Data Type Implementation</h2><h3 id="Evolution-of-List-Implementation"><a href="#Evolution-of-List-Implementation" class="headerlink" title="Evolution of List Implementation"></a>Evolution of List Implementation</h3><p>Redis lists have evolved through different implementations:</p>
<pre>
<code class="mermaid">
graph LR
A[Redis &lt; 3.2] --&gt; B[Doubly Linked List + Ziplist]
B --&gt; C[Redis &gt;&#x3D; 3.2] 
C --&gt; D[Quicklist Only]

E[Quicklist] --&gt; F[Linked List of Ziplists]
E --&gt; G[Memory Efficient]
E --&gt; H[Cache Friendly]
</code>
</pre>

<h3 id="Quicklist-Structure"><a href="#Quicklist-Structure" class="headerlink" title="Quicklist Structure"></a>Quicklist Structure</h3><p>Quicklist combines the benefits of linked lists and ziplists:</p>
<ul>
<li><strong>Linked list of ziplists</strong>: Each node contains a compressed ziplist</li>
<li><strong>Configurable compression</strong>: LZ4 compression for memory efficiency</li>
<li><strong>Balanced performance</strong>: Good for both ends, operations, and memory usage</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">quicklist</span> &#123;</span></span><br><span class="line">    quicklistNode *head;</span><br><span class="line">    quicklistNode *tail;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> count;    <span class="comment">// Total elements</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> len;      <span class="comment">// Number of nodes</span></span><br><span class="line">&#125; quicklist;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">quicklistNode</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">quicklistNode</span> *<span class="title">prev</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">quicklistNode</span> *<span class="title">next</span>;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *zl;      <span class="comment">// Ziplist</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> sz;        <span class="comment">// Ziplist size</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> count;     <span class="comment">// Elements in ziplist</span></span><br><span class="line">&#125; quicklistNode;</span><br></pre></td></tr></table></figure>

<h3 id="List-Use-Cases-and-Examples"><a href="#List-Use-Cases-and-Examples" class="headerlink" title="List Use Cases and Examples"></a>List Use Cases and Examples</h3><h4 id="Message-Queue-Implementation"><a href="#Message-Queue-Implementation" class="headerlink" title="Message Queue Implementation"></a>Message Queue Implementation</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Producer</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_message</span>(<span class="params">redis_client, queue_name, message</span>):</span><br><span class="line">    redis_client.lpush(queue_name, json.dumps(message))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Consumer</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">consume_messages</span>(<span class="params">redis_client, queue_name</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        message = redis_client.brpop(queue_name, timeout=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> message:</span><br><span class="line">            process_message(json.loads(message[<span class="number">1</span>]))</span><br></pre></td></tr></table></figure>

<h4 id="Latest-Articles-List"><a href="#Latest-Articles-List" class="headerlink" title="Latest Articles List"></a>Latest Articles List</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Add new article (keep only latest 100)</span></span><br><span class="line">LPUSH latest:articles:tech <span class="string">&quot;article:12345&quot;</span></span><br><span class="line">LTRIM latest:articles:tech 0 99</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get the latest 10 articles</span></span><br><span class="line">LRANGE latest:articles:tech 0 9</span><br><span class="line"></span><br><span class="line"><span class="comment"># Timeline implementation</span></span><br><span class="line">LPUSH user:timeline:123 <span class="string">&quot;post:456&quot;</span></span><br><span class="line">LRANGE user:timeline:123 0 19  <span class="comment"># Get latest 20 posts</span></span><br></pre></td></tr></table></figure>

<h4 id="Activity-Feed"><a href="#Activity-Feed" class="headerlink" title="Activity Feed"></a>Activity Feed</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add_activity</span>(<span class="params">user_id, activity</span>):</span><br><span class="line">    key = <span class="string">f&quot;feed:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">    redis_client.lpush(key, json.dumps(activity))</span><br><span class="line">    redis_client.ltrim(key, <span class="number">0</span>, <span class="number">999</span>)  <span class="comment"># Keep latest 1000 activities</span></span><br><span class="line">    redis_client.expire(key, <span class="number">86400</span> * <span class="number">7</span>)  <span class="comment"># Expire in 7 days</span></span><br></pre></td></tr></table></figure>

<p><strong>Interview Question</strong>: <em>How would you implement a reliable message queue using Redis lists?</em><br><strong>Answer</strong>: Use BRPOPLPUSH for atomic move operations between queues, implement acknowledgment patterns with backup queues, and use Lua scripts for complex atomic operations.</p>
<h2 id="Set-Data-Type-Implementation"><a href="#Set-Data-Type-Implementation" class="headerlink" title="Set Data Type Implementation"></a>Set Data Type Implementation</h2><h3 id="Dual-Implementation-Strategy"><a href="#Dual-Implementation-Strategy" class="headerlink" title="Dual Implementation Strategy"></a>Dual Implementation Strategy</h3><p>Redis sets use different underlying structures based on data characteristics:</p>
<pre>
<code class="mermaid">
flowchart TD
A[Redis Set] --&gt; B{Data Type Check}
B --&gt;|All Integers| C{Size Check}
B --&gt;|Mixed Types| D[Hash Table]

C --&gt;|Small| E[IntSet]
C --&gt;|Large| D

E --&gt; F[Memory Compact]
E --&gt; G[Sorted Array]
D --&gt; H[&quot;Fast O(1) Operations&quot;]
D --&gt; I[Higher Memory Usage]
</code>
</pre>

<h3 id="IntSet-Implementation"><a href="#IntSet-Implementation" class="headerlink" title="IntSet Implementation"></a>IntSet Implementation</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">intset</span> &#123;</span></span><br><span class="line">    <span class="type">uint32_t</span> encoding;  <span class="comment">// INTSET_ENC_INT16/32/64</span></span><br><span class="line">    <span class="type">uint32_t</span> length;    <span class="comment">// Number of elements</span></span><br><span class="line">    <span class="type">int8_t</span> contents[];  <span class="comment">// Sorted array of integers</span></span><br><span class="line">&#125; intset;</span><br></pre></td></tr></table></figure>

<h3 id="IntSet-vs-Hash-Table"><a href="#IntSet-vs-Hash-Table" class="headerlink" title="IntSet vs Hash Table"></a>IntSet vs Hash Table</h3><ul>
<li><strong>IntSet</strong>: Used when all elements are integers and the set size is small</li>
<li><strong>Hash Table</strong>: Used for larger sets or sets containing non-integer values</li>
</ul>
<h3 id="Set-Use-Cases-and-Examples"><a href="#Set-Use-Cases-and-Examples" class="headerlink" title="Set Use Cases and Examples"></a>Set Use Cases and Examples</h3><h4 id="Tag-System"><a href="#Tag-System" class="headerlink" title="Tag System"></a>Tag System</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Add tags to articles</span></span><br><span class="line">SADD article:123:tags <span class="string">&quot;redis&quot;</span> <span class="string">&quot;database&quot;</span> <span class="string">&quot;nosql&quot;</span></span><br><span class="line">SADD article:456:tags <span class="string">&quot;redis&quot;</span> <span class="string">&quot;caching&quot;</span> <span class="string">&quot;performance&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Find articles with a specific tag</span></span><br><span class="line">SINTER article:123:tags article:456:tags  <span class="comment"># Common tags</span></span><br><span class="line">SUNION article:123:tags article:456:tags  <span class="comment"># All tags</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TagSystem</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.redis = redis.Redis()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_tags</span>(<span class="params">self, item_id, tags</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Add tags to an item&quot;&quot;&quot;</span></span><br><span class="line">        key = <span class="string">f&quot;item:tags:<span class="subst">&#123;item_id&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.sadd(key, *tags)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_tags</span>(<span class="params">self, item_id</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Get all tags for an item&quot;&quot;&quot;</span></span><br><span class="line">        key = <span class="string">f&quot;item:tags:<span class="subst">&#123;item_id&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.smembers(key)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find_items_with_all_tags</span>(<span class="params">self, tags</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Find items that have ALL specified tags&quot;&quot;&quot;</span></span><br><span class="line">        tag_keys = [<span class="string">f&quot;tag:items:<span class="subst">&#123;tag&#125;</span>&quot;</span> <span class="keyword">for</span> tag <span class="keyword">in</span> tags]</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.sinter(*tag_keys)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find_items_with_any_tags</span>(<span class="params">self, tags</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Find items that have ANY of the specified tags&quot;&quot;&quot;</span></span><br><span class="line">        tag_keys = [<span class="string">f&quot;tag:items:<span class="subst">&#123;tag&#125;</span>&quot;</span> <span class="keyword">for</span> tag <span class="keyword">in</span> tags]</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.sunion(*tag_keys)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Usage</span></span><br><span class="line">tag_system = TagSystem()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tag some articles</span></span><br><span class="line">tag_system.add_tags(<span class="string">&quot;article:1&quot;</span>, [<span class="string">&quot;python&quot;</span>, <span class="string">&quot;redis&quot;</span>, <span class="string">&quot;database&quot;</span>])</span><br><span class="line">tag_system.add_tags(<span class="string">&quot;article:2&quot;</span>, [<span class="string">&quot;python&quot;</span>, <span class="string">&quot;web&quot;</span>, <span class="string">&quot;flask&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Find articles with both &quot;python&quot; and &quot;redis&quot;</span></span><br><span class="line">matching_articles = tag_system.find_items_with_all_tags([<span class="string">&quot;python&quot;</span>, <span class="string">&quot;redis&quot;</span>])</span><br></pre></td></tr></table></figure>

<h4 id="User-Interests-and-Recommendations"><a href="#User-Interests-and-Recommendations" class="headerlink" title="User Interests and Recommendations"></a>User Interests and Recommendations</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add_user_interest</span>(<span class="params">user_id, interest</span>):</span><br><span class="line">    redis_client.sadd(<span class="string">f&quot;user:<span class="subst">&#123;user_id&#125;</span>:interests&quot;</span>, interest)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_similar_users</span>(<span class="params">user_id</span>):</span><br><span class="line">    user_interests = <span class="string">f&quot;user:<span class="subst">&#123;user_id&#125;</span>:interests&quot;</span></span><br><span class="line">    similar_users = []</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Find users with common interests</span></span><br><span class="line">    <span class="keyword">for</span> other_user <span class="keyword">in</span> get_all_users():</span><br><span class="line">        <span class="keyword">if</span> other_user != user_id:</span><br><span class="line">            common_interests = redis_client.sinter(</span><br><span class="line">                user_interests, </span><br><span class="line">                <span class="string">f&quot;user:<span class="subst">&#123;other_user&#125;</span>:interests&quot;</span></span><br><span class="line">            )</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(common_interests) &gt;= <span class="number">3</span>:  <span class="comment"># Threshold</span></span><br><span class="line">                similar_users.append(other_user)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> similar_users</span><br></pre></td></tr></table></figure>
<h4 id="Social-Features-Mutual-Friends"><a href="#Social-Features-Mutual-Friends" class="headerlink" title="Social Features: Mutual Friends"></a>Social Features: Mutual Friends</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">find_mutual_friends</span>(<span class="params">user1_id, user2_id</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Find mutual friends between two users&quot;&quot;&quot;</span></span><br><span class="line">    friends1_key = <span class="string">f&quot;user:friends:<span class="subst">&#123;user1_id&#125;</span>&quot;</span></span><br><span class="line">    friends2_key = <span class="string">f&quot;user:friends:<span class="subst">&#123;user2_id&#125;</span>&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> r.sinter(friends1_key, friends2_key)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">suggest_friends</span>(<span class="params">user_id, limit=<span class="number">10</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Suggest friends based on mutual connections&quot;&quot;&quot;</span></span><br><span class="line">    user_friends_key = <span class="string">f&quot;user:friends:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">    user_friends = r.smembers(user_friends_key)</span><br><span class="line">    </span><br><span class="line">    suggestions = <span class="built_in">set</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> friend_id <span class="keyword">in</span> user_friends:</span><br><span class="line">        friend_friends_key = <span class="string">f&quot;user:friends:<span class="subst">&#123;friend_id&#125;</span>&quot;</span></span><br><span class="line">        <span class="comment"># Get friends of friends, excluding current user and existing friends</span></span><br><span class="line">        potential_friends = r.sdiff(friend_friends_key, user_friends_key, user_id)</span><br><span class="line">        suggestions.update(potential_friends)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(suggestions)[:limit]</span><br></pre></td></tr></table></figure>
<h4 id="Online-Users-Tracking"><a href="#Online-Users-Tracking" class="headerlink" title="Online Users Tracking"></a>Online Users Tracking</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Track online users</span></span><br><span class="line">SADD online:<span class="built_in">users</span> <span class="string">&quot;user:123&quot;</span> <span class="string">&quot;user:456&quot;</span></span><br><span class="line">SREM online:<span class="built_in">users</span> <span class="string">&quot;user:789&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Check if user is online</span></span><br><span class="line">SISMEMBER online:<span class="built_in">users</span> <span class="string">&quot;user:123&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Get all online users</span></span><br><span class="line">SMEMBERS online:<span class="built_in">users</span></span><br></pre></td></tr></table></figure>

<p><strong>Interview Question</strong>: <em>When would Redis choose IntSet over Hash Table for sets?</em><br><strong>Answer</strong>: IntSet is chosen when all elements are integers and the set size is below the configured threshold (default 512 elements), providing better memory efficiency and acceptable O(log n) performance.</p>
<h2 id="Sorted-Set-ZSet-Implementation"><a href="#Sorted-Set-ZSet-Implementation" class="headerlink" title="Sorted Set (ZSet) Implementation"></a>Sorted Set (ZSet) Implementation</h2><h3 id="Hybrid-Data-Structure"><a href="#Hybrid-Data-Structure" class="headerlink" title="Hybrid Data Structure"></a>Hybrid Data Structure</h3><p>Sorted Sets use a combination of two data structures for optimal performance:</p>
<pre>
<code class="mermaid">
graph TD
A[Sorted Set] --&gt; B[Skip List]
A --&gt; C[Hash Table]

B --&gt; D[&quot;Range queries O(log n)&quot;]
B --&gt; E[Ordered iteration]

C --&gt; F[&quot;Score lookup O(1)&quot;]
C --&gt; G[&quot;Member existence O(1)&quot;]

H[Small ZSets] --&gt; I[Ziplist]
I --&gt; J[Memory efficient]
I --&gt; K[Linear scan acceptable]
</code>
</pre>
<h3 id="Skip-List-Structure"><a href="#Skip-List-Structure" class="headerlink" title="Skip List Structure"></a>Skip List Structure</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">zskiplistNode</span> &#123;</span></span><br><span class="line">    sds ele;                          <span class="comment">// Member</span></span><br><span class="line">    <span class="type">double</span> score;                     <span class="comment">// Score</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">zskiplistNode</span> *<span class="title">backward</span>;</span>   <span class="comment">// Previous node</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">zskiplistLevel</span> &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">zskiplistNode</span> *<span class="title">forward</span>;</span></span><br><span class="line">        <span class="type">unsigned</span> <span class="type">long</span> span;           <span class="comment">// Distance to next node</span></span><br><span class="line">    &#125; level[];</span><br><span class="line">&#125; zskiplistNode;</span><br></pre></td></tr></table></figure>
<h3 id="Skip-List-Advantages"><a href="#Skip-List-Advantages" class="headerlink" title="Skip List Advantages"></a>Skip List Advantages</h3><ul>
<li><strong>Probabilistic data structure</strong>: Average O(log n) complexity</li>
<li><strong>Range query friendly</strong>: Efficient ZRANGE operations</li>
<li><strong>Memory efficient</strong>: Less overhead than balanced trees</li>
<li><strong>Simple implementation</strong>: Easier to maintain than AVL&#x2F;Red-Black trees</li>
</ul>
<h3 id="ZSet-Use-Cases-and-Examples"><a href="#ZSet-Use-Cases-and-Examples" class="headerlink" title="ZSet Use Cases and Examples"></a>ZSet Use Cases and Examples</h3><h4 id="Leaderboard-System"><a href="#Leaderboard-System" class="headerlink" title="Leaderboard System"></a>Leaderboard System</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">GameLeaderboard</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, game_id</span>):</span><br><span class="line">        <span class="variable language_">self</span>.redis = redis.Redis()</span><br><span class="line">        <span class="variable language_">self</span>.leaderboard_key = <span class="string">f&quot;game:leaderboard:<span class="subst">&#123;game_id&#125;</span>&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update_score</span>(<span class="params">self, player_id, score</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Update player&#x27;s score (higher score = better rank)&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.zadd(<span class="variable language_">self</span>.leaderboard_key, &#123;player_id: score&#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_top_players</span>(<span class="params">self, count=<span class="number">10</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Get top N players with their scores&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.zrevrange(</span><br><span class="line">            <span class="variable language_">self</span>.leaderboard_key, <span class="number">0</span>, count-<span class="number">1</span>, withscores=<span class="literal">True</span></span><br><span class="line">        )</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_player_rank</span>(<span class="params">self, player_id</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Get player&#x27;s current rank (0-based)&quot;&quot;&quot;</span></span><br><span class="line">        rank = <span class="variable language_">self</span>.redis.zrevrank(<span class="variable language_">self</span>.leaderboard_key, player_id)</span><br><span class="line">        <span class="keyword">return</span> rank + <span class="number">1</span> <span class="keyword">if</span> rank <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_players_in_range</span>(<span class="params">self, min_score, max_score</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Get players within score range&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.zrangebyscore(</span><br><span class="line">            <span class="variable language_">self</span>.leaderboard_key, min_score, max_score, withscores=<span class="literal">True</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line"><span class="comment"># Usage</span></span><br><span class="line">leaderboard = GameLeaderboard(<span class="string">&quot;tetris&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Update scores</span></span><br><span class="line">leaderboard.update_score(<span class="string">&quot;player1&quot;</span>, <span class="number">15000</span>)</span><br><span class="line">leaderboard.update_score(<span class="string">&quot;player2&quot;</span>, <span class="number">12000</span>)</span><br><span class="line">leaderboard.update_score(<span class="string">&quot;player3&quot;</span>, <span class="number">18000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get top 5 players</span></span><br><span class="line">top_players = leaderboard.get_top_players(<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Top players: <span class="subst">&#123;top_players&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get specific player rank</span></span><br><span class="line">rank = leaderboard.get_player_rank(<span class="string">&quot;player1&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Player1 rank: <span class="subst">&#123;rank&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Time-based-Delayed-Queue"><a href="#Time-based-Delayed-Queue" class="headerlink" title="Time-based Delayed Queue"></a>Time-based Delayed Queue</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DelayedJobQueue</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, queue_name</span>):</span><br><span class="line">        <span class="variable language_">self</span>.redis = redis.Redis()</span><br><span class="line">        <span class="variable language_">self</span>.queue_key = <span class="string">f&quot;delayed_jobs:<span class="subst">&#123;queue_name&#125;</span>&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">schedule_job</span>(<span class="params">self, job_data, delay_seconds</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Schedule a job to run after delay_seconds&quot;&quot;&quot;</span></span><br><span class="line">        execute_at = time.time() + delay_seconds</span><br><span class="line">        job_id = <span class="string">f&quot;job:<span class="subst">&#123;<span class="built_in">int</span>(time.time() * <span class="number">1000000</span>)&#125;</span>&quot;</span>  <span class="comment"># Microsecond timestamp</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Store job data</span></span><br><span class="line">        job_key = <span class="string">f&quot;job_data:<span class="subst">&#123;job_id&#125;</span>&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.redis.setex(job_key, delay_seconds + <span class="number">3600</span>, json.dumps(job_data))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Schedule execution</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.zadd(<span class="variable language_">self</span>.queue_key, &#123;job_id: execute_at&#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_ready_jobs</span>(<span class="params">self, limit=<span class="number">10</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Get jobs ready to be executed&quot;&quot;&quot;</span></span><br><span class="line">        now = time.time()</span><br><span class="line">        ready_jobs = <span class="variable language_">self</span>.redis.zrangebyscore(</span><br><span class="line">            <span class="variable language_">self</span>.queue_key, <span class="number">0</span>, now, start=<span class="number">0</span>, num=limit</span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ready_jobs:</span><br><span class="line">            <span class="comment"># Remove from queue atomically</span></span><br><span class="line">            pipe = <span class="variable language_">self</span>.redis.pipeline()</span><br><span class="line">            <span class="keyword">for</span> job_id <span class="keyword">in</span> ready_jobs:</span><br><span class="line">                pipe.zrem(<span class="variable language_">self</span>.queue_key, job_id)</span><br><span class="line">            pipe.execute()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> ready_jobs</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_job_data</span>(<span class="params">self, job_id</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Retrieve job data&quot;&quot;&quot;</span></span><br><span class="line">        job_key = <span class="string">f&quot;job_data:<span class="subst">&#123;job_id&#125;</span>&quot;</span></span><br><span class="line">        data = <span class="variable language_">self</span>.redis.get(job_key)</span><br><span class="line">        <span class="keyword">return</span> json.loads(data) <span class="keyword">if</span> data <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Usage</span></span><br><span class="line">delayed_queue = DelayedJobQueue(<span class="string">&quot;email_notifications&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Schedule an email to be sent in 1 hour</span></span><br><span class="line">delayed_queue.schedule_job(&#123;</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;email&quot;</span>,</span><br><span class="line">    <span class="string">&quot;to&quot;</span>: <span class="string">&quot;user@example.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;template&quot;</span>: <span class="string">&quot;reminder&quot;</span>,</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;John&quot;</span>&#125;</span><br><span class="line">&#125;, <span class="number">3600</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Trending-Content"><a href="#Trending-Content" class="headerlink" title="Trending Content"></a>Trending Content</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Track content popularity with time decay</span></span><br><span class="line">ZADD trending:articles 1609459200 <span class="string">&quot;article:123&quot;</span></span><br><span class="line">ZADD trending:articles 1609462800 <span class="string">&quot;article:456&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Get trending articles (recent first)</span></span><br><span class="line">ZREVRANGE trending:articles 0 9 WITHSCORES</span><br><span class="line"></span><br><span class="line"><span class="comment"># Clean old entries</span></span><br><span class="line">ZREMRANGEBYSCORE trending:articles 0 (current_timestamp - 86400)</span><br></pre></td></tr></table></figure>

<p><strong>Interview Question</strong>: <em>Why does Redis use both skip list and hash table for sorted sets?</em><br><strong>Answer</strong>: Skip list enables efficient range operations and ordered traversal in O(log n), while hash table provides O(1) score lookups and member existence checks. This dual structure optimizes for all sorted set operations.</p>
<h2 id="Hash-Data-Type-Implementation"><a href="#Hash-Data-Type-Implementation" class="headerlink" title="Hash Data Type Implementation"></a>Hash Data Type Implementation</h2><h3 id="Adaptive-Data-Structure"><a href="#Adaptive-Data-Structure" class="headerlink" title="Adaptive Data Structure"></a>Adaptive Data Structure</h3><p>Redis hashes optimize memory usage through conditional implementation:</p>
<pre>
<code class="mermaid">
graph TD
A[Redis Hash] --&gt; B{Small hash?}
B --&gt;|Yes| C[Ziplist]
B --&gt;|No| D[Hash Table]

C --&gt; E[Sequential key-value pairs]
C --&gt; F[Memory efficient]
C --&gt; G[&quot;O(n) field access&quot;]

D --&gt; H[Separate chaining]
D --&gt; I[&quot;O(1) average access&quot;]
D --&gt; J[Higher memory overhead]
</code>
</pre>

<h3 id="Configuration-Thresholds"><a href="#Configuration-Thresholds" class="headerlink" title="Configuration Thresholds"></a>Configuration Thresholds</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Hash conversion thresholds</span></span><br><span class="line">hash-max-ziplist-entries 512</span><br><span class="line">hash-max-ziplist-value 64</span><br></pre></td></tr></table></figure>

<h3 id="Hash-Use-Cases-and-Examples"><a href="#Hash-Use-Cases-and-Examples" class="headerlink" title="Hash Use Cases and Examples"></a>Hash Use Cases and Examples</h3><h4 id="Object-Storage"><a href="#Object-Storage" class="headerlink" title="Object Storage"></a>Object Storage</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UserProfileManager</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.redis = redis.Redis()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">save_profile</span>(<span class="params">self, user_id, profile_data</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Save user profile as hash&quot;&quot;&quot;</span></span><br><span class="line">        key = <span class="string">f&quot;user:profile:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.hset(key, mapping=profile_data)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_profile</span>(<span class="params">self, user_id</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Get complete user profile&quot;&quot;&quot;</span></span><br><span class="line">        key = <span class="string">f&quot;user:profile:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.hgetall(key)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update_field</span>(<span class="params">self, user_id, field, value</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Update single profile field&quot;&quot;&quot;</span></span><br><span class="line">        key = <span class="string">f&quot;user:profile:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.hset(key, field, value)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_field</span>(<span class="params">self, user_id, field</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Get single profile field&quot;&quot;&quot;</span></span><br><span class="line">        key = <span class="string">f&quot;user:profile:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.hget(key, field)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">increment_counter</span>(<span class="params">self, user_id, counter_name, amount=<span class="number">1</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Increment a counter field&quot;&quot;&quot;</span></span><br><span class="line">        key = <span class="string">f&quot;user:profile:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.hincrby(key, counter_name, amount)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Usage</span></span><br><span class="line">profile_manager = UserProfileManager()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Save user profile</span></span><br><span class="line">profile_manager.save_profile(<span class="string">&quot;user:123&quot;</span>, &#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Alice Johnson&quot;</span>,</span><br><span class="line">    <span class="string">&quot;email&quot;</span>: <span class="string">&quot;alice@example.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;age&quot;</span>: <span class="string">&quot;28&quot;</span>,</span><br><span class="line">    <span class="string">&quot;city&quot;</span>: <span class="string">&quot;San Francisco&quot;</span>,</span><br><span class="line">    <span class="string">&quot;login_count&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;last_login&quot;</span>: <span class="built_in">str</span>(<span class="built_in">int</span>(time.time()))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Update specific field</span></span><br><span class="line">profile_manager.update_field(<span class="string">&quot;user:123&quot;</span>, <span class="string">&quot;city&quot;</span>, <span class="string">&quot;New York&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Increment login counter</span></span><br><span class="line">profile_manager.increment_counter(<span class="string">&quot;user:123&quot;</span>, <span class="string">&quot;login_count&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Shopping-Cart"><a href="#Shopping-Cart" class="headerlink" title="Shopping Cart"></a>Shopping Cart</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add_to_cart</span>(<span class="params">user_id, product_id, quantity</span>):</span><br><span class="line">    cart_key = <span class="string">f&quot;cart:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">    redis_client.hset(cart_key, product_id, quantity)</span><br><span class="line">    redis_client.expire(cart_key, <span class="number">86400</span> * <span class="number">7</span>)  <span class="comment"># 7 days</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cart_items</span>(<span class="params">user_id</span>):</span><br><span class="line">    <span class="keyword">return</span> redis_client.hgetall(<span class="string">f&quot;cart:<span class="subst">&#123;user_id&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_cart_quantity</span>(<span class="params">user_id, product_id, quantity</span>):</span><br><span class="line">    <span class="keyword">if</span> quantity &lt;= <span class="number">0</span>:</span><br><span class="line">        redis_client.hdel(<span class="string">f&quot;cart:<span class="subst">&#123;user_id&#125;</span>&quot;</span>, product_id)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        redis_client.hset(<span class="string">f&quot;cart:<span class="subst">&#123;user_id&#125;</span>&quot;</span>, product_id, quantity)</span><br></pre></td></tr></table></figure>

<h4 id="Configuration-Management"><a href="#Configuration-Management" class="headerlink" title="Configuration Management"></a>Configuration Management</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Application configuration</span></span><br><span class="line">HSET app:config:prod <span class="string">&quot;db_host&quot;</span> <span class="string">&quot;prod-db.example.com&quot;</span></span><br><span class="line">HSET app:config:prod <span class="string">&quot;cache_ttl&quot;</span> <span class="string">&quot;3600&quot;</span></span><br><span class="line">HSET app:config:prod <span class="string">&quot;max_connections&quot;</span> <span class="string">&quot;100&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Feature flags</span></span><br><span class="line">HSET features:flags <span class="string">&quot;new_ui&quot;</span> <span class="string">&quot;enabled&quot;</span></span><br><span class="line">HSET features:flags <span class="string">&quot;beta_feature&quot;</span> <span class="string">&quot;disabled&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>Interview Question</strong>: <em>When would you choose Hash over String for storing objects?</em><br><strong>Answer</strong>: Use Hash when you need to access individual fields frequently without deserializing the entire object, when the object has many fields, or when you want to use Redis hash-specific operations like HINCRBY for counters within objects.</p>
<h2 id="Advanced-Data-Types"><a href="#Advanced-Data-Types" class="headerlink" title="Advanced Data Types"></a>Advanced Data Types</h2><h3 id="Bitmap-Space-Efficient-Boolean-Arrays"><a href="#Bitmap-Space-Efficient-Boolean-Arrays" class="headerlink" title="Bitmap: Space-Efficient Boolean Arrays"></a>Bitmap: Space-Efficient Boolean Arrays</h3><p>Bitmaps in Redis are strings that support bit-level operations. Each bit can represent a Boolean state for a specific ID or position.</p>
<pre>
<code class="mermaid">
graph LR
A[Bitmap] --&gt; B[String Representation]
B --&gt; C[Bit Position 0]
B --&gt; D[Bit Position 1]
B --&gt; E[Bit Position 2]
B --&gt; F[... Bit Position N]

C --&gt; C1[User ID 1]
D --&gt; D1[User ID 2]
E --&gt; E1[User ID 3]
F --&gt; F1[User ID N+1]
</code>
</pre>

<h4 id="Use-Case-1-User-Activity-Tracking"><a href="#Use-Case-1-User-Activity-Tracking" class="headerlink" title="Use Case 1: User Activity Tracking"></a>Use Case 1: User Activity Tracking</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Daily active users (bit position = user ID)</span></span><br><span class="line">SETBIT daily_active:2024-01-15 1001 1  <span class="comment"># User 1001 was active</span></span><br><span class="line">SETBIT daily_active:2024-01-15 1002 1  <span class="comment"># User 1002 was active</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Check if user was active</span></span><br><span class="line">GETBIT daily_active:2024-01-15 1001</span><br><span class="line"></span><br><span class="line"><span class="comment"># Count active users</span></span><br><span class="line">BITCOUNT daily_active:2024-01-15</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UserActivityTracker</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.redis = redis.Redis()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mark_daily_active</span>(<span class="params">self, user_id, date</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Mark user as active on specific date&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># Use day of year as bit position</span></span><br><span class="line">        day_of_year = date.timetuple().tm_yday - <span class="number">1</span>  <span class="comment"># 0-based</span></span><br><span class="line">        key = <span class="string">f&quot;daily_active:<span class="subst">&#123;date.year&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.setbit(key, day_of_year * <span class="number">1000000</span> + user_id, <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">is_active_on_date</span>(<span class="params">self, user_id, date</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Check if user was active on specific date&quot;&quot;&quot;</span></span><br><span class="line">        day_of_year = date.timetuple().tm_yday - <span class="number">1</span></span><br><span class="line">        key = <span class="string">f&quot;daily_active:<span class="subst">&#123;date.year&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bool</span>(<span class="variable language_">self</span>.redis.getbit(key, day_of_year * <span class="number">1000000</span> + user_id))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">count_active_users</span>(<span class="params">self, date</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Count active users on specific date (simplified)&quot;&quot;&quot;</span></span><br><span class="line">        key = <span class="string">f&quot;daily_active:<span class="subst">&#123;date.year&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.bitcount(key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Real-time analytics with bitmaps</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">track_feature_usage</span>(<span class="params">user_id, feature_id</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Track which features each user has used&quot;&quot;&quot;</span></span><br><span class="line">    key = <span class="string">f&quot;user:features:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">    r.setbit(key, feature_id, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_user_features</span>(<span class="params">user_id</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Get all features used by user&quot;&quot;&quot;</span></span><br><span class="line">    key = <span class="string">f&quot;user:features:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">    <span class="comment"># This would need additional logic to extract set bits</span></span><br><span class="line">    <span class="keyword">return</span> r.get(key)</span><br></pre></td></tr></table></figure>
<h4 id="Use-Case-2-Feature-Flags"><a href="#Use-Case-2-Feature-Flags" class="headerlink" title="Use Case 2: Feature Flags"></a>Use Case 2: Feature Flags</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Feature availability (bit position = feature ID)</span></span><br><span class="line">SETBIT user:1001:features 0 1  <span class="comment"># Feature 0 enabled</span></span><br><span class="line">SETBIT user:1001:features 2 1  <span class="comment"># Feature 2 enabled</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Check feature access</span></span><br><span class="line">GETBIT user:1001:features 0</span><br></pre></td></tr></table></figure>

<h4 id="Use-Case-3-A-B-Testing"><a href="#Use-Case-3-A-B-Testing" class="headerlink" title="Use Case 3:  A&#x2F;B Testing"></a>Use Case 3:  A&#x2F;B Testing</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Test group assignment</span></span><br><span class="line">SETBIT experiment:feature_x:group_a 1001 1</span><br><span class="line">SETBIT experiment:feature_x:group_b 1002 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># Users in both experiments</span></span><br><span class="line">BITOP AND result experiment:feature_x:group_a experiment:other_experiment</span><br></pre></td></tr></table></figure>

<p><strong>🎯 Interview Insight</strong>: Bitmaps are extremely memory-efficient for representing large, sparse boolean datasets. One million users can be represented in just 125KB instead of several megabytes with other data structures.</p>
<h3 id="HyperLogLog-Probabilistic-Counting"><a href="#HyperLogLog-Probabilistic-Counting" class="headerlink" title="HyperLogLog: Probabilistic Counting"></a>HyperLogLog: Probabilistic Counting</h3><p>HyperLogLog uses probabilistic algorithms to estimate cardinality (unique count) with minimal memory usage.</p>
<pre>
<code class="mermaid">
graph TD
A[HyperLogLog] --&gt; B[Hash Function]
B --&gt; C[Leading Zeros Count]
C --&gt; D[Bucket Assignment]
D --&gt; E[Cardinality Estimation]

E --&gt; E1[Standard Error: 0.81%]
E --&gt; E2[Memory Usage: 12KB]
E --&gt; E3[Max Cardinality: 2^64]
</code>
</pre>

<h4 id="Algorithm-Principle"><a href="#Algorithm-Principle" class="headerlink" title="Algorithm Principle"></a>Algorithm Principle</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Simplified algorithm:</span></span><br><span class="line"><span class="comment"># 1. Hash each element</span></span><br><span class="line"><span class="comment"># 2. Count leading zeros in binary representation</span></span><br><span class="line"><span class="comment"># 3. Use bucket system for better accuracy</span></span><br><span class="line"><span class="comment"># 4. Apply harmonic mean for final estimation</span></span><br></pre></td></tr></table></figure>

<h4 id="Use-Case-1-Unique-Visitors"><a href="#Use-Case-1-Unique-Visitors" class="headerlink" title="Use Case 1: Unique Visitors"></a>Use Case 1: Unique Visitors</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UniqueVisitorCounter</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.redis = redis.Redis()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_visitor</span>(<span class="params">self, page_id, visitor_id</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Add visitor to unique count&quot;&quot;&quot;</span></span><br><span class="line">        key = <span class="string">f&quot;unique_visitors:<span class="subst">&#123;page_id&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.pfadd(key, visitor_id)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_unique_count</span>(<span class="params">self, page_id</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Get approximate unique visitor count&quot;&quot;&quot;</span></span><br><span class="line">        key = <span class="string">f&quot;unique_visitors:<span class="subst">&#123;page_id&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.pfcount(key)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">merge_counts</span>(<span class="params">self, destination, *source_pages</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Merge unique visitor counts from multiple pages&quot;&quot;&quot;</span></span><br><span class="line">        source_keys = [<span class="string">f&quot;unique_visitors:<span class="subst">&#123;page&#125;</span>&quot;</span> <span class="keyword">for</span> page <span class="keyword">in</span> source_pages]</span><br><span class="line">        dest_key = <span class="string">f&quot;unique_visitors:<span class="subst">&#123;destination&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.pfmerge(dest_key, *source_keys)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Usage - can handle millions of unique items with ~12KB memory</span></span><br><span class="line">visitor_counter = UniqueVisitorCounter()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Track visitors (can handle duplicates efficiently)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000000</span>):</span><br><span class="line">    visitor_counter.add_visitor(<span class="string">&quot;homepage&quot;</span>, <span class="string">f&quot;user_<span class="subst">&#123;i % <span class="number">50000</span>&#125;</span>&quot;</span>)  <span class="comment"># Many duplicates</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Get unique count (approximate, typically within 1% error)</span></span><br><span class="line">unique_count = visitor_counter.get_unique_count(<span class="string">&quot;homepage&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Approximate unique visitors: <span class="subst">&#123;unique_count&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Use-Case-2-Unique-Event-Counting"><a href="#Use-Case-2-Unique-Event-Counting" class="headerlink" title="Use Case 2: Unique Event Counting"></a>Use Case 2: Unique Event Counting</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Track unique events</span></span><br><span class="line">PFADD events:login user:1001 user:1002 user:1003</span><br><span class="line">PFADD events:purchase user:1001 user:1004</span><br><span class="line"></span><br><span class="line"><span class="comment"># Count unique users who performed any action</span></span><br><span class="line">PFMERGE events:total events:login events:purchase</span><br><span class="line">PFCOUNT events:total</span><br></pre></td></tr></table></figure>

<h4 id="Use-Case-3-Real-time-Analytics"><a href="#Use-Case-3-Real-time-Analytics" class="headerlink" title="Use Case 3: Real-time Analytics"></a>Use Case 3: Real-time Analytics</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Hourly unique visitors</span></span><br><span class="line">PFADD stats:$(<span class="built_in">date</span> +%Y%m%d%H):unique visitor_id_1 visitor_id_2</span><br><span class="line"></span><br><span class="line"><span class="comment"># Daily aggregation</span></span><br><span class="line"><span class="keyword">for</span> hour <span class="keyword">in</span> &#123;00..23&#125;; <span class="keyword">do</span></span><br><span class="line">    PFMERGE stats:$(<span class="built_in">date</span> +%Y%m%d):unique stats:$(<span class="built_in">date</span> +%Y%m%d)<span class="variable">$&#123;hour&#125;</span>:unique</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h4 id="Accuracy-vs-Memory-Trade-off"><a href="#Accuracy-vs-Memory-Trade-off" class="headerlink" title="Accuracy vs. Memory Trade-off"></a>Accuracy vs. Memory Trade-off</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HyperLogLog: 12KB for any cardinality up to 2^64</span></span><br><span class="line"><span class="comment"># Set: 1GB+ for 10 million unique elements</span></span><br><span class="line"><span class="comment"># Error rate: 0.81% standard error</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Example comparison:</span></span><br><span class="line"><span class="comment"># Counting 10M unique users:</span></span><br><span class="line"><span class="comment"># - Set: ~320MB memory, 100% accuracy</span></span><br><span class="line"><span class="comment"># - HyperLogLog: 12KB memory, 99.19% accuracy</span></span><br></pre></td></tr></table></figure>

<p><strong>🎯 Interview Insight</strong>: HyperLogLog trades a small amount of accuracy (0.81% standard error) for tremendous memory savings. It’s perfect for analytics where approximate counts are acceptable.</p>
<h3 id="Stream-Radix-Tree-Consumer-Groups"><a href="#Stream-Radix-Tree-Consumer-Groups" class="headerlink" title="Stream: Radix Tree + Consumer Groups"></a>Stream: Radix Tree + Consumer Groups</h3><p>Redis Streams use a radix tree (compressed trie) to store entries efficiently, with additional structures for consumer group management.</p>
<pre>
<code class="mermaid">
graph TD
A[Stream] --&gt; B[Radix Tree]
A --&gt; C[Consumer Groups]

B --&gt; B1[Stream Entries]
B --&gt; B2[Time-ordered IDs]
B --&gt; B3[Field-Value Pairs]

C --&gt; C1[Consumer Group State]
C --&gt; C2[Pending Entries List - PEL]
C --&gt; C3[Consumer Last Delivered ID]
</code>
</pre>

<h4 id="Stream-Entry-Structure"><a href="#Stream-Entry-Structure" class="headerlink" title="Stream Entry Structure"></a>Stream Entry Structure</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Stream ID format: timestamp-sequence</span></span><br><span class="line"><span class="comment"># Example: 1640995200000-0</span></span><br><span class="line"><span class="comment">#          |-------------|--- |</span></span><br><span class="line"><span class="comment">#          timestamp(ms)     sequence</span></span><br></pre></td></tr></table></figure>

<h4 id="Use-Case-1-Event-Sourcing"><a href="#Use-Case-1-Event-Sourcing" class="headerlink" title="Use Case 1: Event Sourcing"></a>Use Case 1: Event Sourcing</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Add events to stream</span></span><br><span class="line">XADD user:1001:events * action <span class="string">&quot;login&quot;</span> timestamp 1640995200 ip <span class="string">&quot;192.168.1.1&quot;</span></span><br><span class="line">XADD user:1001:events * action <span class="string">&quot;purchase&quot;</span> item <span class="string">&quot;laptop&quot;</span> amount 999.99</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read events</span></span><br><span class="line">XRANGE user:1001:events - + COUNT 10</span><br></pre></td></tr></table></figure>

<h4 id="Use-Case-2-Message-Queues-with-Consumer-Groups"><a href="#Use-Case-2-Message-Queues-with-Consumer-Groups" class="headerlink" title="Use Case 2: Message Queues with Consumer Groups"></a>Use Case 2: Message Queues with Consumer Groups</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create consumer group</span></span><br><span class="line">XGROUP CREATE mystream mygroup $ MKSTREAM</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add messages</span></span><br><span class="line">XADD mystream * task <span class="string">&quot;process_order&quot;</span> order_id 12345</span><br><span class="line"></span><br><span class="line"><span class="comment"># Consume messages</span></span><br><span class="line">XREADGROUP GROUP mygroup consumer1 COUNT 1 STREAMS mystream &gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Acknowledge processing</span></span><br><span class="line">XACK mystream mygroup 1640995200000-0</span><br></pre></td></tr></table></figure>

<h4 id="Use-Case-3-Real-time-Data-Processing"><a href="#Use-Case-3-Real-time-Data-Processing" class="headerlink" title="Use Case 3: Real-time Data Processing"></a>Use Case 3: Real-time Data Processing</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># IoT sensor data</span></span><br><span class="line">XADD sensors:temperature * sensor_id <span class="string">&quot;temp001&quot;</span> value 23.5 location <span class="string">&quot;room1&quot;</span></span><br><span class="line">XADD sensors:humidity * sensor_id <span class="string">&quot;hum001&quot;</span> value 45.2 location <span class="string">&quot;room1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Read latest data</span></span><br><span class="line">XREAD COUNT 10 STREAMS sensors:temperature sensors:humidity $ $</span><br></pre></td></tr></table></figure>

<p><strong>🎯 Interview Insight</strong>: Streams provide at-least-once delivery guarantees through the Pending Entries List (PEL), making them suitable for reliable message processing unlike simple pub&#x2F;sub.</p>
<h3 id="Geospatial-Sorted-Set-with-Geohash"><a href="#Geospatial-Sorted-Set-with-Geohash" class="headerlink" title="Geospatial: Sorted Set with Geohash"></a>Geospatial: Sorted Set with Geohash</h3><p>Redis geospatial features are built on top of sorted sets, using geohash as scores to enable spatial queries.</p>
<pre>
<code class="mermaid">
graph LR
A[Geospatial] --&gt; B[Sorted Set Backend]
B --&gt; C[Geohash as Score]
C --&gt; D[Spatial Queries]

D --&gt; D1[GEORADIUS]
D --&gt; D2[GEODIST]
D --&gt; D3[GEOPOS]
D --&gt; D4[GEOHASH]
</code>
</pre>

<h4 id="Geohash-Encoding"><a href="#Geohash-Encoding" class="headerlink" title="Geohash Encoding"></a>Geohash Encoding</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Latitude/Longitude -&gt; Geohash -&gt; 52-bit integer</span></span><br><span class="line"><span class="comment"># Example: (37.7749, -122.4194) -&gt; 9q8yy -&gt; score for sorted set</span></span><br></pre></td></tr></table></figure>

<h4 id="Use-Case-1-Location-Services"><a href="#Use-Case-1-Location-Services" class="headerlink" title="Use Case 1: Location Services"></a>Use Case 1: Location Services</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LocationService</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.redis = redis.Redis()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_location</span>(<span class="params">self, location_set, name, longitude, latitude</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Add a location to the geospatial index&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.geoadd(location_set, longitude, latitude, name)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find_nearby</span>(<span class="params">self, location_set, longitude, latitude, radius_km, unit=<span class="string">&#x27;km&#x27;</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Find locations within radius&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.georadius(</span><br><span class="line">            location_set, longitude, latitude, radius_km, unit=unit,</span><br><span class="line">            withdist=<span class="literal">True</span>, withcoord=<span class="literal">True</span>, sort=<span class="string">&#x27;ASC&#x27;</span></span><br><span class="line">        )</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find_nearby_member</span>(<span class="params">self, location_set, member_name, radius_km, unit=<span class="string">&#x27;km&#x27;</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Find locations near an existing member&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.redis.georadiusbymember(</span><br><span class="line">            location_set, member_name, radius_km, unit=unit,</span><br><span class="line">            withdist=<span class="literal">True</span>, sort=<span class="string">&#x27;ASC&#x27;</span></span><br><span class="line">        )</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_distance</span>(<span class="params">self, location_set, member1, member2, unit=<span class="string">&#x27;km&#x27;</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Get distance between two members&quot;&quot;&quot;</span></span><br><span class="line">        result = <span class="variable language_">self</span>.redis.geodist(location_set, member1, member2, unit=unit)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">float</span>(result) <span class="keyword">if</span> result <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Usage - Restaurant finder</span></span><br><span class="line">location_service = LocationService()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add restaurants</span></span><br><span class="line">restaurants = [</span><br><span class="line">    (<span class="string">&quot;Pizza Palace&quot;</span>, -<span class="number">122.4194</span>, <span class="number">37.7749</span>),    <span class="comment"># San Francisco</span></span><br><span class="line">    (<span class="string">&quot;Burger Barn&quot;</span>, -<span class="number">122.4094</span>, <span class="number">37.7849</span>),</span><br><span class="line">    (<span class="string">&quot;Sushi Spot&quot;</span>, -<span class="number">122.4294</span>, <span class="number">37.7649</span>),</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> name, lon, lat <span class="keyword">in</span> restaurants:</span><br><span class="line">    location_service.add_location(<span class="string">&quot;restaurants:sf&quot;</span>, name, lon, lat)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Find restaurants within 2km of a location</span></span><br><span class="line">nearby = location_service.find_nearby(</span><br><span class="line">    <span class="string">&quot;restaurants:sf&quot;</span>, -<span class="number">122.4194</span>, <span class="number">37.7749</span>, <span class="number">2</span>, <span class="string">&#x27;km&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Nearby restaurants: <span class="subst">&#123;nearby&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>


<h4 id="Use-Case-2-Delivery-Services"><a href="#Use-Case-2-Delivery-Services" class="headerlink" title="Use Case 2: Delivery Services"></a>Use Case 2: Delivery Services</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Add delivery drivers</span></span><br><span class="line">GEOADD drivers -122.4094 37.7849 <span class="string">&quot;driver:1001&quot;</span></span><br><span class="line">GEOADD drivers -122.4294 37.7649 <span class="string">&quot;driver:1002&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Find nearby drivers</span></span><br><span class="line">GEORADIUS drivers -122.4194 37.7749 5 km WITHCOORD ASC</span><br><span class="line"></span><br><span class="line"><span class="comment"># Update driver location</span></span><br><span class="line">GEOADD drivers -122.4150 37.7800 <span class="string">&quot;driver:1001&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="Use-Case-3-Store-Locator"><a href="#Use-Case-3-Store-Locator" class="headerlink" title="Use Case 3: Store Locator"></a>Use Case 3: Store Locator</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Add store locations</span></span><br><span class="line">GEOADD stores -122.4194 37.7749 <span class="string">&quot;store:sf_downtown&quot;</span></span><br><span class="line">GEOADD stores -122.4094 37.7849 <span class="string">&quot;store:sf_mission&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Find stores by area</span></span><br><span class="line">GEORADIUSBYMEMBER stores <span class="string">&quot;store:sf_downtown&quot;</span> 10 km WITHCOORD</span><br></pre></td></tr></table></figure>

<p><strong>🎯 Interview Insight</strong>: Redis geospatial commands are syntactic sugar over sorted set operations. Understanding this helps explain why you can mix geospatial and sorted set commands on the same key.</p>
<hr>
<h2 id="Choosing-the-Right-Data-Type"><a href="#Choosing-the-Right-Data-Type" class="headerlink" title="Choosing the Right Data Type"></a>Choosing the Right Data Type</h2><h3 id="Decision-Matrix"><a href="#Decision-Matrix" class="headerlink" title="Decision Matrix"></a>Decision Matrix</h3><pre>
<code class="mermaid">
flowchart TD
A[Data Requirements] --&gt; B{Single Value?}
B --&gt;|Yes| C{Need Expiration?}
C --&gt;|Yes| D[String with TTL]
C --&gt;|No| E{Counter&#x2F;Numeric?}
E --&gt;|Yes| F[String with INCR]
E --&gt;|No| D

B --&gt;|No| G{Key-Value Pairs?}
G --&gt;|Yes| H{Large Object?}
H --&gt;|Yes| I[Hash]
H --&gt;|No| J{Frequent Field Updates?}
J --&gt;|Yes| I
J --&gt;|No| K[String with JSON]

G --&gt;|No| L{Ordered Collection?}
L --&gt;|Yes| M{Need Scores&#x2F;Ranking?}
M --&gt;|Yes| N[Sorted Set]
M --&gt;|No| O[List]

L --&gt;|No| P{Unique Elements?}
P --&gt;|Yes| Q{Set Operations Needed?}
Q --&gt;|Yes| R[Set]
Q --&gt;|No| S{Memory Critical?}
S --&gt;|Yes| T[Bitmap&#x2F;HyperLogLog]
S --&gt;|No| R

P --&gt;|No| O
</code>
</pre>

<h3 id="Use-Case-Mapping-Table"><a href="#Use-Case-Mapping-Table" class="headerlink" title="Use Case Mapping Table"></a>Use Case Mapping Table</h3><table>
<thead>
<tr>
<th><strong>Use Case</strong></th>
<th><strong>Primary Data Type</strong></th>
<th><strong>Alternative</strong></th>
<th><strong>Why This Choice</strong></th>
</tr>
</thead>
<tbody><tr>
<td>User Sessions</td>
<td>String</td>
<td>Hash</td>
<td>TTL support, simple storage</td>
</tr>
<tr>
<td>Shopping Cart</td>
<td>Hash</td>
<td>String (JSON)</td>
<td>Atomic field updates</td>
</tr>
<tr>
<td>Message Queue</td>
<td>List</td>
<td>Stream</td>
<td>FIFO ordering, blocking ops</td>
</tr>
<tr>
<td>Leaderboard</td>
<td>Sorted Set</td>
<td>-</td>
<td>Score-based ranking</td>
</tr>
<tr>
<td>Tags&#x2F;Categories</td>
<td>Set</td>
<td>-</td>
<td>Unique elements, set operations</td>
</tr>
<tr>
<td>Real-time Analytics</td>
<td>Bitmap&#x2F;HyperLogLog</td>
<td>-</td>
<td>Memory efficiency</td>
</tr>
<tr>
<td>Activity Feed</td>
<td>List</td>
<td>Stream</td>
<td>Chronological ordering</td>
</tr>
<tr>
<td>Friendship Graph</td>
<td>Set</td>
<td>-</td>
<td>Intersection operations</td>
</tr>
<tr>
<td>Rate Limiting</td>
<td>String</td>
<td>Hash</td>
<td>Counter with expiration</td>
</tr>
<tr>
<td>Geographic Search</td>
<td>Geospatial</td>
<td>-</td>
<td>Location-based queries</td>
</tr>
</tbody></table>
<h3 id="Performance-Characteristics"><a href="#Performance-Characteristics" class="headerlink" title="Performance Characteristics"></a>Performance Characteristics</h3><table>
<thead>
<tr>
<th><strong>Operation</strong></th>
<th><strong>String</strong></th>
<th><strong>List</strong></th>
<th><strong>Set</strong></th>
<th><strong>Sorted Set</strong></th>
<th><strong>Hash</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Get&#x2F;Set Single</td>
<td>O(1)</td>
<td>O(1) ends</td>
<td>O(1)</td>
<td>O(log N)</td>
<td>O(1)</td>
</tr>
<tr>
<td>Range Query</td>
<td>N&#x2F;A</td>
<td>O(N)</td>
<td>N&#x2F;A</td>
<td>O(log N + M)</td>
<td>N&#x2F;A</td>
</tr>
<tr>
<td>Add Element</td>
<td>O(1)</td>
<td>O(1) ends</td>
<td>O(1)</td>
<td>O(log N)</td>
<td>O(1)</td>
</tr>
<tr>
<td>Remove Element</td>
<td>N&#x2F;A</td>
<td>O(N)</td>
<td>O(1)</td>
<td>O(log N)</td>
<td>O(1)</td>
</tr>
<tr>
<td>Size Check</td>
<td>O(1)</td>
<td>O(1)</td>
<td>O(1)</td>
<td>O(1)</td>
<td>O(1)</td>
</tr>
</tbody></table>
<h2 id="Best-Practices-and-Interview-Insights"><a href="#Best-Practices-and-Interview-Insights" class="headerlink" title="Best Practices and Interview Insights"></a>Best Practices and Interview Insights</h2><h3 id="Memory-Optimization-Strategies"><a href="#Memory-Optimization-Strategies" class="headerlink" title="Memory Optimization Strategies"></a>Memory Optimization Strategies</h3><ol>
<li><strong>Choose appropriate data types</strong>: Use the most memory-efficient type for your use case</li>
<li><strong>Configure thresholds</strong>: Tune ziplist&#x2F;intset thresholds based on your data patterns</li>
<li><strong>Use appropriate key naming</strong>: Consistent, predictable key patterns</li>
<li><strong>Implement key expiration</strong>: Use TTL to prevent memory leaks</li>
</ol>
<h3 id="Common-Anti-Patterns-to-Avoid"><a href="#Common-Anti-Patterns-to-Avoid" class="headerlink" title="Common Anti-Patterns to Avoid"></a>Common Anti-Patterns to Avoid</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ❌ Bad: Using inappropriate data type</span></span><br><span class="line">r.<span class="built_in">set</span>(<span class="string">&quot;user:123:friends&quot;</span>, json.dumps([<span class="string">&quot;friend1&quot;</span>, <span class="string">&quot;friend2&quot;</span>, <span class="string">&quot;friend3&quot;</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ✅ Good: Use Set for unique collections</span></span><br><span class="line">r.sadd(<span class="string">&quot;user:123:friends&quot;</span>, <span class="string">&quot;friend1&quot;</span>, <span class="string">&quot;friend2&quot;</span>, <span class="string">&quot;friend3&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ❌ Bad: Large objects as single keys</span></span><br><span class="line">r.<span class="built_in">set</span>(<span class="string">&quot;user:123&quot;</span>, json.dumps(large_user_object))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ✅ Good: Use Hash for structured data</span></span><br><span class="line">r.hset(<span class="string">&quot;user:123&quot;</span>, mapping=&#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;John Doe&quot;</span>,</span><br><span class="line">    <span class="string">&quot;email&quot;</span>: <span class="string">&quot;john@example.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;age&quot;</span>: <span class="string">&quot;30&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ❌ Bad: Sequential key access</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    r.get(<span class="string">f&quot;key:<span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ✅ Good: Use pipeline for batch operations</span></span><br><span class="line">pipe = r.pipeline()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    pipe.get(<span class="string">f&quot;key:<span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">results = pipe.execute()</span><br></pre></td></tr></table></figure>

<h3 id="Key-Design-Patterns"><a href="#Key-Design-Patterns" class="headerlink" title="Key Design Patterns"></a>Key Design Patterns</h3><h4 id="Hierarchical-Key-Naming"><a href="#Hierarchical-Key-Naming" class="headerlink" title="Hierarchical Key Naming"></a>Hierarchical Key Naming</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Good key naming conventions</span></span><br><span class="line"><span class="string">&quot;user:12345:profile&quot;</span>           <span class="comment"># User profile data</span></span><br><span class="line"><span class="string">&quot;user:12345:settings&quot;</span>          <span class="comment"># User settings</span></span><br><span class="line"><span class="string">&quot;user:12345:sessions:abc123&quot;</span>   <span class="comment"># User session data</span></span><br><span class="line"><span class="string">&quot;cache:article:567:content&quot;</span>    <span class="comment"># Cached article content</span></span><br><span class="line"><span class="string">&quot;queue:email:high_priority&quot;</span>    <span class="comment"># High priority email queue</span></span><br><span class="line"><span class="string">&quot;counter:page_views:2024:01&quot;</span>   <span class="comment"># Monthly page view counter</span></span><br></pre></td></tr></table></figure>

<h4 id="Atomic-Operations-with-Lua-Scripts"><a href="#Atomic-Operations-with-Lua-Scripts" class="headerlink" title="Atomic Operations with Lua Scripts"></a>Atomic Operations with Lua Scripts</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Atomic rate limiting with sliding window</span></span><br><span class="line">rate_limit_script = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">local key = KEYS[1]</span></span><br><span class="line"><span class="string">local window = tonumber(ARGV[1])</span></span><br><span class="line"><span class="string">local limit = tonumber(ARGV[2])</span></span><br><span class="line"><span class="string">local current_time = tonumber(ARGV[3])</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- Remove expired entries</span></span><br><span class="line"><span class="string">redis.call(&#x27;ZREMRANGEBYSCORE&#x27;, key, 0, current_time - window)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- Count current requests</span></span><br><span class="line"><span class="string">local current_requests = redis.call(&#x27;ZCARD&#x27;, key)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">if current_requests &lt; limit then</span></span><br><span class="line"><span class="string">    -- Add current request</span></span><br><span class="line"><span class="string">    redis.call(&#x27;ZADD&#x27;, key, current_time, current_time)</span></span><br><span class="line"><span class="string">    redis.call(&#x27;EXPIRE&#x27;, key, window)</span></span><br><span class="line"><span class="string">    return &#123;1, limit - current_requests - 1&#125;</span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">    return &#123;0, 0&#125;</span></span><br><span class="line"><span class="string">end</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_rate_limit</span>(<span class="params">user_id, limit=<span class="number">100</span>, window=<span class="number">3600</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Sliding window rate limiter&quot;&quot;&quot;</span></span><br><span class="line">    key = <span class="string">f&quot;rate_limit:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">    current_time = <span class="built_in">int</span>(time.time())</span><br><span class="line">    </span><br><span class="line">    result = r.<span class="built_in">eval</span>(rate_limit_script, <span class="number">1</span>, key, window, limit, current_time)</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&quot;allowed&quot;</span>: <span class="built_in">bool</span>(result[<span class="number">0</span>]),</span><br><span class="line">        <span class="string">&quot;remaining&quot;</span>: result[<span class="number">1</span>]</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="Advanced-Implementation-Details"><a href="#Advanced-Implementation-Details" class="headerlink" title="Advanced Implementation Details"></a>Advanced Implementation Details</h2><h3 id="Memory-Layout-Optimization"><a href="#Memory-Layout-Optimization" class="headerlink" title="Memory Layout Optimization"></a>Memory Layout Optimization</h3><pre>
<code class="mermaid">
graph TD
A[Redis Object] --&gt; B[Encoding Type]
A --&gt; C[Reference Count]
A --&gt; D[LRU Info]
A --&gt; E[Actual Data]

B --&gt; F[String: RAW&#x2F;INT&#x2F;EMBSTR]
B --&gt; G[List: ZIPLIST&#x2F;LINKEDLIST&#x2F;QUICKLIST]
B --&gt; H[Set: INTSET&#x2F;HASHTABLE]
B --&gt; I[ZSet: ZIPLIST&#x2F;SKIPLIST]
B --&gt; J[Hash: ZIPLIST&#x2F;HASHTABLE]
</code>
</pre>

<h3 id="Configuration-Tuning-for-Production"><a href="#Configuration-Tuning-for-Production" class="headerlink" title="Configuration Tuning for Production"></a>Configuration Tuning for Production</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Redis configuration optimizations</span></span><br><span class="line"><span class="comment"># Memory optimization</span></span><br><span class="line">hash-max-ziplist-entries 512</span><br><span class="line">hash-max-ziplist-value 64</span><br><span class="line">list-max-ziplist-size -2</span><br><span class="line">list-compress-depth 0</span><br><span class="line">set-max-intset-entries 512</span><br><span class="line">zset-max-ziplist-entries 128</span><br><span class="line">zset-max-ziplist-value 64</span><br><span class="line"></span><br><span class="line"><span class="comment"># Performance tuning</span></span><br><span class="line">tcp-backlog 511</span><br><span class="line"><span class="built_in">timeout</span> 0</span><br><span class="line">tcp-keepalive 300</span><br><span class="line">maxclients 10000</span><br><span class="line">maxmemory-policy allkeys-lru</span><br></pre></td></tr></table></figure>

<h3 id="Monitoring-and-Debugging"><a href="#Monitoring-and-Debugging" class="headerlink" title="Monitoring and Debugging"></a>Monitoring and Debugging</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">RedisMonitor</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.redis = redis.Redis()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">analyze_key_patterns</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Analyze key distribution and memory usage&quot;&quot;&quot;</span></span><br><span class="line">        info = &#123;&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Get overall memory info</span></span><br><span class="line">        memory_info = <span class="variable language_">self</span>.redis.info(<span class="string">&#x27;memory&#x27;</span>)</span><br><span class="line">        info[<span class="string">&#x27;total_memory&#x27;</span>] = memory_info[<span class="string">&#x27;used_memory_human&#x27;</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Sample keys for pattern analysis</span></span><br><span class="line">        sample_keys = <span class="variable language_">self</span>.redis.randomkey() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>)</span><br><span class="line">        patterns = &#123;&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> key <span class="keyword">in</span> sample_keys:</span><br><span class="line">            <span class="keyword">if</span> key:</span><br><span class="line">                key_type = <span class="variable language_">self</span>.redis.<span class="built_in">type</span>(key)</span><br><span class="line">                pattern = key.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">0</span>] <span class="keyword">if</span> <span class="string">&#x27;:&#x27;</span> <span class="keyword">in</span> key <span class="keyword">else</span> <span class="string">&#x27;no_pattern&#x27;</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> pattern <span class="keyword">not</span> <span class="keyword">in</span> patterns:</span><br><span class="line">                    patterns[pattern] = &#123;<span class="string">&#x27;count&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;types&#x27;</span>: &#123;&#125;&#125;</span><br><span class="line">                </span><br><span class="line">                patterns[pattern][<span class="string">&#x27;count&#x27;</span>] += <span class="number">1</span></span><br><span class="line">                patterns[pattern][<span class="string">&#x27;types&#x27;</span>][key_type] = \</span><br><span class="line">                    patterns[pattern][<span class="string">&#x27;types&#x27;</span>].get(key_type, <span class="number">0</span>) + <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        info[<span class="string">&#x27;key_patterns&#x27;</span>] = patterns</span><br><span class="line">        <span class="keyword">return</span> info</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_large_keys</span>(<span class="params">self, threshold_mb=<span class="number">1</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Find keys consuming significant memory&quot;&quot;&quot;</span></span><br><span class="line">        large_keys = []</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># This would require MEMORY USAGE command (Redis 4.0+)</span></span><br><span class="line">        <span class="comment"># Implementation would scan keys and check memory usage</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> large_keys</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check_data_type_efficiency</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Analyze if current data type is optimal&quot;&quot;&quot;</span></span><br><span class="line">        key_type = <span class="variable language_">self</span>.redis.<span class="built_in">type</span>(key)</span><br><span class="line">        key_size = <span class="variable language_">self</span>.redis.memory_usage(key) <span class="keyword">if</span> <span class="built_in">hasattr</span>(<span class="variable language_">self</span>.redis, <span class="string">&#x27;memory_usage&#x27;</span>) <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        analysis = &#123;</span><br><span class="line">            <span class="string">&#x27;type&#x27;</span>: key_type,</span><br><span class="line">            <span class="string">&#x27;memory_usage&#x27;</span>: key_size,</span><br><span class="line">            <span class="string">&#x27;recommendations&#x27;</span>: []</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> key_type == <span class="string">&#x27;string&#x27;</span>:</span><br><span class="line">            <span class="comment"># Check if it&#x27;s JSON that could be a hash</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                value = <span class="variable language_">self</span>.redis.get(key)</span><br><span class="line">                <span class="keyword">if</span> value <span class="keyword">and</span> value.startswith((<span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;[&#x27;</span>)):</span><br><span class="line">                    analysis[<span class="string">&#x27;recommendations&#x27;</span>].append(</span><br><span class="line">                        <span class="string">&quot;Consider using Hash if you need to update individual fields&quot;</span></span><br><span class="line">                    )</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> analysis</span><br></pre></td></tr></table></figure>

<h2 id="Real-World-Architecture-Patterns"><a href="#Real-World-Architecture-Patterns" class="headerlink" title="Real-World Architecture Patterns"></a>Real-World Architecture Patterns</h2><h3 id="Microservices-Data-Patterns"><a href="#Microservices-Data-Patterns" class="headerlink" title="Microservices Data Patterns"></a>Microservices Data Patterns</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UserServiceRedisLayer</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Redis layer for user microservice&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.redis = redis.Redis()</span><br><span class="line">        <span class="variable language_">self</span>.cache_ttl = <span class="number">3600</span>  <span class="comment"># 1 hour</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">cache_user_profile</span>(<span class="params">self, user_id, profile_data</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Cache user profile with optimized structure&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># Use hash for structured data</span></span><br><span class="line">        profile_key = <span class="string">f&quot;user:profile:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.redis.hset(profile_key, mapping=profile_data)</span><br><span class="line">        <span class="variable language_">self</span>.redis.expire(profile_key, <span class="variable language_">self</span>.cache_ttl)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Cache frequently accessed fields separately</span></span><br><span class="line">        <span class="variable language_">self</span>.redis.setex(<span class="string">f&quot;user:name:<span class="subst">&#123;user_id&#125;</span>&quot;</span>, <span class="variable language_">self</span>.cache_ttl, profile_data[<span class="string">&#x27;name&#x27;</span>])</span><br><span class="line">        <span class="variable language_">self</span>.redis.setex(<span class="string">f&quot;user:email:<span class="subst">&#123;user_id&#125;</span>&quot;</span>, <span class="variable language_">self</span>.cache_ttl, profile_data[<span class="string">&#x27;email&#x27;</span>])</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_user_summary</span>(<span class="params">self, user_id</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Get essential user info with fallback strategy&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># Try cache first</span></span><br><span class="line">        name = <span class="variable language_">self</span>.redis.get(<span class="string">f&quot;user:name:<span class="subst">&#123;user_id&#125;</span>&quot;</span>)</span><br><span class="line">        email = <span class="variable language_">self</span>.redis.get(<span class="string">f&quot;user:email:<span class="subst">&#123;user_id&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> name <span class="keyword">and</span> email:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&#x27;name&#x27;</span>: name.decode(), <span class="string">&#x27;email&#x27;</span>: email.decode()&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Fallback to full profile</span></span><br><span class="line">        profile = <span class="variable language_">self</span>.redis.hgetall(<span class="string">f&quot;user:profile:<span class="subst">&#123;user_id&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> profile:</span><br><span class="line">            <span class="keyword">return</span> &#123;k.decode(): v.decode() <span class="keyword">for</span> k, v <span class="keyword">in</span> profile.items()&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>  <span class="comment"># Cache miss, need to fetch from database</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NotificationService</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Redis-based notification system&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.redis = redis.Redis()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">queue_notification</span>(<span class="params">self, user_id, notification_type, data, priority=<span class="string">&#x27;normal&#x27;</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Queue notification with priority&quot;&quot;&quot;</span></span><br><span class="line">        queue_key = <span class="string">f&quot;notifications:<span class="subst">&#123;priority&#125;</span>&quot;</span></span><br><span class="line">        </span><br><span class="line">        notification = &#123;</span><br><span class="line">            <span class="string">&#x27;user_id&#x27;</span>: user_id,</span><br><span class="line">            <span class="string">&#x27;type&#x27;</span>: notification_type,</span><br><span class="line">            <span class="string">&#x27;data&#x27;</span>: json.dumps(data),</span><br><span class="line">            <span class="string">&#x27;created_at&#x27;</span>: <span class="built_in">int</span>(time.time())</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> priority == <span class="string">&#x27;high&#x27;</span>:</span><br><span class="line">            <span class="comment"># Use list for FIFO queue</span></span><br><span class="line">            <span class="variable language_">self</span>.redis.lpush(queue_key, json.dumps(notification))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># Use sorted set for delayed delivery</span></span><br><span class="line">            deliver_at = time.time() + <span class="number">300</span>  <span class="comment"># 5 minutes delay</span></span><br><span class="line">            <span class="variable language_">self</span>.redis.zadd(queue_key, &#123;json.dumps(notification): deliver_at&#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_user_notifications</span>(<span class="params">self, user_id, limit=<span class="number">10</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Get recent notifications for user&quot;&quot;&quot;</span></span><br><span class="line">        key = <span class="string">f&quot;user:notifications:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">        notifications = <span class="variable language_">self</span>.redis.lrange(key, <span class="number">0</span>, limit - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> [json.loads(n) <span class="keyword">for</span> n <span class="keyword">in</span> notifications]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mark_notifications_read</span>(<span class="params">self, user_id, notification_ids</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Mark specific notifications as read&quot;&quot;&quot;</span></span><br><span class="line">        read_key = <span class="string">f&quot;user:notifications:read:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.redis.sadd(read_key, *notification_ids)</span><br><span class="line">        <span class="variable language_">self</span>.redis.expire(read_key, <span class="number">86400</span> * <span class="number">30</span>)  <span class="comment"># Keep for 30 days</span></span><br></pre></td></tr></table></figure>

<h3 id="E-commerce-Platform-Integration"><a href="#E-commerce-Platform-Integration" class="headerlink" title="E-commerce Platform Integration"></a>E-commerce Platform Integration</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">EcommerceCacheLayer</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Comprehensive Redis integration for e-commerce&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.redis = redis.Redis()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">cache_product_catalog</span>(<span class="params">self, category_id, products</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Cache product listings with multiple access patterns&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># Main product list</span></span><br><span class="line">        catalog_key = <span class="string">f&quot;catalog:<span class="subst">&#123;category_id&#125;</span>&quot;</span></span><br><span class="line">        product_ids = [p[<span class="string">&#x27;id&#x27;</span>] <span class="keyword">for</span> p <span class="keyword">in</span> products]</span><br><span class="line">        <span class="variable language_">self</span>.redis.delete(catalog_key)</span><br><span class="line">        <span class="variable language_">self</span>.redis.lpush(catalog_key, *product_ids)</span><br><span class="line">        <span class="variable language_">self</span>.redis.expire(catalog_key, <span class="number">3600</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Cache individual products</span></span><br><span class="line">        <span class="keyword">for</span> product <span class="keyword">in</span> products:</span><br><span class="line">            product_key = <span class="string">f&quot;product:<span class="subst">&#123;product[<span class="string">&#x27;id&#x27;</span>]&#125;</span>&quot;</span></span><br><span class="line">            <span class="variable language_">self</span>.redis.hset(product_key, mapping=product)</span><br><span class="line">            <span class="variable language_">self</span>.redis.expire(product_key, <span class="number">7200</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Add to price-sorted index</span></span><br><span class="line">            price_index = <span class="string">f&quot;category:<span class="subst">&#123;category_id&#125;</span>:by_price&quot;</span></span><br><span class="line">            <span class="variable language_">self</span>.redis.zadd(price_index, &#123;product[<span class="string">&#x27;id&#x27;</span>]: <span class="built_in">float</span>(product[<span class="string">&#x27;price&#x27;</span>])&#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">implement_inventory_tracking</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Real-time inventory management&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">reserve_inventory</span>(<span class="params">product_id, quantity, user_id</span>):</span><br><span class="line">            <span class="string">&quot;&quot;&quot;Atomically reserve inventory&quot;&quot;&quot;</span></span><br><span class="line">            lua_script = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            local product_key = &#x27;inventory:&#x27; .. KEYS[1]</span></span><br><span class="line"><span class="string">            local reservation_key = &#x27;reservations:&#x27; .. KEYS[1]</span></span><br><span class="line"><span class="string">            local user_reservation = KEYS[1] .. &#x27;:&#x27; .. ARGV[2]</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            local current_stock = tonumber(redis.call(&#x27;GET&#x27;, product_key) or 0)</span></span><br><span class="line"><span class="string">            local requested = tonumber(ARGV[1])</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            if current_stock &gt;= requested then</span></span><br><span class="line"><span class="string">                redis.call(&#x27;DECRBY&#x27;, product_key, requested)</span></span><br><span class="line"><span class="string">                redis.call(&#x27;HSET&#x27;, reservation_key, user_reservation, requested)</span></span><br><span class="line"><span class="string">                redis.call(&#x27;EXPIRE&#x27;, reservation_key, 900)  -- 15 minutes</span></span><br><span class="line"><span class="string">                return &#123;1, current_stock - requested&#125;</span></span><br><span class="line"><span class="string">            else</span></span><br><span class="line"><span class="string">                return &#123;0, current_stock&#125;</span></span><br><span class="line"><span class="string">            end</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">            </span><br><span class="line">            result = <span class="variable language_">self</span>.redis.<span class="built_in">eval</span>(lua_script, <span class="number">1</span>, product_id, quantity, user_id)</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                <span class="string">&#x27;success&#x27;</span>: <span class="built_in">bool</span>(result[<span class="number">0</span>]),</span><br><span class="line">                <span class="string">&#x27;remaining_stock&#x27;</span>: result[<span class="number">1</span>]</span><br><span class="line">            &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> reserve_inventory</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">implement_recommendation_engine</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Collaborative filtering with Redis&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">track_user_interaction</span>(<span class="params">user_id, product_id, interaction_type, score=<span class="number">1.0</span></span>):</span><br><span class="line">            <span class="string">&quot;&quot;&quot;Track user-product interactions&quot;&quot;&quot;</span></span><br><span class="line">            <span class="comment"># User&#x27;s interaction history</span></span><br><span class="line">            user_key = <span class="string">f&quot;user:interactions:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">            <span class="variable language_">self</span>.redis.zadd(user_key, &#123;<span class="string">f&quot;<span class="subst">&#123;interaction_type&#125;</span>:<span class="subst">&#123;product_id&#125;</span>&quot;</span>: score&#125;)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Product&#x27;s interaction summary</span></span><br><span class="line">            product_key = <span class="string">f&quot;product:interactions:<span class="subst">&#123;product_id&#125;</span>&quot;</span></span><br><span class="line">            <span class="variable language_">self</span>.redis.zincrby(product_key, score, interaction_type)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Similar users (simplified)</span></span><br><span class="line">            similar_users_key = <span class="string">f&quot;similar:users:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">            <span class="comment"># Logic to find and cache similar users would go here</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">get_recommendations</span>(<span class="params">user_id, limit=<span class="number">10</span></span>):</span><br><span class="line">            <span class="string">&quot;&quot;&quot;Get product recommendations for user&quot;&quot;&quot;</span></span><br><span class="line">            user_interactions = <span class="variable language_">self</span>.redis.zrevrange(<span class="string">f&quot;user:interactions:<span class="subst">&#123;user_id&#125;</span>&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Simple collaborative filtering</span></span><br><span class="line">            recommendations = <span class="built_in">set</span>()</span><br><span class="line">            <span class="keyword">for</span> interaction <span class="keyword">in</span> user_interactions[:<span class="number">5</span>]:  <span class="comment"># Use top 5 interactions</span></span><br><span class="line">                interaction_type, product_id = interaction.decode().split(<span class="string">&#x27;:&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># Find users who also interacted with this product</span></span><br><span class="line">                similar_pattern = <span class="string">f&quot;*:<span class="subst">&#123;interaction_type&#125;</span>:<span class="subst">&#123;product_id&#125;</span>&quot;</span></span><br><span class="line">                <span class="comment"># This is simplified - real implementation would be more sophisticated</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">list</span>(recommendations)[:limit]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> track_user_interaction, get_recommendations</span><br><span class="line"></span><br><span class="line"><span class="comment"># Session management for web applications</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SessionManager</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Redis-based session management&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, session_timeout=<span class="number">3600</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.redis = redis.Redis()</span><br><span class="line">        <span class="variable language_">self</span>.timeout = session_timeout</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">create_session</span>(<span class="params">self, user_id, session_data</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Create new user session&quot;&quot;&quot;</span></span><br><span class="line">        session_id = <span class="built_in">str</span>(uuid.uuid4())</span><br><span class="line">        session_key = <span class="string">f&quot;session:<span class="subst">&#123;session_id&#125;</span>&quot;</span></span><br><span class="line">        </span><br><span class="line">        session_info = &#123;</span><br><span class="line">            <span class="string">&#x27;user_id&#x27;</span>: <span class="built_in">str</span>(user_id),</span><br><span class="line">            <span class="string">&#x27;created_at&#x27;</span>: <span class="built_in">str</span>(<span class="built_in">int</span>(time.time())),</span><br><span class="line">            <span class="string">&#x27;last_accessed&#x27;</span>: <span class="built_in">str</span>(<span class="built_in">int</span>(time.time())),</span><br><span class="line">            **session_data</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Store session data</span></span><br><span class="line">        <span class="variable language_">self</span>.redis.hset(session_key, mapping=session_info)</span><br><span class="line">        <span class="variable language_">self</span>.redis.expire(session_key, <span class="variable language_">self</span>.timeout)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Track active sessions for user</span></span><br><span class="line">        user_sessions_key = <span class="string">f&quot;user:sessions:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.redis.sadd(user_sessions_key, session_id)</span><br><span class="line">        <span class="variable language_">self</span>.redis.expire(user_sessions_key, <span class="variable language_">self</span>.timeout)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> session_id</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_session</span>(<span class="params">self, session_id</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Retrieve session data&quot;&quot;&quot;</span></span><br><span class="line">        session_key = <span class="string">f&quot;session:<span class="subst">&#123;session_id&#125;</span>&quot;</span></span><br><span class="line">        session_data = <span class="variable language_">self</span>.redis.hgetall(session_key)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> session_data:</span><br><span class="line">            <span class="comment"># Update last accessed time</span></span><br><span class="line">            <span class="variable language_">self</span>.redis.hset(session_key, <span class="string">&#x27;last_accessed&#x27;</span>, <span class="built_in">str</span>(<span class="built_in">int</span>(time.time())))</span><br><span class="line">            <span class="variable language_">self</span>.redis.expire(session_key, <span class="variable language_">self</span>.timeout)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> &#123;k.decode(): v.decode() <span class="keyword">for</span> k, v <span class="keyword">in</span> session_data.items()&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">invalidate_session</span>(<span class="params">self, session_id</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Invalidate specific session&quot;&quot;&quot;</span></span><br><span class="line">        session_key = <span class="string">f&quot;session:<span class="subst">&#123;session_id&#125;</span>&quot;</span></span><br><span class="line">        session_data = <span class="variable language_">self</span>.redis.hgetall(session_key)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> session_data:</span><br><span class="line">            user_id = session_data[<span class="string">b&#x27;user_id&#x27;</span>].decode()</span><br><span class="line">            user_sessions_key = <span class="string">f&quot;user:sessions:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Remove from user&#x27;s active sessions</span></span><br><span class="line">            <span class="variable language_">self</span>.redis.srem(user_sessions_key, session_id)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Delete session</span></span><br><span class="line">            <span class="variable language_">self</span>.redis.delete(session_key)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<h2 id="Production-Deployment-Considerations"><a href="#Production-Deployment-Considerations" class="headerlink" title="Production Deployment Considerations"></a>Production Deployment Considerations</h2><h3 id="High-Availability-Patterns"><a href="#High-Availability-Patterns" class="headerlink" title="High Availability Patterns"></a>High Availability Patterns</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">RedisHighAvailabilityClient</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Redis client with failover and connection pooling&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, sentinel_hosts, service_name, db=<span class="number">0</span></span>):</span><br><span class="line">        <span class="keyword">from</span> redis.sentinel <span class="keyword">import</span> Sentinel</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">self</span>.sentinel = Sentinel(sentinel_hosts, socket_timeout=<span class="number">0.1</span>)</span><br><span class="line">        <span class="variable language_">self</span>.service_name = service_name</span><br><span class="line">        <span class="variable language_">self</span>.db = db</span><br><span class="line">        <span class="variable language_">self</span>._master = <span class="literal">None</span></span><br><span class="line">        <span class="variable language_">self</span>._slaves = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_master</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Get master connection with automatic failover&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>._master:</span><br><span class="line">                <span class="variable language_">self</span>._master = <span class="variable language_">self</span>.sentinel.master_for(</span><br><span class="line">                    <span class="variable language_">self</span>.service_name, </span><br><span class="line">                    socket_timeout=<span class="number">0.1</span>,</span><br><span class="line">                    db=<span class="variable language_">self</span>.db</span><br><span class="line">                )</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>._master</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="variable language_">self</span>._master = <span class="literal">None</span></span><br><span class="line">            <span class="keyword">raise</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_slave</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Get slave connection for read operations&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>.sentinel.slave_for(</span><br><span class="line">                <span class="variable language_">self</span>.service_name,</span><br><span class="line">                socket_timeout=<span class="number">0.1</span>,</span><br><span class="line">                db=<span class="variable language_">self</span>.db</span><br><span class="line">            )</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="comment"># Fallback to master if no slaves available</span></span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>.get_master()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">execute_read</span>(<span class="params">self, operation, *args, **kwargs</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Execute read operation on slave with master fallback&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            slave = <span class="variable language_">self</span>.get_slave()</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getattr</span>(slave, operation)(*args, **kwargs)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            master = <span class="variable language_">self</span>.get_master()</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getattr</span>(master, operation)(*args, **kwargs)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">execute_write</span>(<span class="params">self, operation, *args, **kwargs</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Execute write operation on master&quot;&quot;&quot;</span></span><br><span class="line">        master = <span class="variable language_">self</span>.get_master()</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">getattr</span>(master, operation)(*args, **kwargs)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Usage example</span></span><br><span class="line">ha_redis = RedisHighAvailabilityClient([</span><br><span class="line">    (<span class="string">&#x27;sentinel1.example.com&#x27;</span>, <span class="number">26379</span>),</span><br><span class="line">    (<span class="string">&#x27;sentinel2.example.com&#x27;</span>, <span class="number">26379</span>),</span><br><span class="line">    (<span class="string">&#x27;sentinel3.example.com&#x27;</span>, <span class="number">26379</span>)</span><br><span class="line">], <span class="string">&#x27;mymaster&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read from slave, write to master</span></span><br><span class="line">user_data = ha_redis.execute_read(<span class="string">&#x27;hgetall&#x27;</span>, <span class="string">&#x27;user:123&#x27;</span>)</span><br><span class="line">ha_redis.execute_write(<span class="string">&#x27;hset&#x27;</span>, <span class="string">&#x27;user:123&#x27;</span>, <span class="string">&#x27;last_login&#x27;</span>, <span class="built_in">str</span>(<span class="built_in">int</span>(time.time())))</span><br></pre></td></tr></table></figure>

<h3 id="Performance-Monitoring"><a href="#Performance-Monitoring" class="headerlink" title="Performance Monitoring"></a>Performance Monitoring</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">RedisPerformanceMonitor</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Monitor Redis performance metrics&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, redis_client</span>):</span><br><span class="line">        <span class="variable language_">self</span>.redis = redis_client</span><br><span class="line">        <span class="variable language_">self</span>.metrics = &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">collect_metrics</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Collect comprehensive Redis metrics&quot;&quot;&quot;</span></span><br><span class="line">        info = <span class="variable language_">self</span>.redis.info()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">&#x27;memory&#x27;</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;used_memory&#x27;</span>: info[<span class="string">&#x27;used_memory&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;used_memory_human&#x27;</span>: info[<span class="string">&#x27;used_memory_human&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;used_memory_peak&#x27;</span>: info[<span class="string">&#x27;used_memory_peak&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;fragmentation_ratio&#x27;</span>: info.get(<span class="string">&#x27;mem_fragmentation_ratio&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&#x27;performance&#x27;</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;ops_per_sec&#x27;</span>: info.get(<span class="string">&#x27;instantaneous_ops_per_sec&#x27;</span>, <span class="number">0</span>),</span><br><span class="line">                <span class="string">&#x27;keyspace_hits&#x27;</span>: info.get(<span class="string">&#x27;keyspace_hits&#x27;</span>, <span class="number">0</span>),</span><br><span class="line">                <span class="string">&#x27;keyspace_misses&#x27;</span>: info.get(<span class="string">&#x27;keyspace_misses&#x27;</span>, <span class="number">0</span>),</span><br><span class="line">                <span class="string">&#x27;hit_rate&#x27;</span>: <span class="variable language_">self</span>._calculate_hit_rate(info)</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&#x27;connections&#x27;</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;connected_clients&#x27;</span>: info.get(<span class="string">&#x27;connected_clients&#x27;</span>, <span class="number">0</span>),</span><br><span class="line">                <span class="string">&#x27;rejected_connections&#x27;</span>: info.get(<span class="string">&#x27;rejected_connections&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&#x27;persistence&#x27;</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;rdb_last_save_time&#x27;</span>: info.get(<span class="string">&#x27;rdb_last_save_time&#x27;</span>, <span class="number">0</span>),</span><br><span class="line">                <span class="string">&#x27;aof_enabled&#x27;</span>: info.get(<span class="string">&#x27;aof_enabled&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_calculate_hit_rate</span>(<span class="params">self, info</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Calculate cache hit rate&quot;&quot;&quot;</span></span><br><span class="line">        hits = info.get(<span class="string">&#x27;keyspace_hits&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">        misses = info.get(<span class="string">&#x27;keyspace_misses&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">        total = hits + misses</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> (hits / total * <span class="number">100</span>) <span class="keyword">if</span> total &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">detect_performance_issues</span>(<span class="params">self, metrics</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Detect common performance issues&quot;&quot;&quot;</span></span><br><span class="line">        issues = []</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># High memory fragmentation</span></span><br><span class="line">        <span class="keyword">if</span> metrics[<span class="string">&#x27;memory&#x27;</span>][<span class="string">&#x27;fragmentation_ratio&#x27;</span>] &gt; <span class="number">1.5</span>:</span><br><span class="line">            issues.append(<span class="string">&quot;High memory fragmentation detected&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Low hit rate</span></span><br><span class="line">        <span class="keyword">if</span> metrics[<span class="string">&#x27;performance&#x27;</span>][<span class="string">&#x27;hit_rate&#x27;</span>] &lt; <span class="number">80</span>:</span><br><span class="line">            issues.append(<span class="string">&quot;Low cache hit rate - consider key expiration strategy&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># High connection count</span></span><br><span class="line">        <span class="keyword">if</span> metrics[<span class="string">&#x27;connections&#x27;</span>][<span class="string">&#x27;connected_clients&#x27;</span>] &gt; <span class="number">1000</span>:</span><br><span class="line">            issues.append(<span class="string">&quot;High connection count - consider connection pooling&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> issues</span><br></pre></td></tr></table></figure>

<h2 id="Key-Takeaways-and-Interview-Excellence"><a href="#Key-Takeaways-and-Interview-Excellence" class="headerlink" title="Key Takeaways and Interview Excellence"></a>Key Takeaways and Interview Excellence</h2><h3 id="Essential-Concepts-to-Master"><a href="#Essential-Concepts-to-Master" class="headerlink" title="Essential Concepts to Master"></a>Essential Concepts to Master</h3><ol>
<li><strong>Data Structure Selection</strong>: Understanding when and why to use each Redis data type</li>
<li><strong>Memory Optimization</strong>: How Redis optimizes memory usage through encoding strategies</li>
<li><strong>Performance Characteristics</strong>: Big O complexity of operations across data types</li>
<li><strong>Real-world Applications</strong>: Practical use cases and implementation patterns</li>
<li><strong>Production Considerations</strong>: Scaling, monitoring, and high availability</li>
</ol>
<h3 id="Critical-Interview-Questions-and-Expert-Answers"><a href="#Critical-Interview-Questions-and-Expert-Answers" class="headerlink" title="Critical Interview Questions and Expert Answers"></a>Critical Interview Questions and Expert Answers</h3><p><strong>Q: “How does Redis decide between ziplist and skiplist for sorted sets?”</strong></p>
<p><strong>Expert Answer</strong>: Redis uses configuration thresholds (<code>zset-max-ziplist-entries</code> and <code>zset-max-ziplist-value</code>) to decide. When elements ≤ 128 and values ≤ 64 bytes, it uses ziplist for memory efficiency. Beyond these thresholds, it switches to skiplist + hashtable for better performance. This dual approach optimizes for both memory usage (small sets) and operation speed (large sets).</p>
<p><strong>Q: “Explain the trade-offs between using Redis Hash vs storing JSON strings.”</strong></p>
<p><strong>Expert Answer</strong>: Hash provides atomic field operations (HSET, HINCRBY), memory efficiency for small objects, and partial updates without deserializing entire objects. JSON strings offer simplicity, better compatibility across languages, and easier complex queries. Choose Hash for frequently updated structured data, JSON for read-heavy or complex nested data.</p>
<p><strong>Q: “How would you implement a distributed rate limiter using Redis?”</strong></p>
<p><strong>Expert Answer</strong>: Use sliding window with sorted sets or fixed window with strings. Sliding window stores timestamps as scores in sorted set, removes expired entries, counts current requests. Fixed window uses string counters with expiration. Lua scripts ensure atomicity. Consider token bucket for burst handling.</p>
<p><strong>Q: “What are the memory implications of Redis data type choices?”</strong></p>
<p><strong>Expert Answer</strong>: Strings have 20+ bytes overhead, Lists use ziplist (compact) vs quicklist (flexible), Sets use intset (integers only) vs hashtable, Sorted Sets use ziplist vs skiplist, Hashes use ziplist vs hashtable. Understanding these encodings is crucial for memory optimization in production.</p>
<h3 id="Redis-Command-Cheat-Sheet-for-Data-Types"><a href="#Redis-Command-Cheat-Sheet-for-Data-Types" class="headerlink" title="Redis Command Cheat Sheet for Data Types"></a>Redis Command Cheat Sheet for Data Types</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># String Operations</span></span><br><span class="line">SET key value [EX seconds] [NX|XX]</span><br><span class="line">GET key</span><br><span class="line">INCR key / INCRBY key increment</span><br><span class="line">MSET key1 value1 key2 value2</span><br><span class="line">MGET key1 key2</span><br><span class="line"></span><br><span class="line"><span class="comment"># List Operations  </span></span><br><span class="line">LPUSH key value1 [value2 ...]</span><br><span class="line">RPOP key</span><br><span class="line">LRANGE key start stop</span><br><span class="line">BLPOP key [key ...] <span class="built_in">timeout</span></span><br><span class="line">LTRIM key start stop</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set Operations</span></span><br><span class="line">SADD key member1 [member2 ...]</span><br><span class="line">SMEMBERS key</span><br><span class="line">SINTER key1 [key2 ...]</span><br><span class="line">SUNION key1 [key2 ...]</span><br><span class="line">SDIFF key1 [key2 ...]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sorted Set Operations</span></span><br><span class="line">ZADD key score1 member1 [score2 member2 ...]</span><br><span class="line">ZRANGE key start stop [WITHSCORES]</span><br><span class="line">ZRANGEBYSCORE key min max</span><br><span class="line">ZRANK key member</span><br><span class="line">ZINCRBY key increment member</span><br><span class="line"></span><br><span class="line"><span class="comment"># Hash Operations</span></span><br><span class="line">HSET key field1 value1 [field2 value2 ...]</span><br><span class="line">HGET key field</span><br><span class="line">HGETALL key</span><br><span class="line">HINCRBY key field increment</span><br><span class="line">HDEL key field1 [field2 ...]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Advanced Data Types</span></span><br><span class="line">SETBIT key offset value</span><br><span class="line">BITCOUNT key [start end]</span><br><span class="line">PFADD key element [element ...]</span><br><span class="line">PFCOUNT key [key ...]</span><br><span class="line">GEOADD key longitude latitude member</span><br><span class="line">GEORADIUS key longitude latitude radius unit</span><br><span class="line">XADD stream-key ID field1 value1 [field2 value2 ...]</span><br><span class="line">XREAD [COUNT count] STREAMS key [key ...] ID [ID ...]</span><br></pre></td></tr></table></figure>

<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Redis’s elegance lies in its thoughtful data type design and implementation strategies. Each data type addresses specific use cases while maintaining excellent performance characteristics. The key to mastering Redis is understanding not just what each data type does, but why it’s implemented that way and when to use it.</p>
<p>For production systems, consider data access patterns, memory constraints, and scaling requirements when choosing data types. Redis’s flexibility allows for creative solutions, but with great power comes the responsibility to choose wisely.</p>
<p>The combination of simple operations, rich data types, and high performance makes Redis an indispensable tool for modern application architecture. Whether you’re building caches, message queues, real-time analytics, or complex data structures, Redis provides the foundation for scalable, efficient solutions.</p>
<h2 id="External-References"><a href="#External-References" class="headerlink" title="External References"></a>External References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://redis.io/documentation">Redis Official Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://redis.io/topics/data-types">Redis Data Types Deep Dive</a></li>
<li><a target="_blank" rel="noopener" href="https://redis.io/topics/memory-optimization">Redis Memory Optimization</a></li>
<li><a target="_blank" rel="noopener" href="https://redis.io/topics/persistence">Redis Persistence</a></li>
<li><a target="_blank" rel="noopener" href="https://redis.io/topics/sentinel">Redis Sentinel</a></li>
<li><a target="_blank" rel="noopener" href="https://redis.io/topics/cluster-tutorial">Redis Cluster</a></li>
<li><a target="_blank" rel="noopener" href="https://redis.io/topics/streams-intro">Redis Streams</a></li>
<li><a target="_blank" rel="noopener" href="https://redis.io/modules">Redis Modules</a></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/redis/" rel="tag"># redis</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/06/09/Kafka-Performance-Theory-Best-Practices/" rel="prev" title="Kafka Performance: Theory, Best Practices">
                  <i class="fa fa-angle-left"></i> Kafka Performance: Theory, Best Practices
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/06/10/Kafka-Message-Ordering-Theory-Practice-and-Interview-Insights/" rel="next" title="Kafka Message Ordering: Theory, Practice, and Interview Insights">
                  Kafka Message Ordering: Theory, Practice, and Interview Insights <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Charlie Feng</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
