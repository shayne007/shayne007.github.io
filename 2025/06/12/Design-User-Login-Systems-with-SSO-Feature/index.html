<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"shayne007.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.23.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="System OverviewA modern login system must balance security, usability, and scalability. Our design focuses on providing secure authentication while maintaining excellent user experience through featur">
<meta property="og:type" content="article">
<meta property="og:title" content="Design User Login Systems with SSO Feature">
<meta property="og:url" content="https://shayne007.github.io/2025/06/12/Design-User-Login-Systems-with-SSO-Feature/index.html">
<meta property="og:site_name" content="Charlie Feng&#39;s Tech Space">
<meta property="og:description" content="System OverviewA modern login system must balance security, usability, and scalability. Our design focuses on providing secure authentication while maintaining excellent user experience through featur">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-06-12T15:47:50.000Z">
<meta property="article:modified_time" content="2025-06-13T06:17:27.467Z">
<meta property="article:author" content="Charlie Feng">
<meta property="article:tag" content="system-design">
<meta property="article:tag" content="user login system">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://shayne007.github.io/2025/06/12/Design-User-Login-Systems-with-SSO-Feature/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://shayne007.github.io/2025/06/12/Design-User-Login-Systems-with-SSO-Feature/","path":"2025/06/12/Design-User-Login-Systems-with-SSO-Feature/","title":"Design User Login Systems with SSO Feature"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Design User Login Systems with SSO Feature | Charlie Feng's Tech Space</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"cdn":false,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.5.0/mermaid.min.js","integrity":"sha256-2obLuIPcceEhkE3G09G33hBdmE55ivVcZUlcKcGNHjU="}}</script>
  <script src="/js/third-party/tags/mermaid.js" defer></script>





  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Charlie Feng's Tech Space</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">You will survive with skills</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#System-Overview"><span class="nav-number">1.</span> <span class="nav-text">System Overview</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Core-Requirements"><span class="nav-number">1.1.</span> <span class="nav-text">Core Requirements</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Authentication-Architecture"><span class="nav-number">2.</span> <span class="nav-text">Authentication Architecture</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Core-Components"><span class="nav-number">2.1.</span> <span class="nav-text">Core Components</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-Authentication-Service"><span class="nav-number">2.1.1.</span> <span class="nav-text">1. Authentication Service</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-Token-Strategy"><span class="nav-number">2.1.2.</span> <span class="nav-text">2. Token Strategy</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Implementation-Example"><span class="nav-number">2.2.</span> <span class="nav-text">Implementation Example</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Single-Sign-On-SSO-Implementation"><span class="nav-number">3.</span> <span class="nav-text">Single Sign-On (SSO) Implementation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#OAuth-2-0-Flow-Implementation"><span class="nav-number">3.1.</span> <span class="nav-text">OAuth 2.0 Flow Implementation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SAML-2-0-Integration"><span class="nav-number">3.2.</span> <span class="nav-text">SAML 2.0 Integration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SSO-Configuration-Management"><span class="nav-number">3.3.</span> <span class="nav-text">SSO Configuration Management</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Session-Management-Timeout"><span class="nav-number">4.</span> <span class="nav-text">Session Management &amp; Timeout</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Intelligent-Session-Management"><span class="nav-number">4.1.</span> <span class="nav-text">Intelligent Session Management</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Session-Lifecycle"><span class="nav-number">4.1.1.</span> <span class="nav-text">Session Lifecycle</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Implementation-Details"><span class="nav-number">4.1.2.</span> <span class="nav-text">Implementation Details</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity-Tracking"><span class="nav-number">4.2.</span> <span class="nav-text">Activity Tracking</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Multi-Factor-Authentication-MFA"><span class="nav-number">5.</span> <span class="nav-text">Multi-Factor Authentication (MFA)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MFA-Flow-Design"><span class="nav-number">5.1.</span> <span class="nav-text">MFA Flow Design</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-Generation-Validation"><span class="nav-number">5.2.</span> <span class="nav-text">Code Generation &amp; Validation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Notification-Services"><span class="nav-number">5.3.</span> <span class="nav-text">Notification Services</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Security-Features-Best-Practices"><span class="nav-number">6.</span> <span class="nav-text">Security Features &amp; Best Practices</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Password-Security"><span class="nav-number">6.1.</span> <span class="nav-text">Password Security</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Password-Policy-Implementation"><span class="nav-number">6.1.1.</span> <span class="nav-text">Password Policy Implementation</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Rate-Limiting-Brute-Force-Protection"><span class="nav-number">6.2.</span> <span class="nav-text">Rate Limiting &amp; Brute Force Protection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Security-Headers-CSRF-Protection"><span class="nav-number">6.3.</span> <span class="nav-text">Security Headers &amp; CSRF Protection</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Database-Design"><span class="nav-number">7.</span> <span class="nav-text">Database Design</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#User-Management-Schema"><span class="nav-number">7.1.</span> <span class="nav-text">User Management Schema</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#API-Design"><span class="nav-number">8.</span> <span class="nav-text">API Design</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Authentication-Endpoints"><span class="nav-number">8.1.</span> <span class="nav-text">Authentication Endpoints</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Request-Response-Models"><span class="nav-number">8.2.</span> <span class="nav-text">Request&#x2F;Response Models</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Error-Handling"><span class="nav-number">8.3.</span> <span class="nav-text">Error Handling</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Frontend-Implementation"><span class="nav-number">9.</span> <span class="nav-text">Frontend Implementation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#React-Authentication-Hook"><span class="nav-number">9.1.</span> <span class="nav-text">React Authentication Hook</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Session-Timeout-Handler"><span class="nav-number">9.2.</span> <span class="nav-text">Session Timeout Handler</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Monitoring-Analytics"><span class="nav-number">10.</span> <span class="nav-text">Monitoring &amp; Analytics</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Key-Metrics-to-Track"><span class="nav-number">10.1.</span> <span class="nav-text">Key Metrics to Track</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Logging-Alerting"><span class="nav-number">10.2.</span> <span class="nav-text">Logging &amp; Alerting</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Security-Monitoring-Dashboard"><span class="nav-number">10.3.</span> <span class="nav-text">Security Monitoring Dashboard</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Conclusion"><span class="nav-number">11.</span> <span class="nav-text">Conclusion</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Key-Takeaways"><span class="nav-number">11.1.</span> <span class="nav-text">Key Takeaways</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Next-Steps-for-Implementation"><span class="nav-number">11.2.</span> <span class="nav-text">Next Steps for Implementation</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Charlie Feng</p>
  <div class="site-description" itemprop="description">This place is for thinking and sharing.</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">45</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://shayne007.github.io/2025/06/12/Design-User-Login-Systems-with-SSO-Feature/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Charlie Feng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Charlie Feng's Tech Space">
      <meta itemprop="description" content="This place is for thinking and sharing.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Design User Login Systems with SSO Feature | Charlie Feng's Tech Space">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Design User Login Systems with SSO Feature
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-06-12 23:47:50" itemprop="dateCreated datePublished" datetime="2025-06-12T23:47:50+08:00">2025-06-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-06-13 14:17:27" itemprop="dateModified" datetime="2025-06-13T14:17:27+08:00">2025-06-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/system-design/" itemprop="url" rel="index"><span itemprop="name">system-design</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="System-Overview"><a href="#System-Overview" class="headerlink" title="System Overview"></a>System Overview</h2><p>A modern login system must balance security, usability, and scalability. Our design focuses on providing secure authentication while maintaining excellent user experience through features like SSO, intelligent session management, and flexible verification methods.</p>
<h3 id="Core-Requirements"><a href="#Core-Requirements" class="headerlink" title="Core Requirements"></a>Core Requirements</h3><ul>
<li><strong>Authentication Methods</strong>: Username&#x2F;password, SSO (OAuth 2.0, SAML)</li>
<li><strong>Session Management</strong>: 30-minute idle timeout with activity tracking</li>
<li><strong>Multi-Factor Authentication</strong>: Email and SMS verification codes</li>
<li><strong>Security Features</strong>: Rate limiting, breach detection, secure password policies</li>
<li><strong>Scalability</strong>: Horizontal scaling support with stateless design</li>
</ul>
<p><strong>💡 Interview Insight</strong>: When asked about system requirements, always clarify both functional and non-functional requirements. Discuss trade-offs between security and usability, and how you’d measure success metrics like authentication success rate and user satisfaction.</p>
<pre>
<code class="mermaid">
graph TB
A[User] --&gt; B[Load Balancer]
B --&gt; C[API Gateway]
C --&gt; D[Authentication Service]
C --&gt; E[Session Service]
C --&gt; F[MFA Service]

D --&gt; G[User Database]
D --&gt; H[Identity Provider]
E --&gt; I[Session Store]
F --&gt; J[Notification Service]

K[Monitoring] --&gt; D
K --&gt; E
K --&gt; F
</code>
</pre>

<h2 id="Authentication-Architecture"><a href="#Authentication-Architecture" class="headerlink" title="Authentication Architecture"></a>Authentication Architecture</h2><h3 id="Core-Components"><a href="#Core-Components" class="headerlink" title="Core Components"></a>Core Components</h3><h4 id="1-Authentication-Service"><a href="#1-Authentication-Service" class="headerlink" title="1. Authentication Service"></a>1. Authentication Service</h4><p>The central authentication service handles credential validation, token generation, and user identity management.</p>
<pre>
<code class="mermaid">
sequenceDiagram
participant U as User
participant F as Frontend
participant A as Auth Service
participant D as Database
participant S as Session Store

U-&gt;&gt;F: Login Request
F-&gt;&gt;A: POST &#x2F;auth&#x2F;login
A-&gt;&gt;D: Validate Credentials
D--&gt;&gt;A: User Data
A-&gt;&gt;S: Create Session
S--&gt;&gt;A: Session ID
A--&gt;&gt;F: JWT + Session Cookie
F--&gt;&gt;U: Login Success
</code>
</pre>

<h4 id="2-Token-Strategy"><a href="#2-Token-Strategy" class="headerlink" title="2. Token Strategy"></a>2. Token Strategy</h4><p>We implement a dual-token approach for enhanced security:</p>
<ul>
<li><strong>Access Token (JWT)</strong>: Short-lived (15 minutes), contains user claims</li>
<li><strong>Refresh Token</strong>: Long-lived (7 days), stored securely, enables token renewal</li>
<li><strong>Session Cookie</strong>: HTTP-only, secure, contains session identifier</li>
</ul>
<p><strong>💡 Interview Insight</strong>: Explain the difference between stateful and stateless authentication. Discuss when to use JWTs vs sessions, and how to handle token revocation in a distributed system. Mention the security implications of storing tokens in localStorage vs HTTP-only cookies.</p>
<h3 id="Implementation-Example"><a href="#Implementation-Example" class="headerlink" title="Implementation Example"></a>Implementation Example</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">AuthTokens</span> &#123;</span><br><span class="line">  <span class="attr">accessToken</span>: <span class="built_in">string</span>;      <span class="comment">// JWT with 15min expiry</span></span><br><span class="line">  <span class="attr">refreshToken</span>: <span class="built_in">string</span>;     <span class="comment">// UUID with 7day expiry</span></span><br><span class="line">  <span class="attr">sessionId</span>: <span class="built_in">string</span>;        <span class="comment">// Session identifier</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">UserSession</span> &#123;</span><br><span class="line">  <span class="attr">sessionId</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">userId</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">deviceInfo</span>: <span class="title class_">DeviceInfo</span>;</span><br><span class="line">  <span class="attr">createdAt</span>: <span class="title class_">Date</span>;</span><br><span class="line">  <span class="attr">lastActivity</span>: <span class="title class_">Date</span>;</span><br><span class="line">  <span class="attr">expiresAt</span>: <span class="title class_">Date</span>;</span><br><span class="line">  <span class="attr">isActive</span>: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Single-Sign-On-SSO-Implementation"><a href="#Single-Sign-On-SSO-Implementation" class="headerlink" title="Single Sign-On (SSO) Implementation"></a>Single Sign-On (SSO) Implementation</h2><h3 id="OAuth-2-0-Flow-Implementation"><a href="#OAuth-2-0-Flow-Implementation" class="headerlink" title="OAuth 2.0 Flow Implementation"></a>OAuth 2.0 Flow Implementation</h3><p>Our SSO implementation supports multiple identity providers (Google, Microsoft, GitHub) using the Authorization Code flow with PKCE for enhanced security.</p>
<pre>
<code class="mermaid">
sequenceDiagram
participant U as User
participant A as Our App
participant I as Identity Provider
participant T as Token Endpoint

U-&gt;&gt;A: Click SSO Login
A-&gt;&gt;A: Generate PKCE Challenge
A-&gt;&gt;I: Redirect to Authorization
I-&gt;&gt;U: Login Prompt
U-&gt;&gt;I: Provide Credentials
I-&gt;&gt;A: Authorization Code
A-&gt;&gt;T: Exchange Code + PKCE Verifier
T--&gt;&gt;A: Access Token + ID Token
A-&gt;&gt;A: Validate &amp; Create Session
A--&gt;&gt;U: Login Success
</code>
</pre>

<h3 id="SAML-2-0-Integration"><a href="#SAML-2-0-Integration" class="headerlink" title="SAML 2.0 Integration"></a>SAML 2.0 Integration</h3><p>For enterprise customers, we support SAML 2.0 with the following flow:</p>
<pre>
<code class="mermaid">
graph LR
A[User] --&gt; B[Service Provider]
B --&gt; C[Identity Provider]
C --&gt; D[SAML Response]
D --&gt; B
B --&gt; E[Create Session]
</code>
</pre>

<p><strong>💡 Interview Insight</strong>: Be prepared to explain the differences between OAuth 2.0, OpenID Connect, and SAML. Discuss when to use each protocol and how to handle attribute mapping from different identity providers. Explain the security considerations of SAML assertion handling.</p>
<h3 id="SSO-Configuration-Management"><a href="#SSO-Configuration-Management" class="headerlink" title="SSO Configuration Management"></a>SSO Configuration Management</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">SSOProvider</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;oauth2&#x27;</span> | <span class="string">&#x27;saml&#x27;</span>;</span><br><span class="line">  <span class="attr">clientId</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">clientSecret</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">discoveryUrl</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">attributeMappings</span>: <span class="title class_">AttributeMapping</span>;</span><br><span class="line">  <span class="attr">isEnabled</span>: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">AttributeMapping</span> &#123;</span><br><span class="line">  <span class="attr">email</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">firstName</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">lastName</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">groups</span>?: <span class="built_in">string</span>[];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Session-Management-Timeout"><a href="#Session-Management-Timeout" class="headerlink" title="Session Management &amp; Timeout"></a>Session Management &amp; Timeout</h2><h3 id="Intelligent-Session-Management"><a href="#Intelligent-Session-Management" class="headerlink" title="Intelligent Session Management"></a>Intelligent Session Management</h3><p>Our session management system implements sophisticated timeout logic that balances security with user experience:</p>
<h4 id="Session-Lifecycle"><a href="#Session-Lifecycle" class="headerlink" title="Session Lifecycle"></a>Session Lifecycle</h4><pre>
<code class="mermaid">
stateDiagram-v2
[*] --&gt; Active: Login Success
Active --&gt; Idle: No Activity (15 min)
Idle --&gt; Active: User Activity
Idle --&gt; Warning: Idle (25 min)
Warning --&gt; Active: User Confirms
Warning --&gt; Expired: No Response (5 min)
Active --&gt; Expired: Manual Logout
Expired --&gt; [*]
</code>
</pre>

<h4 id="Implementation-Details"><a href="#Implementation-Details" class="headerlink" title="Implementation Details"></a>Implementation Details</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SessionManager</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="variable constant_">IDLE_WARNING_TIME</span> = <span class="number">25</span> * <span class="number">60</span> * <span class="number">1000</span>; <span class="comment">// 25 minutes</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="variable constant_">SESSION_TIMEOUT</span> = <span class="number">30</span> * <span class="number">60</span> * <span class="number">1000</span>;   <span class="comment">// 30 minutes</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="variable constant_">ACTIVITY_THRESHOLD</span> = <span class="number">60</span> * <span class="number">1000</span>;     <span class="comment">// 1 minute</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">trackActivity</span>(<span class="attr">sessionId</span>: <span class="built_in">string</span>, <span class="attr">activityType</span>: <span class="title class_">ActivityType</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> session = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">getSession</span>(sessionId);</span><br><span class="line">    <span class="keyword">if</span> (!session) <span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="keyword">const</span> timeSinceLastActivity = now.<span class="title function_">getTime</span>() - session.<span class="property">lastActivity</span>.<span class="title function_">getTime</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Only update if significant time has passed to reduce database writes</span></span><br><span class="line">    <span class="keyword">if</span> (timeSinceLastActivity &gt; <span class="variable language_">this</span>.<span class="property">ACTIVITY_THRESHOLD</span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">updateSessionActivity</span>(sessionId, now);</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">logActivity</span>(sessionId, activityType);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">checkSessionValidity</span>(<span class="attr">sessionId</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;<span class="title class_">SessionStatus</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> session = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">getSession</span>(sessionId);</span><br><span class="line">    <span class="keyword">if</span> (!session) <span class="keyword">return</span> <span class="title class_">SessionStatus</span>.<span class="property">INVALID</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="keyword">const</span> timeSinceActivity = now.<span class="title function_">getTime</span>() - session.<span class="property">lastActivity</span>.<span class="title function_">getTime</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (timeSinceActivity &gt; <span class="variable language_">this</span>.<span class="property">SESSION_TIMEOUT</span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">expireSession</span>(sessionId);</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">SessionStatus</span>.<span class="property">EXPIRED</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (timeSinceActivity &gt; <span class="variable language_">this</span>.<span class="property">IDLE_WARNING_TIME</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">SessionStatus</span>.<span class="property">IDLE_WARNING</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">SessionStatus</span>.<span class="property">ACTIVE</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>💡 Interview Insight</strong>: Discuss the challenges of session management in a distributed system. Explain how you’d handle session synchronization across multiple servers, and the trade-offs between database-backed sessions vs in-memory storage. Address how to handle session cleanup and prevent session fixation attacks.</p>
<h3 id="Activity-Tracking"><a href="#Activity-Tracking" class="headerlink" title="Activity Tracking"></a>Activity Tracking</h3><p>We track various user activities to maintain accurate session state:</p>
<ul>
<li><strong>High-impact activities</strong>: API calls, form submissions, navigation</li>
<li><strong>Medium-impact activities</strong>: Mouse movements, keyboard input</li>
<li><strong>Low-impact activities</strong>: Scroll events, hover states</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">ActivityType</span> &#123;</span><br><span class="line">  <span class="variable constant_">API_CALL</span> = <span class="string">&#x27;api_call&#x27;</span>,</span><br><span class="line">  <span class="variable constant_">FORM_SUBMISSION</span> = <span class="string">&#x27;form_submission&#x27;</span>,</span><br><span class="line">  <span class="variable constant_">NAVIGATION</span> = <span class="string">&#x27;navigation&#x27;</span>,</span><br><span class="line">  <span class="variable constant_">USER_INPUT</span> = <span class="string">&#x27;user_input&#x27;</span>,</span><br><span class="line">  <span class="variable constant_">HEARTBEAT</span> = <span class="string">&#x27;heartbeat&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Multi-Factor-Authentication-MFA"><a href="#Multi-Factor-Authentication-MFA" class="headerlink" title="Multi-Factor Authentication (MFA)"></a>Multi-Factor Authentication (MFA)</h2><h3 id="MFA-Flow-Design"><a href="#MFA-Flow-Design" class="headerlink" title="MFA Flow Design"></a>MFA Flow Design</h3><p>Our MFA system supports multiple verification methods with graceful fallbacks:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">flowchart TD</span><br><span class="line">    A[Primary Auth Success] --&gt; B&#123;MFA Required?&#125;</span><br><span class="line">    B --&gt;|No| C[Login Complete]</span><br><span class="line">    B --&gt;|Yes| D[Select MFA Method]</span><br><span class="line">    D --&gt; E[Email Code]</span><br><span class="line">    D --&gt; F[SMS Code]</span><br><span class="line">    E --&gt; G[Send Email Code]</span><br><span class="line">    F --&gt; H[Send SMS Code]</span><br><span class="line">    G --&gt; I[Enter Code]</span><br><span class="line">    H --&gt; I</span><br><span class="line">    I --&gt; J&#123;Code Valid?&#125;</span><br><span class="line">    J --&gt;|Yes| K[MFA Success]</span><br><span class="line">    J --&gt;|No| L&#123;Attempts &lt; 3?&#125;</span><br><span class="line">    L --&gt;|Yes| I</span><br><span class="line">    L --&gt;|No| M[Account Locked]</span><br><span class="line">    K --&gt; C</span><br></pre></td></tr></table></figure>

<h3 id="Code-Generation-Validation"><a href="#Code-Generation-Validation" class="headerlink" title="Code Generation &amp; Validation"></a>Code Generation &amp; Validation</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MFAService</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="variable constant_">CODE_LENGTH</span> = <span class="number">6</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="variable constant_">CODE_EXPIRY</span> = <span class="number">10</span> * <span class="number">60</span> * <span class="number">1000</span>; <span class="comment">// 10 minutes</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="variable constant_">MAX_ATTEMPTS</span> = <span class="number">3</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">generateCode</span>(<span class="attr">userId</span>: <span class="built_in">string</span>, <span class="attr">method</span>: <span class="title class_">MFAMethod</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">string</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> code = <span class="variable language_">this</span>.<span class="title function_">generateSecureCode</span>();</span><br><span class="line">    <span class="keyword">const</span> expiresAt = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>() + <span class="variable language_">this</span>.<span class="property">CODE_EXPIRY</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">storeMFACode</span>(&#123;</span><br><span class="line">      userId,</span><br><span class="line">      <span class="attr">code</span>: <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">hashCode</span>(code),</span><br><span class="line">      method,</span><br><span class="line">      expiresAt,</span><br><span class="line">      <span class="attr">attempts</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">isUsed</span>: <span class="literal">false</span></span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> code;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">validateCode</span>(<span class="attr">userId</span>: <span class="built_in">string</span>, <span class="attr">inputCode</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;<span class="title class_">MFAValidationResult</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> mfaRecord = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">getActiveMFACode</span>(userId);</span><br><span class="line">    <span class="keyword">if</span> (!mfaRecord) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">false</span>, <span class="attr">error</span>: <span class="string">&#x27;No active MFA code found&#x27;</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (mfaRecord.<span class="property">attempts</span> &gt;= <span class="variable language_">this</span>.<span class="property">MAX_ATTEMPTS</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">false</span>, <span class="attr">error</span>: <span class="string">&#x27;Maximum attempts exceeded&#x27;</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">Date</span>() &gt; mfaRecord.<span class="property">expiresAt</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">false</span>, <span class="attr">error</span>: <span class="string">&#x27;Code expired&#x27;</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> isValid = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">verifyCode</span>(inputCode, mfaRecord.<span class="property">code</span>);</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">incrementAttempts</span>(mfaRecord.<span class="property">id</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (isValid) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">markCodeAsUsed</span>(mfaRecord.<span class="property">id</span>);</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">false</span>, <span class="attr">error</span>: <span class="string">&#x27;Invalid code&#x27;</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>💡 Interview Insight</strong>: When discussing MFA, explain the security vs usability trade-offs. Discuss different MFA methods (TOTP, SMS, email, hardware tokens) and their relative security strengths. Address how to handle MFA backup codes and account recovery scenarios.</p>
<h3 id="Notification-Services"><a href="#Notification-Services" class="headerlink" title="Notification Services"></a>Notification Services</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">NotificationService</span> &#123;</span><br><span class="line">  <span class="title function_">sendEmailCode</span>(<span class="attr">email</span>: <span class="built_in">string</span>, <span class="attr">code</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt;;</span><br><span class="line">  <span class="title function_">sendSMSCode</span>(<span class="attr">phoneNumber</span>: <span class="built_in">string</span>, <span class="attr">code</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EmailNotificationService</span> <span class="keyword">implements</span> <span class="title class_">NotificationService</span> &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">sendEmailCode</span>(<span class="attr">email</span>: <span class="built_in">string</span>, <span class="attr">code</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> template = &#123;</span><br><span class="line">      <span class="attr">subject</span>: <span class="string">&#x27;Your verification code&#x27;</span>,</span><br><span class="line">      <span class="attr">body</span>: <span class="string">`Your verification code is: <span class="subst">$&#123;code&#125;</span>. This code expires in 10 minutes.`</span>,</span><br><span class="line">      <span class="attr">html</span>: <span class="variable language_">this</span>.<span class="title function_">generateEmailTemplate</span>(code)</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">emailProvider</span>.<span class="title function_">send</span>(email, template);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Security-Features-Best-Practices"><a href="#Security-Features-Best-Practices" class="headerlink" title="Security Features &amp; Best Practices"></a>Security Features &amp; Best Practices</h2><h3 id="Password-Security"><a href="#Password-Security" class="headerlink" title="Password Security"></a>Password Security</h3><h4 id="Password-Policy-Implementation"><a href="#Password-Policy-Implementation" class="headerlink" title="Password Policy Implementation"></a>Password Policy Implementation</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PasswordPolicy</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="variable constant_">MIN_LENGTH</span> = <span class="number">12</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="variable constant_">REQUIRE_UPPERCASE</span> = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="variable constant_">REQUIRE_LOWERCASE</span> = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="variable constant_">REQUIRE_NUMBERS</span> = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="variable constant_">REQUIRE_SYMBOLS</span> = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="variable constant_">COMMON_PASSWORDS</span> = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="comment">/* ... */</span>]);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">validate</span>(<span class="attr">password</span>: <span class="built_in">string</span>): <span class="title class_">ValidationResult</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">errors</span>: <span class="built_in">string</span>[] = [];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (password.<span class="property">length</span> &lt; <span class="variable language_">this</span>.<span class="property">MIN_LENGTH</span>) &#123;</span><br><span class="line">      errors.<span class="title function_">push</span>(<span class="string">`Password must be at least <span class="subst">$&#123;<span class="variable language_">this</span>.MIN_LENGTH&#125;</span> characters`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">REQUIRE_UPPERCASE</span> &amp;&amp; !<span class="regexp">/[A-Z]/</span>.<span class="title function_">test</span>(password)) &#123;</span><br><span class="line">      errors.<span class="title function_">push</span>(<span class="string">&#x27;Password must contain uppercase letters&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">COMMON_PASSWORDS</span>.<span class="title function_">has</span>(password.<span class="title function_">toLowerCase</span>())) &#123;</span><br><span class="line">      errors.<span class="title function_">push</span>(<span class="string">&#x27;Password is too common&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">isValid</span>: errors.<span class="property">length</span> === <span class="number">0</span>,</span><br><span class="line">      errors</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Rate-Limiting-Brute-Force-Protection"><a href="#Rate-Limiting-Brute-Force-Protection" class="headerlink" title="Rate Limiting &amp; Brute Force Protection"></a>Rate Limiting &amp; Brute Force Protection</h3><pre>
<code class="mermaid">
graph TD
A[Login Attempt] --&gt; B[Check Rate Limit]
B --&gt; C{Within Limit?}
C --&gt;|Yes| D[Process Login]
C --&gt;|No| E[Apply Penalty]
D --&gt; F{Login Success?}
F --&gt;|Yes| G[Reset Counter]
F --&gt;|No| H[Increment Counter]
E --&gt; I[Return Error]
H --&gt; J{Max Attempts?}
J --&gt;|Yes| K[Lock Account]
J --&gt;|No| L[Continue]
</code>
</pre>

<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">RateLimiter</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> windows = <span class="keyword">new</span> <span class="title class_">Map</span>&lt;<span class="built_in">string</span>, <span class="title class_">RateLimitWindow</span>&gt;();</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">checkLimit</span>(<span class="attr">identifier</span>: <span class="built_in">string</span>, <span class="attr">action</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;<span class="title class_">RateLimitResult</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> key = <span class="string">`<span class="subst">$&#123;identifier&#125;</span>:<span class="subst">$&#123;action&#125;</span>`</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable language_">window</span> = <span class="variable language_">this</span>.<span class="title function_">getOrCreateWindow</span>(key);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> now = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">    <span class="keyword">const</span> windowStart = now - (now % <span class="variable language_">window</span>.<span class="property">windowSize</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Clean old attempts</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">attempts</span> = <span class="variable language_">window</span>.<span class="property">attempts</span>.<span class="title function_">filter</span>(</span><br><span class="line">      <span class="function"><span class="params">attempt</span> =&gt;</span> attempt &gt; windowStart</span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">attempts</span>.<span class="property">length</span> &gt;= <span class="variable language_">window</span>.<span class="property">maxAttempts</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> resetTime = windowStart + <span class="variable language_">window</span>.<span class="property">windowSize</span>;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">allowed</span>: <span class="literal">false</span>,</span><br><span class="line">        resetTime,</span><br><span class="line">        <span class="attr">remainingAttempts</span>: <span class="number">0</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">attempts</span>.<span class="title function_">push</span>(now);</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">allowed</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">remainingAttempts</span>: <span class="variable language_">window</span>.<span class="property">maxAttempts</span> - <span class="variable language_">window</span>.<span class="property">attempts</span>.<span class="property">length</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>💡 Interview Insight</strong>: Discuss different rate limiting strategies (fixed window, sliding window, token bucket). Explain how to implement distributed rate limiting and handle edge cases like clock skew. Address the balance between preventing attacks and not impacting legitimate users.</p>
<h3 id="Security-Headers-CSRF-Protection"><a href="#Security-Headers-CSRF-Protection" class="headerlink" title="Security Headers &amp; CSRF Protection"></a>Security Headers &amp; CSRF Protection</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SecurityMiddleware</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">applySecurityHeaders</span>(<span class="params"><span class="attr">req</span>: <span class="title class_">Request</span>, <span class="attr">res</span>: <span class="title class_">Response</span>, <span class="attr">next</span>: <span class="title class_">NextFunction</span></span>) &#123;</span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&#x27;X-Content-Type-Options&#x27;</span>, <span class="string">&#x27;nosniff&#x27;</span>);</span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&#x27;X-Frame-Options&#x27;</span>, <span class="string">&#x27;DENY&#x27;</span>);</span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&#x27;X-XSS-Protection&#x27;</span>, <span class="string">&#x27;1; mode=block&#x27;</span>);</span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Strict-Transport-Security&#x27;</span>, <span class="string">&#x27;max-age=31536000; includeSubDomains&#x27;</span>);</span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Content-Security-Policy&#x27;</span>, </span><br><span class="line">      <span class="string">&quot;default-src &#x27;self&#x27;; script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27;&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">next</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">validateCSRFToken</span>(<span class="params"><span class="attr">req</span>: <span class="title class_">Request</span>, <span class="attr">res</span>: <span class="title class_">Response</span>, <span class="attr">next</span>: <span class="title class_">NextFunction</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> ([<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;PUT&#x27;</span>, <span class="string">&#x27;DELETE&#x27;</span>].<span class="title function_">includes</span>(req.<span class="property">method</span>)) &#123;</span><br><span class="line">      <span class="keyword">const</span> token = req.<span class="property">headers</span>[<span class="string">&#x27;x-csrf-token&#x27;</span>] || req.<span class="property">body</span>.<span class="property">_csrf</span>;</span><br><span class="line">      <span class="keyword">if</span> (!token || !<span class="variable language_">this</span>.<span class="title function_">verifyCSRFToken</span>(token, req.<span class="property">session</span>.<span class="property">csrfSecret</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Invalid CSRF token&#x27;</span> &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">next</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Database-Design"><a href="#Database-Design" class="headerlink" title="Database Design"></a>Database Design</h2><h3 id="User-Management-Schema"><a href="#User-Management-Schema" class="headerlink" title="User Management Schema"></a>User Management Schema</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Users table</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> users (</span><br><span class="line">    id UUID <span class="keyword">PRIMARY KEY</span> <span class="keyword">DEFAULT</span> gen_random_uuid(),</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">UNIQUE</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    password_hash <span class="type">VARCHAR</span>(<span class="number">255</span>),</span><br><span class="line">    first_name <span class="type">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">    last_name <span class="type">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">    phone_number <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">    is_active <span class="type">BOOLEAN</span> <span class="keyword">DEFAULT</span> <span class="literal">true</span>,</span><br><span class="line">    is_verified <span class="type">BOOLEAN</span> <span class="keyword">DEFAULT</span> <span class="literal">false</span>,</span><br><span class="line">    password_reset_token <span class="type">VARCHAR</span>(<span class="number">255</span>),</span><br><span class="line">    password_reset_expires TIMESTAMPTZ,</span><br><span class="line">    last_login TIMESTAMPTZ,</span><br><span class="line">    failed_login_attempts <span class="type">INTEGER</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">    account_locked_until TIMESTAMPTZ,</span><br><span class="line">    created_at TIMESTAMPTZ <span class="keyword">DEFAULT</span> NOW(),</span><br><span class="line">    updated_at TIMESTAMPTZ <span class="keyword">DEFAULT</span> NOW()</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- User sessions table</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> user_sessions (</span><br><span class="line">    session_id <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    user_id UUID <span class="keyword">NOT NULL</span> <span class="keyword">REFERENCES</span> users(id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">    device_info JSONB,</span><br><span class="line">    ip_address INET,</span><br><span class="line">    user_agent TEXT,</span><br><span class="line">    created_at TIMESTAMPTZ <span class="keyword">DEFAULT</span> NOW(),</span><br><span class="line">    last_activity TIMESTAMPTZ <span class="keyword">DEFAULT</span> NOW(),</span><br><span class="line">    expires_at TIMESTAMPTZ <span class="keyword">NOT NULL</span>,</span><br><span class="line">    is_active <span class="type">BOOLEAN</span> <span class="keyword">DEFAULT</span> <span class="literal">true</span>,</span><br><span class="line">    </span><br><span class="line">    INDEX idx_user_sessions_user_id (user_id),</span><br><span class="line">    INDEX idx_user_sessions_expires_at (expires_at),</span><br><span class="line">    INDEX idx_user_sessions_active (is_active, expires_at)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- MFA codes table</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> mfa_codes (</span><br><span class="line">    id UUID <span class="keyword">PRIMARY KEY</span> <span class="keyword">DEFAULT</span> gen_random_uuid(),</span><br><span class="line">    user_id UUID <span class="keyword">NOT NULL</span> <span class="keyword">REFERENCES</span> users(id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">    code_hash <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    <span class="keyword">method</span> <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT NULL</span>, <span class="comment">-- &#x27;email&#x27; or &#x27;sms&#x27;</span></span><br><span class="line">    attempts <span class="type">INTEGER</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">    is_used <span class="type">BOOLEAN</span> <span class="keyword">DEFAULT</span> <span class="literal">false</span>,</span><br><span class="line">    expires_at TIMESTAMPTZ <span class="keyword">NOT NULL</span>,</span><br><span class="line">    created_at TIMESTAMPTZ <span class="keyword">DEFAULT</span> NOW(),</span><br><span class="line">    </span><br><span class="line">    INDEX idx_mfa_codes_user_id (user_id),</span><br><span class="line">    INDEX idx_mfa_codes_expires_at (expires_at)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- SSO providers table</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> sso_providers (</span><br><span class="line">    id UUID <span class="keyword">PRIMARY KEY</span> <span class="keyword">DEFAULT</span> gen_random_uuid(),</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    type <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT NULL</span>, <span class="comment">-- &#x27;oauth2&#x27; or &#x27;saml&#x27;</span></span><br><span class="line">    client_id <span class="type">VARCHAR</span>(<span class="number">255</span>),</span><br><span class="line">    client_secret <span class="type">VARCHAR</span>(<span class="number">255</span>),</span><br><span class="line">    discovery_url <span class="type">VARCHAR</span>(<span class="number">500</span>),</span><br><span class="line">    attribute_mappings JSONB,</span><br><span class="line">    is_enabled <span class="type">BOOLEAN</span> <span class="keyword">DEFAULT</span> <span class="literal">true</span>,</span><br><span class="line">    created_at TIMESTAMPTZ <span class="keyword">DEFAULT</span> NOW()</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- User SSO links table</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> user_sso_links (</span><br><span class="line">    id UUID <span class="keyword">PRIMARY KEY</span> <span class="keyword">DEFAULT</span> gen_random_uuid(),</span><br><span class="line">    user_id UUID <span class="keyword">NOT NULL</span> <span class="keyword">REFERENCES</span> users(id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">    provider_id UUID <span class="keyword">NOT NULL</span> <span class="keyword">REFERENCES</span> sso_providers(id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">    external_user_id <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    created_at TIMESTAMPTZ <span class="keyword">DEFAULT</span> NOW(),</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">UNIQUE</span>(provider_id, external_user_id),</span><br><span class="line">    INDEX idx_user_sso_links_user_id (user_id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><strong>💡 Interview Insight</strong>: When discussing database design, explain indexing strategies for authentication queries. Discuss partitioning strategies for large user tables and how to handle user data privacy requirements (GDPR compliance). Address database security practices like encryption at rest and in transit.</p>
<h2 id="API-Design"><a href="#API-Design" class="headerlink" title="API Design"></a>API Design</h2><h3 id="Authentication-Endpoints"><a href="#Authentication-Endpoints" class="headerlink" title="Authentication Endpoints"></a>Authentication Endpoints</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Authentication API specification</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">AuthAPI</span> &#123;</span><br><span class="line">  <span class="comment">// Basic authentication</span></span><br><span class="line">  <span class="string">&#x27;POST /auth/login&#x27;</span>: &#123;</span><br><span class="line">    <span class="attr">body</span>: <span class="title class_">LoginRequest</span>;</span><br><span class="line">    <span class="attr">response</span>: <span class="title class_">LoginResponse</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">  <span class="string">&#x27;POST /auth/logout&#x27;</span>: &#123;</span><br><span class="line">    <span class="attr">headers</span>: &#123; <span class="title class_">Authorization</span>: <span class="built_in">string</span> &#125;;</span><br><span class="line">    <span class="attr">response</span>: <span class="title class_">LogoutResponse</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">  <span class="string">&#x27;POST /auth/refresh&#x27;</span>: &#123;</span><br><span class="line">    <span class="attr">body</span>: <span class="title class_">RefreshTokenRequest</span>;</span><br><span class="line">    <span class="attr">response</span>: <span class="title class_">TokenResponse</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// SSO endpoints</span></span><br><span class="line">  <span class="string">&#x27;GET /auth/sso/:provider/login&#x27;</span>: &#123;</span><br><span class="line">    <span class="attr">query</span>: &#123; <span class="attr">redirect_uri</span>?: <span class="built_in">string</span> &#125;;</span><br><span class="line">    <span class="attr">response</span>: <span class="title class_">RedirectResponse</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">  <span class="string">&#x27;POST /auth/sso/:provider/callback&#x27;</span>: &#123;</span><br><span class="line">    <span class="attr">body</span>: <span class="title class_">SSOCallbackRequest</span>;</span><br><span class="line">    <span class="attr">response</span>: <span class="title class_">LoginResponse</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// MFA endpoints</span></span><br><span class="line">  <span class="string">&#x27;POST /auth/mfa/send-code&#x27;</span>: &#123;</span><br><span class="line">    <span class="attr">body</span>: <span class="title class_">SendMFACodeRequest</span>;</span><br><span class="line">    <span class="attr">response</span>: <span class="title class_">SendMFACodeResponse</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">  <span class="string">&#x27;POST /auth/mfa/verify-code&#x27;</span>: &#123;</span><br><span class="line">    <span class="attr">body</span>: <span class="title class_">VerifyMFACodeRequest</span>;</span><br><span class="line">    <span class="attr">response</span>: <span class="title class_">MFAVerificationResponse</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Request-Response-Models"><a href="#Request-Response-Models" class="headerlink" title="Request&#x2F;Response Models"></a>Request&#x2F;Response Models</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">LoginRequest</span> &#123;</span><br><span class="line">  <span class="attr">email</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">password</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">rememberMe</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">deviceInfo</span>?: <span class="title class_">DeviceInfo</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">LoginResponse</span> &#123;</span><br><span class="line">  <span class="attr">success</span>: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">accessToken</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">refreshToken</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">user</span>?: <span class="title class_">UserProfile</span>;</span><br><span class="line">  <span class="attr">mfaRequired</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">mfaToken</span>?: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DeviceInfo</span> &#123;</span><br><span class="line">  <span class="attr">deviceId</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">deviceName</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">platform</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">browser</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">ipAddress</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Error-Handling"><a href="#Error-Handling" class="headerlink" title="Error Handling"></a>Error Handling</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">AuthErrorCode</span> &#123;</span><br><span class="line">  <span class="variable constant_">INVALID_CREDENTIALS</span> = <span class="string">&#x27;INVALID_CREDENTIALS&#x27;</span>,</span><br><span class="line">  <span class="variable constant_">ACCOUNT_LOCKED</span> = <span class="string">&#x27;ACCOUNT_LOCKED&#x27;</span>,</span><br><span class="line">  <span class="variable constant_">MFA_REQUIRED</span> = <span class="string">&#x27;MFA_REQUIRED&#x27;</span>,</span><br><span class="line">  <span class="variable constant_">INVALID_MFA_CODE</span> = <span class="string">&#x27;INVALID_MFA_CODE&#x27;</span>,</span><br><span class="line">  <span class="variable constant_">SESSION_EXPIRED</span> = <span class="string">&#x27;SESSION_EXPIRED&#x27;</span>,</span><br><span class="line">  <span class="variable constant_">RATE_LIMIT_EXCEEDED</span> = <span class="string">&#x27;RATE_LIMIT_EXCEEDED&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">AuthError</span> &#123;</span><br><span class="line">  <span class="attr">code</span>: <span class="title class_">AuthErrorCode</span>;</span><br><span class="line">  <span class="attr">message</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">details</span>?: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">any</span>&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>💡 Interview Insight</strong>: Discuss API design principles like RESTful conventions, proper HTTP status codes, and error handling strategies. Explain how to design APIs for both web and mobile clients, including considerations for offline functionality and progressive web apps.</p>
<h2 id="Frontend-Implementation"><a href="#Frontend-Implementation" class="headerlink" title="Frontend Implementation"></a>Frontend Implementation</h2><h3 id="React-Authentication-Hook"><a href="#React-Authentication-Hook" class="headerlink" title="React Authentication Hook"></a>React Authentication Hook</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">AuthContextType</span> &#123;</span><br><span class="line">  <span class="attr">user</span>: <span class="title class_">User</span> | <span class="literal">null</span>;</span><br><span class="line">  <span class="attr">isAuthenticated</span>: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">isLoading</span>: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">login</span>: <span class="function">(<span class="params"><span class="attr">credentials</span>: <span class="title class_">LoginCredentials</span></span>) =&gt;</span> <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt;;</span><br><span class="line">  <span class="attr">logout</span>: <span class="function">() =&gt;</span> <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt;;</span><br><span class="line">  <span class="attr">refreshToken</span>: <span class="function">() =&gt;</span> <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useAuth = (): <span class="function"><span class="params">AuthContextType</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [user, setUser] = useState&lt;<span class="title class_">User</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> [isLoading, setIsLoading] = <span class="title function_">useState</span>(<span class="literal">true</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">login</span> = <span class="keyword">async</span> (<span class="params"><span class="attr">credentials</span>: <span class="title class_">LoginCredentials</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> authAPI.<span class="title function_">login</span>(credentials);</span><br><span class="line">    <span class="keyword">if</span> (response.<span class="property">mfaRequired</span>) &#123;</span><br><span class="line">      <span class="comment">// Handle MFA flow</span></span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">MFARequiredError</span>(response.<span class="property">mfaToken</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">setUser</span>(response.<span class="property">user</span>);</span><br><span class="line">    tokenManager.<span class="title function_">setTokens</span>(&#123;</span><br><span class="line">      <span class="attr">accessToken</span>: response.<span class="property">accessToken</span>,</span><br><span class="line">      <span class="attr">refreshToken</span>: response.<span class="property">refreshToken</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> &#123; user, <span class="attr">isAuthenticated</span>: !!user, isLoading, login, logout, refreshToken &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="Session-Timeout-Handler"><a href="#Session-Timeout-Handler" class="headerlink" title="Session Timeout Handler"></a>Session Timeout Handler</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SessionTimeoutManager</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">warningTimer</span>?: <span class="title class_">NodeJS</span>.<span class="property">Timeout</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">logoutTimer</span>?: <span class="title class_">NodeJS</span>.<span class="property">Timeout</span>;</span><br><span class="line">  <span class="keyword">private</span> lastActivity = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="variable constant_">WARNING_TIME</span> = <span class="number">25</span> * <span class="number">60</span> * <span class="number">1000</span>; <span class="comment">// 25 minutes</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="variable constant_">TIMEOUT_TIME</span> = <span class="number">30</span> * <span class="number">60</span> * <span class="number">1000</span>; <span class="comment">// 30 minutes</span></span><br><span class="line">  </span><br><span class="line">  <span class="title function_">startTracking</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">resetTimers</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setupActivityListeners</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">setupActivityListeners</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> events = [<span class="string">&#x27;mousedown&#x27;</span>, <span class="string">&#x27;mousemove&#x27;</span>, <span class="string">&#x27;keypress&#x27;</span>, <span class="string">&#x27;scroll&#x27;</span>, <span class="string">&#x27;touchstart&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleActivity</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> now = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">      <span class="keyword">if</span> (now - <span class="variable language_">this</span>.<span class="property">lastActivity</span> &gt; <span class="number">60000</span>) &#123; <span class="comment">// Only reset if 1+ minutes since last activity</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">lastActivity</span> = now;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">resetTimers</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    events.<span class="title function_">forEach</span>(<span class="function"><span class="params">event</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(event, handleActivity, <span class="literal">true</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">resetTimers</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(<span class="variable language_">this</span>.<span class="property">warningTimer</span>);</span><br><span class="line">    <span class="built_in">clearTimeout</span>(<span class="variable language_">this</span>.<span class="property">logoutTimer</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">warningTimer</span> = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">showTimeoutWarning</span>();</span><br><span class="line">    &#125;, <span class="variable language_">this</span>.<span class="property">WARNING_TIME</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">logoutTimer</span> = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">forceLogout</span>();</span><br><span class="line">    &#125;, <span class="variable language_">this</span>.<span class="property">TIMEOUT_TIME</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">showTimeoutWarning</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// Show modal warning user of impending logout</span></span><br><span class="line">    <span class="keyword">const</span> remainingTime = <span class="number">5</span> * <span class="number">60</span>; <span class="comment">// 5 minutes</span></span><br><span class="line">    <span class="title function_">showTimeoutModal</span>(&#123;</span><br><span class="line">      remainingTime,</span><br><span class="line">      <span class="attr">onExtendSession</span>: <span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">extendSession</span>(),</span><br><span class="line">      <span class="attr">onLogout</span>: <span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">forceLogout</span>()</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>💡 Interview Insight</strong>: Explain the challenges of managing authentication state in single-page applications. Discuss how to handle token refresh, route protection, and the user experience during authentication flows. Address accessibility considerations for login forms and error states.</p>
<h2 id="Monitoring-Analytics"><a href="#Monitoring-Analytics" class="headerlink" title="Monitoring &amp; Analytics"></a>Monitoring &amp; Analytics</h2><h3 id="Key-Metrics-to-Track"><a href="#Key-Metrics-to-Track" class="headerlink" title="Key Metrics to Track"></a>Key Metrics to Track</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">AuthMetrics</span> &#123;</span><br><span class="line">  <span class="comment">// Success metrics</span></span><br><span class="line">  <span class="attr">loginSuccessRate</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">ssoSuccessRate</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">mfaSuccessRate</span>: <span class="built_in">number</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Performance metrics</span></span><br><span class="line">  <span class="attr">loginLatency</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">mfaLatency</span>: <span class="built_in">number</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Security metrics</span></span><br><span class="line">  <span class="attr">failedLoginAttempts</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">accountLockouts</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">suspiciousActivities</span>: <span class="built_in">number</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// User experience metrics</span></span><br><span class="line">  <span class="attr">sessionDuration</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">timeoutOccurrences</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">userReturnRate</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Logging-Alerting"><a href="#Logging-Alerting" class="headerlink" title="Logging &amp; Alerting"></a>Logging &amp; Alerting</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">AuthLogger</span> &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">logAuthEvent</span>(<span class="attr">event</span>: <span class="title class_">AuthEvent</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> logEntry = &#123;</span><br><span class="line">      <span class="attr">timestamp</span>: <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toISOString</span>(),</span><br><span class="line">      <span class="attr">eventType</span>: event.<span class="property">type</span>,</span><br><span class="line">      <span class="attr">userId</span>: event.<span class="property">userId</span>,</span><br><span class="line">      <span class="attr">sessionId</span>: event.<span class="property">sessionId</span>,</span><br><span class="line">      <span class="attr">ipAddress</span>: event.<span class="property">ipAddress</span>,</span><br><span class="line">      <span class="attr">userAgent</span>: event.<span class="property">userAgent</span>,</span><br><span class="line">      <span class="attr">success</span>: event.<span class="property">success</span>,</span><br><span class="line">      <span class="attr">metadata</span>: event.<span class="property">metadata</span></span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Log to multiple destinations</span></span><br><span class="line">    <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>([</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">logToDatabase</span>(logEntry),</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">logToAnalytics</span>(logEntry),</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">checkForAlerts</span>(logEntry)</span><br><span class="line">    ]);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">async</span> <span class="title function_">checkForAlerts</span>(<span class="attr">logEntry</span>: <span class="title class_">LogEntry</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt; &#123;</span><br><span class="line">    <span class="comment">// Check for suspicious patterns</span></span><br><span class="line">    <span class="keyword">if</span> (logEntry.<span class="property">eventType</span> === <span class="string">&#x27;LOGIN_FAILED&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> recentFailures = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">getRecentFailures</span>(</span><br><span class="line">        logEntry.<span class="property">ipAddress</span>, </span><br><span class="line">        <span class="string">&#x27;5 minutes&#x27;</span></span><br><span class="line">      );</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">if</span> (recentFailures.<span class="property">length</span> &gt; <span class="number">10</span>) &#123;</span><br><span class="line">        <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">sendAlert</span>(&#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;BRUTE_FORCE_DETECTED&#x27;</span>,</span><br><span class="line">          <span class="attr">ipAddress</span>: logEntry.<span class="property">ipAddress</span>,</span><br><span class="line">          <span class="attr">attemptCount</span>: recentFailures.<span class="property">length</span></span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>💡 Interview Insight</strong>: Discuss the importance of comprehensive logging for security and debugging. Explain how to balance detailed logging with privacy concerns, and how to set up effective alerting for security incidents. Address compliance requirements like audit trails and data retention policies.</p>
<h3 id="Security-Monitoring-Dashboard"><a href="#Security-Monitoring-Dashboard" class="headerlink" title="Security Monitoring Dashboard"></a>Security Monitoring Dashboard</h3><pre>
<code class="mermaid">
graph TB
A[Auth Events] --&gt; B[Event Processor]
B --&gt; C[Real-time Analytics]
B --&gt; D[Alert Engine]
B --&gt; E[Audit Log]

C --&gt; F[Dashboard]
D --&gt; G[Security Team]
E --&gt; H[Compliance Reports]

F --&gt; I[Login Success Rate]
F --&gt; J[Failed Attempts]
F --&gt; K[Geographic Analysis]
F --&gt; L[Device Analysis]
</code>
</pre>

<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>This comprehensive login system design provides a robust foundation for secure user authentication while maintaining excellent user experience. The system addresses modern security challenges through multi-layered defense strategies, intelligent session management, and comprehensive monitoring.</p>
<h3 id="Key-Takeaways"><a href="#Key-Takeaways" class="headerlink" title="Key Takeaways"></a>Key Takeaways</h3><ol>
<li><strong>Security-First Design</strong>: Every component considers security implications first</li>
<li><strong>User Experience</strong>: Balanced security with seamless user interactions</li>
<li><strong>Scalability</strong>: Designed for horizontal scaling and high availability</li>
<li><strong>Monitoring</strong>: Comprehensive logging and alerting for proactive security</li>
<li><strong>Compliance</strong>: Built with privacy and regulatory requirements in mind</li>
</ol>
<h3 id="Next-Steps-for-Implementation"><a href="#Next-Steps-for-Implementation" class="headerlink" title="Next Steps for Implementation"></a>Next Steps for Implementation</h3><ol>
<li>Start with core authentication and session management</li>
<li>Implement basic MFA with email verification</li>
<li>Add SSO support for major providers</li>
<li>Enhance with advanced security features</li>
<li>Implement comprehensive monitoring and alerting</li>
</ol>
<p><strong>💡 Final Interview Insight</strong>: When presenting system designs, always discuss the evolution path and how you’d handle changing requirements. Explain how you’d test the system, handle edge cases, and ensure high availability. Be prepared to deep-dive into any component and explain the technical and business trade-offs made in your design decisions.</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/system-design/" rel="tag"># system-design</a>
              <a href="/tags/user-login-system/" rel="tag"># user login system</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/06/12/Design-Grey-Service-Router-Guide/" rel="prev" title="Design Grey Service Router Guide">
                  <i class="fa fa-angle-left"></i> Design Grey Service Router Guide
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/06/13/Design-Logs-Analysis-Platform-with-ELK-Stack/" rel="next" title="Design Logs Analysis Platform with ELK Stack">
                  Design Logs Analysis Platform with ELK Stack <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Charlie Feng</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
