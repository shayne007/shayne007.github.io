<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"shayne007.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.23.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="System Architecture OverviewCore ComponentsA robust login system with SSO consists of several interconnected components: 123456789101112131415161718graph TB    A[Client Application] --&gt; B[Load Bala">
<meta property="og:type" content="article">
<meta property="og:title" content="Design User Login Systems with SSO Feature">
<meta property="og:url" content="https://shayne007.github.io/2025/06/12/Design-User-Login-Systems-with-SSO-Feature/index.html">
<meta property="og:site_name" content="Charlie Feng&#39;s Tech Space">
<meta property="og:description" content="System Architecture OverviewCore ComponentsA robust login system with SSO consists of several interconnected components: 123456789101112131415161718graph TB    A[Client Application] --&gt; B[Load Bala">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-06-12T15:47:50.000Z">
<meta property="article:modified_time" content="2025-06-12T15:51:59.088Z">
<meta property="article:author" content="Charlie Feng">
<meta property="article:tag" content="system-design">
<meta property="article:tag" content="user login system">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://shayne007.github.io/2025/06/12/Design-User-Login-Systems-with-SSO-Feature/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://shayne007.github.io/2025/06/12/Design-User-Login-Systems-with-SSO-Feature/","path":"2025/06/12/Design-User-Login-Systems-with-SSO-Feature/","title":"Design User Login Systems with SSO Feature"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Design User Login Systems with SSO Feature | Charlie Feng's Tech Space</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"cdn":false,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.5.0/mermaid.min.js","integrity":"sha256-2obLuIPcceEhkE3G09G33hBdmE55ivVcZUlcKcGNHjU="}}</script>
  <script src="/js/third-party/tags/mermaid.js" defer></script>





  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Charlie Feng's Tech Space</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">You will survive with skills</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#System-Architecture-Overview"><span class="nav-number">1.</span> <span class="nav-text">System Architecture Overview</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Core-Components"><span class="nav-number">1.1.</span> <span class="nav-text">Core Components</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Key-Architectural-Decisions"><span class="nav-number">1.2.</span> <span class="nav-text">Key Architectural Decisions</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Authentication-vs-Authorization"><span class="nav-number">2.</span> <span class="nav-text">Authentication vs Authorization</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Authentication-Flow"><span class="nav-number">2.1.</span> <span class="nav-text">Authentication Flow</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Authorization-Models"><span class="nav-number">2.2.</span> <span class="nav-text">Authorization Models</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#URL-Design-Patterns"><span class="nav-number">3.</span> <span class="nav-text">URL Design Patterns</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#RESTful-Authentication-Endpoints"><span class="nav-number">3.1.</span> <span class="nav-text">RESTful Authentication Endpoints</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Frontend-Route-Structure"><span class="nav-number">3.2.</span> <span class="nav-text">Frontend Route Structure</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#URL-Security-Best-Practices"><span class="nav-number">3.3.</span> <span class="nav-text">URL Security Best Practices</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SSO-Implementation-Strategies"><span class="nav-number">4.</span> <span class="nav-text">SSO Implementation Strategies</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#OAuth-2-0-Flow"><span class="nav-number">4.1.</span> <span class="nav-text">OAuth 2.0 Flow</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SAML-2-0-Integration"><span class="nav-number">4.2.</span> <span class="nav-text">SAML 2.0 Integration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OpenID-Connect-OIDC"><span class="nav-number">4.3.</span> <span class="nav-text">OpenID Connect (OIDC)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Provider-Specific-Implementations"><span class="nav-number">4.4.</span> <span class="nav-text">Provider-Specific Implementations</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Security-Considerations"><span class="nav-number">5.</span> <span class="nav-text">Security Considerations</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#JWT-Token-Security"><span class="nav-number">5.1.</span> <span class="nav-text">JWT Token Security</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Security-Headers"><span class="nav-number">5.2.</span> <span class="nav-text">Security Headers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Password-Security"><span class="nav-number">5.3.</span> <span class="nav-text">Password Security</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Common-Security-Vulnerabilities"><span class="nav-number">5.4.</span> <span class="nav-text">Common Security Vulnerabilities</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Database-Schema-Design"><span class="nav-number">6.</span> <span class="nav-text">Database Schema Design</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Core-Tables"><span class="nav-number">6.1.</span> <span class="nav-text">Core Tables</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Indexing-Strategy"><span class="nav-number">6.2.</span> <span class="nav-text">Indexing Strategy</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#API-Design-and-Error-Handling"><span class="nav-number">7.</span> <span class="nav-text">API Design and Error Handling</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Authentication-API-Endpoints"><span class="nav-number">7.1.</span> <span class="nav-text">Authentication API Endpoints</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Error-Response-Format"><span class="nav-number">7.2.</span> <span class="nav-text">Error Response Format</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Status-Code-Strategy"><span class="nav-number">7.3.</span> <span class="nav-text">Status Code Strategy</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#User-Experience-and-Frontend-Integration"><span class="nav-number">8.</span> <span class="nav-text">User Experience and Frontend Integration</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Login-Flow-States"><span class="nav-number">8.1.</span> <span class="nav-text">Login Flow States</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Frontend-Integration-Example"><span class="nav-number">8.2.</span> <span class="nav-text">Frontend Integration Example</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Progressive-Enhancement"><span class="nav-number">8.3.</span> <span class="nav-text">Progressive Enhancement</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Testing-and-Monitoring"><span class="nav-number">9.</span> <span class="nav-text">Testing and Monitoring</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Test-Strategy"><span class="nav-number">9.1.</span> <span class="nav-text">Test Strategy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#End-to-End-Testing"><span class="nav-number">9.2.</span> <span class="nav-text">End-to-End Testing</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Monitoring-Alerting"><span class="nav-number">9.3.</span> <span class="nav-text">Monitoring &amp; Alerting</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Key-Metrics-to-Monitor"><span class="nav-number">9.4.</span> <span class="nav-text">Key Metrics to Monitor</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Performance-and-Scalability"><span class="nav-number">10.</span> <span class="nav-text">Performance and Scalability</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Caching-Strategies"><span class="nav-number">10.1.</span> <span class="nav-text">Caching Strategies</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Database-Connection-Pooling"><span class="nav-number">10.2.</span> <span class="nav-text">Database Connection Pooling</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Load-Balancing-Considerations"><span class="nav-number">10.3.</span> <span class="nav-text">Load Balancing Considerations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Horizontal-Scaling-Architecture"><span class="nav-number">10.4.</span> <span class="nav-text">Horizontal Scaling Architecture</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Performance-Optimization-Checklist"><span class="nav-number">10.5.</span> <span class="nav-text">Performance Optimization Checklist</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Advanced-Topics"><span class="nav-number">11.</span> <span class="nav-text">Advanced Topics</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Multi-Factor-Authentication-MFA"><span class="nav-number">11.1.</span> <span class="nav-text">Multi-Factor Authentication (MFA)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Zero-Trust-Architecture"><span class="nav-number">11.2.</span> <span class="nav-text">Zero-Trust Architecture</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Charlie Feng</p>
  <div class="site-description" itemprop="description">This place is for thinking and sharing.</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">31</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://shayne007.github.io/2025/06/12/Design-User-Login-Systems-with-SSO-Feature/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Charlie Feng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Charlie Feng's Tech Space">
      <meta itemprop="description" content="This place is for thinking and sharing.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Design User Login Systems with SSO Feature | Charlie Feng's Tech Space">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Design User Login Systems with SSO Feature
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2025-06-12 23:47:50 / Modified: 23:51:59" itemprop="dateCreated datePublished" datetime="2025-06-12T23:47:50+08:00">2025-06-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/system-design/" itemprop="url" rel="index"><span itemprop="name">system-design</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="System-Architecture-Overview"><a href="#System-Architecture-Overview" class="headerlink" title="System Architecture Overview"></a>System Architecture Overview</h2><h3 id="Core-Components"><a href="#Core-Components" class="headerlink" title="Core Components"></a>Core Components</h3><p>A robust login system with SSO consists of several interconnected components:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">graph TB</span><br><span class="line">    A[Client Application] --&gt; B[Load Balancer]</span><br><span class="line">    B --&gt; C[API Gateway]</span><br><span class="line">    C --&gt; D[Authentication Service]</span><br><span class="line">    C --&gt; E[Authorization Service]</span><br><span class="line">    C --&gt; F[User Management Service]</span><br><span class="line">    </span><br><span class="line">    D --&gt; G[Session Store/Redis]</span><br><span class="line">    D --&gt; H[Identity Providers]</span><br><span class="line">    H --&gt; I[Google OAuth]</span><br><span class="line">    H --&gt; J[Microsoft AD]</span><br><span class="line">    H --&gt; K[SAML Provider]</span><br><span class="line">    </span><br><span class="line">    F --&gt; L[User Database]</span><br><span class="line">    E --&gt; M[Permissions Database]</span><br><span class="line">    </span><br><span class="line">    D --&gt; N[JWT Token Service]</span><br><span class="line">    N --&gt; O[Token Blacklist]</span><br></pre></td></tr></table></figure>

<p><strong>Interview Insight:</strong> <em>Candidates should understand the separation of concerns between authentication (who you are) and authorization (what you can do). A common mistake is coupling these tightly together.</em></p>
<h3 id="Key-Architectural-Decisions"><a href="#Key-Architectural-Decisions" class="headerlink" title="Key Architectural Decisions"></a>Key Architectural Decisions</h3><ol>
<li><p><strong>Stateless vs Stateful Authentication</strong></p>
<ul>
<li><strong>Stateless (JWT)</strong>: Better for distributed systems, no server-side session storage</li>
<li><strong>Stateful (Sessions)</strong>: Better control over session lifecycle, easier to revoke</li>
</ul>
</li>
<li><p><strong>Microservices vs Monolithic</strong></p>
<ul>
<li><strong>Microservices</strong>: Better scalability, technology diversity</li>
<li><strong>Monolithic</strong>: Simpler deployment, easier testing</li>
</ul>
</li>
</ol>
<p><strong>Interview Question:</strong> <em>“How would you handle user sessions in a distributed system with multiple load-balanced servers?”</em></p>
<hr>
<h2 id="Authentication-vs-Authorization"><a href="#Authentication-vs-Authorization" class="headerlink" title="Authentication vs Authorization"></a>Authentication vs Authorization</h2><h3 id="Authentication-Flow"><a href="#Authentication-Flow" class="headerlink" title="Authentication Flow"></a>Authentication Flow</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    participant U as User</span><br><span class="line">    participant C as Client App</span><br><span class="line">    participant A as Auth Service</span><br><span class="line">    participant I as Identity Provider</span><br><span class="line">    participant D as Database</span><br><span class="line">    </span><br><span class="line">    U-&gt;&gt;C: Login Request</span><br><span class="line">    C-&gt;&gt;A: Authentication Request</span><br><span class="line">    A-&gt;&gt;I: Redirect to IdP</span><br><span class="line">    I-&gt;&gt;U: Login Form</span><br><span class="line">    U-&gt;&gt;I: Credentials</span><br><span class="line">    I-&gt;&gt;A: Auth Code/Token</span><br><span class="line">    A-&gt;&gt;D: Validate/Store User</span><br><span class="line">    A-&gt;&gt;C: JWT/Session Token</span><br><span class="line">    C-&gt;&gt;U: Login Success</span><br></pre></td></tr></table></figure>

<h3 id="Authorization-Models"><a href="#Authorization-Models" class="headerlink" title="Authorization Models"></a>Authorization Models</h3><ol>
<li><strong>Role-Based Access Control (RBAC)</strong></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User → Role → Permissions</span><br><span class="line">john@company.com → Admin → [create_user, delete_user, read_reports]</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><strong>Attribute-Based Access Control (ABAC)</strong></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Policy: Allow if (user.department == &quot;HR&quot; AND resource.type == &quot;employee_record&quot; AND action == &quot;read&quot;)</span><br></pre></td></tr></table></figure>

<p><strong>Interview Insight:</strong> <em>Discuss trade-offs between RBAC (simpler) and ABAC (more flexible but complex). Most enterprise systems use hybrid approaches.</em></p>
<hr>
<h2 id="URL-Design-Patterns"><a href="#URL-Design-Patterns" class="headerlink" title="URL Design Patterns"></a>URL Design Patterns</h2><h3 id="RESTful-Authentication-Endpoints"><a href="#RESTful-Authentication-Endpoints" class="headerlink" title="RESTful Authentication Endpoints"></a>RESTful Authentication Endpoints</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Authentication Endpoints:</span><br><span class="line">├── POST   /api/v1/auth/login</span><br><span class="line">├── POST   /api/v1/auth/logout</span><br><span class="line">├── POST   /api/v1/auth/refresh</span><br><span class="line">├── POST   /api/v1/auth/forgot-password</span><br><span class="line">├── POST   /api/v1/auth/reset-password</span><br><span class="line">└── GET    /api/v1/auth/me</span><br><span class="line"></span><br><span class="line">SSO Endpoints:</span><br><span class="line">├── GET    /api/v1/auth/sso/&#123;provider&#125;/authorize</span><br><span class="line">├── GET    /api/v1/auth/sso/&#123;provider&#125;/callback</span><br><span class="line">├── POST   /api/v1/auth/sso/&#123;provider&#125;/link</span><br><span class="line">└── DELETE /api/v1/auth/sso/&#123;provider&#125;/unlink</span><br><span class="line"></span><br><span class="line">User Management:</span><br><span class="line">├── GET    /api/v1/users</span><br><span class="line">├── POST   /api/v1/users</span><br><span class="line">├── GET    /api/v1/users/&#123;id&#125;</span><br><span class="line">├── PUT    /api/v1/users/&#123;id&#125;</span><br><span class="line">└── DELETE /api/v1/users/&#123;id&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Frontend-Route-Structure"><a href="#Frontend-Route-Structure" class="headerlink" title="Frontend Route Structure"></a>Frontend Route Structure</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Public Routes:</span><br><span class="line">├── /login</span><br><span class="line">├── /register</span><br><span class="line">├── /forgot-password</span><br><span class="line">├── /reset-password/&#123;token&#125;</span><br><span class="line">└── /sso/callback/&#123;provider&#125;</span><br><span class="line"></span><br><span class="line">Protected Routes:</span><br><span class="line">├── /dashboard</span><br><span class="line">├── /profile</span><br><span class="line">├── /settings</span><br><span class="line">└── /admin/*</span><br><span class="line"></span><br><span class="line">SSO Integration Routes:</span><br><span class="line">├── /auth/google</span><br><span class="line">├── /auth/microsoft</span><br><span class="line">├── /auth/okta</span><br><span class="line">└── /auth/saml/&#123;domain&#125;</span><br></pre></td></tr></table></figure>

<h3 id="URL-Security-Best-Practices"><a href="#URL-Security-Best-Practices" class="headerlink" title="URL Security Best Practices"></a>URL Security Best Practices</h3><ol>
<li><p><strong>Use HTTPS Everywhere</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">✅ https://api.example.com/auth/login</span><br><span class="line">❌ http://api.example.com/auth/login</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Avoid Sensitive Data in URLs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">✅ POST /auth/reset-password (token in body)</span><br><span class="line">❌ GET /auth/reset-password?token=sensitive_token</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Implement Rate Limiting</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/auth/login - 5 requests per minute per IP</span><br><span class="line">/auth/forgot-password - 3 requests per hour per email</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>Interview Question:</strong> <em>“How would you design URLs for a multi-tenant SaaS application with SSO?”</em></p>
<hr>
<h2 id="SSO-Implementation-Strategies"><a href="#SSO-Implementation-Strategies" class="headerlink" title="SSO Implementation Strategies"></a>SSO Implementation Strategies</h2><h3 id="OAuth-2-0-Flow"><a href="#OAuth-2-0-Flow" class="headerlink" title="OAuth 2.0 Flow"></a>OAuth 2.0 Flow</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    participant U as User</span><br><span class="line">    participant C as Client App</span><br><span class="line">    participant A as Auth Server</span><br><span class="line">    participant R as Resource Server</span><br><span class="line">    participant I as Identity Provider</span><br><span class="line">    </span><br><span class="line">    U-&gt;&gt;C: Access Protected Resource</span><br><span class="line">    C-&gt;&gt;A: Authorization Request</span><br><span class="line">    A-&gt;&gt;I: Redirect to IdP</span><br><span class="line">    I-&gt;&gt;U: Login Prompt</span><br><span class="line">    U-&gt;&gt;I: Authenticate</span><br><span class="line">    I-&gt;&gt;A: Authorization Code</span><br><span class="line">    A-&gt;&gt;I: Exchange Code for Token</span><br><span class="line">    I-&gt;&gt;A: Access Token</span><br><span class="line">    A-&gt;&gt;C: Access Token</span><br><span class="line">    C-&gt;&gt;R: API Request with Token</span><br><span class="line">    R-&gt;&gt;C: Protected Resource</span><br><span class="line">    C-&gt;&gt;U: Display Resource</span><br></pre></td></tr></table></figure>

<h3 id="SAML-2-0-Integration"><a href="#SAML-2-0-Integration" class="headerlink" title="SAML 2.0 Integration"></a>SAML 2.0 Integration</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Example SAML Response Structure --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">saml:Assertion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">saml:Subject</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">saml:NameID</span> <span class="attr">Format</span>=<span class="string">&quot;urn:oasis:names:tc:SAML:2.0:nameid-format:persistent&quot;</span>&gt;</span></span><br><span class="line">      user@company.com</span><br><span class="line">    <span class="tag">&lt;/<span class="name">saml:NameID</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">saml:Subject</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">saml:AttributeStatement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">saml:Attribute</span> <span class="attr">Name</span>=<span class="string">&quot;email&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">saml:AttributeValue</span>&gt;</span>user@company.com<span class="tag">&lt;/<span class="name">saml:AttributeValue</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">saml:Attribute</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">saml:Attribute</span> <span class="attr">Name</span>=<span class="string">&quot;role&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">saml:AttributeValue</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">saml:AttributeValue</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">saml:Attribute</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">saml:AttributeStatement</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">saml:Assertion</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="OpenID-Connect-OIDC"><a href="#OpenID-Connect-OIDC" class="headerlink" title="OpenID Connect (OIDC)"></a>OpenID Connect (OIDC)</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;iss&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://accounts.google.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;sub&quot;</span><span class="punctuation">:</span> <span class="string">&quot;110169484474386276334&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;aud&quot;</span><span class="punctuation">:</span> <span class="string">&quot;your-client-id&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;exp&quot;</span><span class="punctuation">:</span> <span class="number">1633024800</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;iat&quot;</span><span class="punctuation">:</span> <span class="number">1633021200</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user@example.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;email_verified&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;John Doe&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;picture&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://example.com/photo.jpg&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Provider-Specific-Implementations"><a href="#Provider-Specific-Implementations" class="headerlink" title="Provider-Specific Implementations"></a>Provider-Specific Implementations</h3><table>
<thead>
<tr>
<th>Provider</th>
<th>Protocol</th>
<th>Key Features</th>
<th>Configuration URL</th>
</tr>
</thead>
<tbody><tr>
<td>Google</td>
<td>OAuth 2.0&#x2F;OIDC</td>
<td>Gmail integration, G Suite</td>
<td><code>/auth/google</code></td>
</tr>
<tr>
<td>Microsoft</td>
<td>OAuth 2.0&#x2F;OIDC</td>
<td>Office 365, Azure AD</td>
<td><code>/auth/microsoft</code></td>
</tr>
<tr>
<td>Okta</td>
<td>SAML&#x2F;OIDC</td>
<td>Enterprise SSO</td>
<td><code>/auth/okta</code></td>
</tr>
<tr>
<td>Auth0</td>
<td>Multiple</td>
<td>Universal login</td>
<td><code>/auth/auth0</code></td>
</tr>
</tbody></table>
<p><strong>Interview Insight:</strong> <em>Candidates should understand the differences between OAuth 2.0 (authorization), OpenID Connect (authentication), and SAML (enterprise SSO). Each serves different use cases.</em></p>
<hr>
<h2 id="Security-Considerations"><a href="#Security-Considerations" class="headerlink" title="Security Considerations"></a>Security Considerations</h2><h3 id="JWT-Token-Security"><a href="#JWT-Token-Security" class="headerlink" title="JWT Token Security"></a>JWT Token Security</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Secure JWT Configuration</span></span><br><span class="line"><span class="keyword">const</span> jwtConfig = &#123;</span><br><span class="line">  <span class="attr">algorithm</span>: <span class="string">&#x27;RS256&#x27;</span>,           <span class="comment">// Asymmetric signing</span></span><br><span class="line">  <span class="attr">expiresIn</span>: <span class="string">&#x27;15m&#x27;</span>,            <span class="comment">// Short-lived access tokens</span></span><br><span class="line">  <span class="attr">issuer</span>: <span class="string">&#x27;your-app.com&#x27;</span>,</span><br><span class="line">  <span class="attr">audience</span>: <span class="string">&#x27;your-api.com&#x27;</span>,</span><br><span class="line">  <span class="attr">clockTolerance</span>: <span class="number">30</span>,          <span class="comment">// Account for clock skew</span></span><br><span class="line">  <span class="attr">ignoreExpiration</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">ignoreNotBefore</span>: <span class="literal">false</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Refresh Token Strategy</span></span><br><span class="line"><span class="keyword">const</span> refreshTokenConfig = &#123;</span><br><span class="line">  <span class="attr">expiresIn</span>: <span class="string">&#x27;7d&#x27;</span>,             <span class="comment">// Longer-lived refresh tokens</span></span><br><span class="line">  <span class="attr">httpOnly</span>: <span class="literal">true</span>,              <span class="comment">// Prevent XSS attacks</span></span><br><span class="line">  <span class="attr">secure</span>: <span class="literal">true</span>,                <span class="comment">// HTTPS only</span></span><br><span class="line">  <span class="attr">sameSite</span>: <span class="string">&#x27;strict&#x27;</span>           <span class="comment">// CSRF protection</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="Security-Headers"><a href="#Security-Headers" class="headerlink" title="Security Headers"></a>Security Headers</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Essential Security Headers</span></span><br><span class="line"><span class="keyword">const</span> securityHeaders = &#123;</span><br><span class="line">  <span class="string">&#x27;Strict-Transport-Security&#x27;</span>: <span class="string">&#x27;max-age=31536000; includeSubDomains&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;X-Content-Type-Options&#x27;</span>: <span class="string">&#x27;nosniff&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;X-Frame-Options&#x27;</span>: <span class="string">&#x27;DENY&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;X-XSS-Protection&#x27;</span>: <span class="string">&#x27;1; mode=block&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;Content-Security-Policy&#x27;</span>: <span class="string">&quot;default-src &#x27;self&#x27;; script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27;&quot;</span>,</span><br><span class="line">  <span class="string">&#x27;Referrer-Policy&#x27;</span>: <span class="string">&#x27;strict-origin-when-cross-origin&#x27;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="Password-Security"><a href="#Password-Security" class="headerlink" title="Password Security"></a>Password Security</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Password Hashing Best Practices</span></span><br><span class="line"><span class="keyword">import</span> bcrypt</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PasswordManager</span>:</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">hash_password</span>(<span class="params">password: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="comment"># Generate salt and hash password</span></span><br><span class="line">        salt = bcrypt.gensalt(rounds=<span class="number">12</span>)  <span class="comment"># Adjust rounds based on security needs</span></span><br><span class="line">        <span class="keyword">return</span> bcrypt.hashpw(password.encode(<span class="string">&#x27;utf-8&#x27;</span>), salt).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify_password</span>(<span class="params">password: <span class="built_in">str</span>, hashed: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        <span class="keyword">return</span> bcrypt.checkpw(password.encode(<span class="string">&#x27;utf-8&#x27;</span>), hashed.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">generate_secure_token</span>(<span class="params">length: <span class="built_in">int</span> = <span class="number">32</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="keyword">return</span> secrets.token_urlsafe(length)</span><br></pre></td></tr></table></figure>

<h3 id="Common-Security-Vulnerabilities"><a href="#Common-Security-Vulnerabilities" class="headerlink" title="Common Security Vulnerabilities"></a>Common Security Vulnerabilities</h3><ol>
<li><p><strong>Session Fixation</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ✅ Regenerate session ID after login</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login_user</span>(<span class="params">user_id</span>):</span><br><span class="line">    session.regenerate_id()</span><br><span class="line">    session[<span class="string">&#x27;user_id&#x27;</span>] = user_id</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>CSRF Protection</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ✅ Use CSRF tokens</span></span><br><span class="line"><span class="keyword">const</span> csrfToken = <span class="title function_">generateCSRFToken</span>();</span><br><span class="line">res.<span class="title function_">cookie</span>(<span class="string">&#x27;csrf-token&#x27;</span>, csrfToken, &#123; <span class="attr">httpOnly</span>: <span class="literal">false</span> &#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Rate Limiting</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ✅ Implement progressive delays</span></span><br><span class="line">login_attempts = &#123;</span><br><span class="line">    <span class="number">1</span>: <span class="number">0</span>,      <span class="comment"># No delay</span></span><br><span class="line">    <span class="number">2</span>: <span class="number">1</span>,      <span class="comment"># 1 second</span></span><br><span class="line">    <span class="number">3</span>: <span class="number">5</span>,      <span class="comment"># 5 seconds</span></span><br><span class="line">    <span class="number">4</span>: <span class="number">15</span>,     <span class="comment"># 15 seconds</span></span><br><span class="line">    <span class="number">5</span>: <span class="number">60</span>      <span class="comment"># 1 minute</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>Interview Question:</strong> <em>“How would you prevent brute force attacks on login endpoints while maintaining good user experience?”</em></p>
<hr>
<h2 id="Database-Schema-Design"><a href="#Database-Schema-Design" class="headerlink" title="Database Schema Design"></a>Database Schema Design</h2><h3 id="Core-Tables"><a href="#Core-Tables" class="headerlink" title="Core Tables"></a>Core Tables</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Users table</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> users (</span><br><span class="line">    id UUID <span class="keyword">PRIMARY KEY</span> <span class="keyword">DEFAULT</span> gen_random_uuid(),</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">UNIQUE</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    password_hash <span class="type">VARCHAR</span>(<span class="number">255</span>),</span><br><span class="line">    first_name <span class="type">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">    last_name <span class="type">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">    email_verified <span class="type">BOOLEAN</span> <span class="keyword">DEFAULT</span> <span class="literal">FALSE</span>,</span><br><span class="line">    is_active <span class="type">BOOLEAN</span> <span class="keyword">DEFAULT</span> <span class="literal">TRUE</span>,</span><br><span class="line">    created_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    updated_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    last_login_at <span class="type">TIMESTAMP</span>,</span><br><span class="line">    failed_login_attempts <span class="type">INTEGER</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">    locked_until <span class="type">TIMESTAMP</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- SSO Providers</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> sso_providers (</span><br><span class="line">    id UUID <span class="keyword">PRIMARY KEY</span> <span class="keyword">DEFAULT</span> gen_random_uuid(),</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    type <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT NULL</span>, <span class="comment">-- &#x27;oauth&#x27;, &#x27;saml&#x27;, &#x27;oidc&#x27;</span></span><br><span class="line">    client_id <span class="type">VARCHAR</span>(<span class="number">255</span>),</span><br><span class="line">    client_secret <span class="type">VARCHAR</span>(<span class="number">255</span>),</span><br><span class="line">    authorization_url <span class="type">VARCHAR</span>(<span class="number">500</span>),</span><br><span class="line">    token_url <span class="type">VARCHAR</span>(<span class="number">500</span>),</span><br><span class="line">    user_info_url <span class="type">VARCHAR</span>(<span class="number">500</span>),</span><br><span class="line">    is_active <span class="type">BOOLEAN</span> <span class="keyword">DEFAULT</span> <span class="literal">TRUE</span>,</span><br><span class="line">    created_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- User SSO Connections</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> user_sso_connections (</span><br><span class="line">    id UUID <span class="keyword">PRIMARY KEY</span> <span class="keyword">DEFAULT</span> gen_random_uuid(),</span><br><span class="line">    user_id UUID <span class="keyword">REFERENCES</span> users(id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">    provider_id UUID <span class="keyword">REFERENCES</span> sso_providers(id),</span><br><span class="line">    external_user_id <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    access_token TEXT,</span><br><span class="line">    refresh_token TEXT,</span><br><span class="line">    token_expires_at <span class="type">TIMESTAMP</span>,</span><br><span class="line">    created_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    updated_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    <span class="keyword">UNIQUE</span>(provider_id, external_user_id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Refresh Tokens</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> refresh_tokens (</span><br><span class="line">    id UUID <span class="keyword">PRIMARY KEY</span> <span class="keyword">DEFAULT</span> gen_random_uuid(),</span><br><span class="line">    user_id UUID <span class="keyword">REFERENCES</span> users(id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">    token_hash <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">UNIQUE</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    expires_at <span class="type">TIMESTAMP</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    created_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    revoked_at <span class="type">TIMESTAMP</span>,</span><br><span class="line">    user_agent TEXT,</span><br><span class="line">    ip_address INET</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Roles and Permissions</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> roles (</span><br><span class="line">    id UUID <span class="keyword">PRIMARY KEY</span> <span class="keyword">DEFAULT</span> gen_random_uuid(),</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">UNIQUE</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    description TEXT,</span><br><span class="line">    created_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> permissions (</span><br><span class="line">    id UUID <span class="keyword">PRIMARY KEY</span> <span class="keyword">DEFAULT</span> gen_random_uuid(),</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">UNIQUE</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    resource <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    action <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    created_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> role_permissions (</span><br><span class="line">    role_id UUID <span class="keyword">REFERENCES</span> roles(id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">    permission_id UUID <span class="keyword">REFERENCES</span> permissions(id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">    <span class="keyword">PRIMARY KEY</span> (role_id, permission_id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> user_roles (</span><br><span class="line">    user_id UUID <span class="keyword">REFERENCES</span> users(id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">    role_id UUID <span class="keyword">REFERENCES</span> roles(id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">    assigned_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    assigned_by UUID <span class="keyword">REFERENCES</span> users(id),</span><br><span class="line">    <span class="keyword">PRIMARY KEY</span> (user_id, role_id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="Indexing-Strategy"><a href="#Indexing-Strategy" class="headerlink" title="Indexing Strategy"></a>Indexing Strategy</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Performance indexes</span></span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_users_email <span class="keyword">ON</span> users(email);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_users_active_email <span class="keyword">ON</span> users(email) <span class="keyword">WHERE</span> is_active <span class="operator">=</span> <span class="literal">TRUE</span>;</span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_refresh_tokens_user_id <span class="keyword">ON</span> refresh_tokens(user_id);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_refresh_tokens_expires <span class="keyword">ON</span> refresh_tokens(expires_at);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_user_sso_external_id <span class="keyword">ON</span> user_sso_connections(provider_id, external_user_id);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_user_roles_user_id <span class="keyword">ON</span> user_roles(user_id);</span><br></pre></td></tr></table></figure>

<p><strong>Interview Insight:</strong> <em>Discuss database normalization vs denormalization trade-offs. For high-traffic systems, consider denormalizing frequently accessed data like user permissions.</em></p>
<hr>
<h2 id="API-Design-and-Error-Handling"><a href="#API-Design-and-Error-Handling" class="headerlink" title="API Design and Error Handling"></a>API Design and Error Handling</h2><h3 id="Authentication-API-Endpoints"><a href="#Authentication-API-Endpoints" class="headerlink" title="Authentication API Endpoints"></a>Authentication API Endpoints</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># OpenAPI 3.0 Specification</span></span><br><span class="line"><span class="attr">paths:</span></span><br><span class="line">  <span class="string">/api/v1/auth/login:</span></span><br><span class="line">    <span class="attr">post:</span></span><br><span class="line">      <span class="attr">summary:</span> <span class="string">User</span> <span class="string">login</span></span><br><span class="line">      <span class="attr">requestBody:</span></span><br><span class="line">        <span class="attr">required:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">content:</span></span><br><span class="line">          <span class="attr">application/json:</span></span><br><span class="line">            <span class="attr">schema:</span></span><br><span class="line">              <span class="string">$ref:</span> <span class="string">&#x27;#/components/schemas/LoginRequest&#x27;</span></span><br><span class="line">      <span class="attr">responses:</span></span><br><span class="line">        <span class="attr">&#x27;200&#x27;:</span></span><br><span class="line">          <span class="attr">description:</span> <span class="string">Login</span> <span class="string">successful</span></span><br><span class="line">          <span class="attr">content:</span></span><br><span class="line">            <span class="attr">application/json:</span></span><br><span class="line">              <span class="attr">schema:</span></span><br><span class="line">                <span class="string">$ref:</span> <span class="string">&#x27;#/components/schemas/AuthResponse&#x27;</span></span><br><span class="line">        <span class="attr">&#x27;400&#x27;:</span></span><br><span class="line">          <span class="attr">description:</span> <span class="string">Invalid</span> <span class="string">credentials</span></span><br><span class="line">        <span class="attr">&#x27;429&#x27;:</span></span><br><span class="line">          <span class="attr">description:</span> <span class="string">Too</span> <span class="string">many</span> <span class="string">login</span> <span class="string">attempts</span></span><br><span class="line">        <span class="attr">&#x27;423&#x27;:</span></span><br><span class="line">          <span class="attr">description:</span> <span class="string">Account</span> <span class="string">locked</span></span><br><span class="line"></span><br><span class="line">  <span class="string">/api/v1/auth/sso/&#123;provider&#125;/authorize:</span></span><br><span class="line">    <span class="attr">get:</span></span><br><span class="line">      <span class="attr">summary:</span> <span class="string">Initiate</span> <span class="string">SSO</span> <span class="string">login</span></span><br><span class="line">      <span class="attr">parameters:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">provider</span></span><br><span class="line">          <span class="attr">in:</span> <span class="string">path</span></span><br><span class="line">          <span class="attr">required:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">schema:</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">string</span></span><br><span class="line">            <span class="attr">enum:</span> [<span class="string">google</span>, <span class="string">microsoft</span>, <span class="string">okta</span>]</span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">redirect_uri</span></span><br><span class="line">          <span class="attr">in:</span> <span class="string">query</span></span><br><span class="line">          <span class="attr">schema:</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">string</span></span><br><span class="line">      <span class="attr">responses:</span></span><br><span class="line">        <span class="attr">&#x27;302&#x27;:</span></span><br><span class="line">          <span class="attr">description:</span> <span class="string">Redirect</span> <span class="string">to</span> <span class="string">SSO</span> <span class="string">provider</span></span><br><span class="line">        <span class="attr">&#x27;400&#x27;:</span></span><br><span class="line">          <span class="attr">description:</span> <span class="string">Invalid</span> <span class="string">provider</span> <span class="string">or</span> <span class="string">redirect</span> <span class="string">URI</span></span><br></pre></td></tr></table></figure>

<h3 id="Error-Response-Format"><a href="#Error-Response-Format" class="headerlink" title="Error Response Format"></a>Error Response Format</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;error&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;code&quot;</span><span class="punctuation">:</span> <span class="string">&quot;INVALID_CREDENTIALS&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;The email or password you entered is incorrect.&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;details&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;field&quot;</span><span class="punctuation">:</span> <span class="string">&quot;password&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;attempts_remaining&quot;</span><span class="punctuation">:</span> <span class="number">3</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;request_id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;req_1234567890&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;timestamp&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2024-01-15T10:30:00Z&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Status-Code-Strategy"><a href="#Status-Code-Strategy" class="headerlink" title="Status Code Strategy"></a>Status Code Strategy</h3><table>
<thead>
<tr>
<th>Status Code</th>
<th>Use Case</th>
<th>Example</th>
</tr>
</thead>
<tbody><tr>
<td>200</td>
<td>Successful authentication</td>
<td>Login success</td>
</tr>
<tr>
<td>400</td>
<td>Client error</td>
<td>Invalid email format</td>
</tr>
<tr>
<td>401</td>
<td>Authentication failed</td>
<td>Wrong password</td>
</tr>
<tr>
<td>403</td>
<td>Insufficient permissions</td>
<td>Access denied</td>
</tr>
<tr>
<td>423</td>
<td>Account locked</td>
<td>Too many failed attempts</td>
</tr>
<tr>
<td>429</td>
<td>Rate limited</td>
<td>Too many requests</td>
</tr>
<tr>
<td>500</td>
<td>Server error</td>
<td>Database connection failed</td>
</tr>
</tbody></table>
<p><strong>Interview Question:</strong> <em>“How would you design error responses to be helpful for developers while not exposing security vulnerabilities?”</em></p>
<hr>
<h2 id="User-Experience-and-Frontend-Integration"><a href="#User-Experience-and-Frontend-Integration" class="headerlink" title="User Experience and Frontend Integration"></a>User Experience and Frontend Integration</h2><h3 id="Login-Flow-States"><a href="#Login-Flow-States" class="headerlink" title="Login Flow States"></a>Login Flow States</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">stateDiagram-v2</span><br><span class="line">    [*] --&gt; Initial</span><br><span class="line">    Initial --&gt; Loading: Submit credentials</span><br><span class="line">    Loading --&gt; Success: Valid credentials</span><br><span class="line">    Loading --&gt; Error: Invalid credentials</span><br><span class="line">    Loading --&gt; MFA: MFA required</span><br><span class="line">    MFA --&gt; MFALoading: Submit MFA code</span><br><span class="line">    MFALoading --&gt; Success: Valid code</span><br><span class="line">    MFALoading --&gt; MFAError: Invalid code</span><br><span class="line">    Error --&gt; Initial: Try again</span><br><span class="line">    MFAError --&gt; MFA: Try again</span><br><span class="line">    Success --&gt; [*]</span><br></pre></td></tr></table></figure>

<h3 id="Frontend-Integration-Example"><a href="#Frontend-Integration-Example" class="headerlink" title="Frontend Integration Example"></a>Frontend Integration Example</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// React Hook for Authentication</span></span><br><span class="line"><span class="keyword">import</span> &#123; useState, useEffect, useContext &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">useAuth</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> [user, setUser] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> [loading, setLoading] = <span class="title function_">useState</span>(<span class="literal">true</span>);</span><br><span class="line">  <span class="keyword">const</span> [error, setError] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">login</span> = <span class="keyword">async</span> (<span class="params">credentials</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="title function_">setLoading</span>(<span class="literal">true</span>);</span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/v1/auth/login&#x27;</span>, &#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">        <span class="attr">headers</span>: &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span> &#125;,</span><br><span class="line">        <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(credentials),</span><br><span class="line">      &#125;);</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">if</span> (!response.<span class="property">ok</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="keyword">await</span> response.<span class="title function_">text</span>());</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">      <span class="title function_">setUser</span>(data.<span class="property">user</span>);</span><br><span class="line">      <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;auth_token&#x27;</span>, data.<span class="property">token</span>);</span><br><span class="line">      <span class="keyword">return</span> data;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="title function_">setError</span>(err.<span class="property">message</span>);</span><br><span class="line">      <span class="keyword">throw</span> err;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="title function_">setLoading</span>(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">loginWithSSO</span> = (<span class="params">provider</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">`/api/v1/auth/sso/<span class="subst">$&#123;provider&#125;</span>/authorize?redirect_uri=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(<span class="variable language_">window</span>.location.origin)&#125;</span>`</span>;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">logout</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/v1/auth/logout&#x27;</span>, &#123; <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span> &#125;);</span><br><span class="line">      <span class="title function_">setUser</span>(<span class="literal">null</span>);</span><br><span class="line">      <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&#x27;auth_token&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Logout error:&#x27;</span>, err);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; user, loading, error, login, loginWithSSO, logout &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="Progressive-Enhancement"><a href="#Progressive-Enhancement" class="headerlink" title="Progressive Enhancement"></a>Progressive Enhancement</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Graceful degradation for SSO</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">SSOButton</span> = (<span class="params">&#123; provider, onFallback &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleSSOLogin</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// Check if popup is blocked</span></span><br><span class="line">    <span class="keyword">const</span> popup = <span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;_blank&#x27;</span>, <span class="string">&#x27;width=500,height=600&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!popup || popup.<span class="property">closed</span>) &#123;</span><br><span class="line">      <span class="comment">// Fallback to redirect</span></span><br><span class="line">      <span class="title function_">onFallback</span>();</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Use popup for better UX</span></span><br><span class="line">    popup.<span class="property">location</span>.<span class="property">href</span> = <span class="string">`/auth/sso/<span class="subst">$&#123;provider&#125;</span>`</span>;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleSSOLogin&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      Continue with &#123;provider&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>Interview Insight:</strong> <em>Discuss accessibility considerations: keyboard navigation, screen readers, color contrast, and error message clarity. Many candidates overlook these aspects.</em></p>
<hr>
<h2 id="Testing-and-Monitoring"><a href="#Testing-and-Monitoring" class="headerlink" title="Testing and Monitoring"></a>Testing and Monitoring</h2><h3 id="Test-Strategy"><a href="#Test-Strategy" class="headerlink" title="Test Strategy"></a>Test Strategy</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Example test cases for authentication</span></span><br><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="keyword">from</span> unittest.mock <span class="keyword">import</span> Mock, patch</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestAuthenticationService</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_login_success</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Test successful login with valid credentials&quot;&quot;&quot;</span></span><br><span class="line">        service = AuthenticationService()</span><br><span class="line">        result = service.login(<span class="string">&quot;user@example.com&quot;</span>, <span class="string">&quot;correct_password&quot;</span>)</span><br><span class="line">        <span class="keyword">assert</span> result.success <span class="keyword">is</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">assert</span> result.token <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_login_invalid_credentials</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Test login failure with invalid credentials&quot;&quot;&quot;</span></span><br><span class="line">        service = AuthenticationService()</span><br><span class="line">        result = service.login(<span class="string">&quot;user@example.com&quot;</span>, <span class="string">&quot;wrong_password&quot;</span>)</span><br><span class="line">        <span class="keyword">assert</span> result.success <span class="keyword">is</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">assert</span> result.error_code == <span class="string">&quot;INVALID_CREDENTIALS&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_account_lockout</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Test account lockout after multiple failed attempts&quot;&quot;&quot;</span></span><br><span class="line">        service = AuthenticationService()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Simulate multiple failed attempts</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            service.login(<span class="string">&quot;user@example.com&quot;</span>, <span class="string">&quot;wrong_password&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        result = service.login(<span class="string">&quot;user@example.com&quot;</span>, <span class="string">&quot;correct_password&quot;</span>)</span><br><span class="line">        <span class="keyword">assert</span> result.error_code == <span class="string">&quot;ACCOUNT_LOCKED&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">    @patch(<span class="params"><span class="string">&#x27;requests.post&#x27;</span></span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_sso_login_success</span>(<span class="params">self, mock_post</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Test successful SSO login&quot;&quot;&quot;</span></span><br><span class="line">        mock_post.return_value.json.return_value = &#123;</span><br><span class="line">            <span class="string">&#x27;access_token&#x27;</span>: <span class="string">&#x27;mock_token&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;user_info&#x27;</span>: &#123;<span class="string">&#x27;email&#x27;</span>: <span class="string">&#x27;user@example.com&#x27;</span>&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        service = SSOService()</span><br><span class="line">        result = service.authenticate_with_provider(<span class="string">&#x27;google&#x27;</span>, <span class="string">&#x27;auth_code&#x27;</span>)</span><br><span class="line">        <span class="keyword">assert</span> result.success <span class="keyword">is</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h3 id="End-to-End-Testing"><a href="#End-to-End-Testing" class="headerlink" title="End-to-End Testing"></a>End-to-End Testing</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Cypress E2E tests</span></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;Authentication Flow&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should login with valid credentials&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    cy.<span class="title function_">visit</span>(<span class="string">&#x27;/login&#x27;</span>);</span><br><span class="line">    cy.<span class="title function_">get</span>(<span class="string">&#x27;[data-testid=&quot;email-input&quot;]&#x27;</span>).<span class="title function_">type</span>(<span class="string">&#x27;user@example.com&#x27;</span>);</span><br><span class="line">    cy.<span class="title function_">get</span>(<span class="string">&#x27;[data-testid=&quot;password-input&quot;]&#x27;</span>).<span class="title function_">type</span>(<span class="string">&#x27;password123&#x27;</span>);</span><br><span class="line">    cy.<span class="title function_">get</span>(<span class="string">&#x27;[data-testid=&quot;login-button&quot;]&#x27;</span>).<span class="title function_">click</span>();</span><br><span class="line">    cy.<span class="title function_">url</span>().<span class="title function_">should</span>(<span class="string">&#x27;include&#x27;</span>, <span class="string">&#x27;/dashboard&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should handle SSO login&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    cy.<span class="title function_">visit</span>(<span class="string">&#x27;/login&#x27;</span>);</span><br><span class="line">    cy.<span class="title function_">get</span>(<span class="string">&#x27;[data-testid=&quot;google-sso-button&quot;]&#x27;</span>).<span class="title function_">click</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Mock SSO callback</span></span><br><span class="line">    cy.<span class="title function_">window</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">win</span>) =&gt;</span> &#123;</span><br><span class="line">      win.<span class="title function_">postMessage</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;SSO_SUCCESS&#x27;</span>,</span><br><span class="line">        <span class="attr">user</span>: &#123; <span class="attr">email</span>: <span class="string">&#x27;user@example.com&#x27;</span> &#125;</span><br><span class="line">      &#125;, <span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    cy.<span class="title function_">url</span>().<span class="title function_">should</span>(<span class="string">&#x27;include&#x27;</span>, <span class="string">&#x27;/dashboard&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Monitoring-Alerting"><a href="#Monitoring-Alerting" class="headerlink" title="Monitoring &amp; Alerting"></a>Monitoring &amp; Alerting</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Prometheus metrics</span></span><br><span class="line"><span class="attr">authentication_attempts_total:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">counter</span></span><br><span class="line">  <span class="attr">labels:</span> [<span class="string">method</span>, <span class="string">status</span>]</span><br><span class="line">  <span class="attr">description:</span> <span class="string">&quot;Total authentication attempts&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">authentication_duration_seconds:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">histogram</span></span><br><span class="line">  <span class="attr">labels:</span> [<span class="string">method</span>]</span><br><span class="line">  <span class="attr">description:</span> <span class="string">&quot;Authentication request duration&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">active_sessions_total:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">gauge</span></span><br><span class="line">  <span class="attr">description:</span> <span class="string">&quot;Number of active user sessions&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">failed_login_attempts_total:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">counter</span></span><br><span class="line">  <span class="attr">labels:</span> [<span class="string">reason</span>]</span><br><span class="line">  <span class="attr">description:</span> <span class="string">&quot;Failed login attempts by reason&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="Key-Metrics-to-Monitor"><a href="#Key-Metrics-to-Monitor" class="headerlink" title="Key Metrics to Monitor"></a>Key Metrics to Monitor</h3><ol>
<li><p><strong>Authentication Success Rate</strong></p>
<ul>
<li>Target: &gt;99.5%</li>
<li>Alert: &lt;95% over 5 minutes</li>
</ul>
</li>
<li><p><strong>Response Time</strong></p>
<ul>
<li>Target: &lt;200ms p95</li>
<li>Alert: &gt;500ms p95 over 2 minutes</li>
</ul>
</li>
<li><p><strong>Account Lockouts</strong></p>
<ul>
<li>Alert: &gt;10 lockouts per hour</li>
</ul>
</li>
<li><p><strong>SSO Provider Health</strong></p>
<ul>
<li>Monitor: Response times and error rates</li>
<li>Alert: &gt;5% error rate</li>
</ul>
</li>
</ol>
<p><strong>Interview Question:</strong> <em>“What metrics would you monitor for an authentication system, and what would trigger alerts?”</em></p>
<hr>
<h2 id="Performance-and-Scalability"><a href="#Performance-and-Scalability" class="headerlink" title="Performance and Scalability"></a>Performance and Scalability</h2><h3 id="Caching-Strategies"><a href="#Caching-Strategies" class="headerlink" title="Caching Strategies"></a>Caching Strategies</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Redis caching for authentication</span></span><br><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> timedelta</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AuthCache</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.redis_client = redis.Redis(host=<span class="string">&#x27;localhost&#x27;</span>, port=<span class="number">6379</span>, db=<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">cache_user_session</span>(<span class="params">self, user_id: <span class="built_in">str</span>, session_data: <span class="built_in">dict</span>, ttl: <span class="built_in">int</span> = <span class="number">3600</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Cache user session data&quot;&quot;&quot;</span></span><br><span class="line">        key = <span class="string">f&quot;session:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.redis_client.setex(key, ttl, json.dumps(session_data))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_user_session</span>(<span class="params">self, user_id: <span class="built_in">str</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Retrieve cached user session&quot;&quot;&quot;</span></span><br><span class="line">        key = <span class="string">f&quot;session:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">        data = <span class="variable language_">self</span>.redis_client.get(key)</span><br><span class="line">        <span class="keyword">return</span> json.loads(data) <span class="keyword">if</span> data <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">cache_user_permissions</span>(<span class="params">self, user_id: <span class="built_in">str</span>, permissions: <span class="built_in">list</span>, ttl: <span class="built_in">int</span> = <span class="number">1800</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Cache user permissions for faster authorization&quot;&quot;&quot;</span></span><br><span class="line">        key = <span class="string">f&quot;permissions:<span class="subst">&#123;user_id&#125;</span>&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.redis_client.setex(key, ttl, json.dumps(permissions))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">invalidate_user_cache</span>(<span class="params">self, user_id: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Invalidate all cached data for a user&quot;&quot;&quot;</span></span><br><span class="line">        patterns = [<span class="string">f&quot;session:<span class="subst">&#123;user_id&#125;</span>&quot;</span>, <span class="string">f&quot;permissions:<span class="subst">&#123;user_id&#125;</span>&quot;</span>]</span><br><span class="line">        <span class="keyword">for</span> pattern <span class="keyword">in</span> patterns:</span><br><span class="line">            <span class="variable language_">self</span>.redis_client.delete(pattern)</span><br></pre></td></tr></table></figure>

<h3 id="Database-Connection-Pooling"><a href="#Database-Connection-Pooling" class="headerlink" title="Database Connection Pooling"></a>Database Connection Pooling</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># SQLAlchemy connection pooling</span></span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine</span><br><span class="line"><span class="keyword">from</span> sqlalchemy.pool <span class="keyword">import</span> QueuePool</span><br><span class="line"></span><br><span class="line">engine = create_engine(</span><br><span class="line">    <span class="string">&quot;postgresql://user:password@localhost/auth_db&quot;</span>,</span><br><span class="line">    poolclass=QueuePool,</span><br><span class="line">    pool_size=<span class="number">20</span>,          <span class="comment"># Number of connections to maintain</span></span><br><span class="line">    max_overflow=<span class="number">30</span>,       <span class="comment"># Additional connections when needed</span></span><br><span class="line">    pool_pre_ping=<span class="literal">True</span>,    <span class="comment"># Validate connections before use</span></span><br><span class="line">    pool_recycle=<span class="number">3600</span>,     <span class="comment"># Recycle connections after 1 hour</span></span><br><span class="line">    echo=<span class="literal">False</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="Load-Balancing-Considerations"><a href="#Load-Balancing-Considerations" class="headerlink" title="Load Balancing Considerations"></a>Load Balancing Considerations</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Nginx load balancer configuration</span></span><br><span class="line"><span class="string">upstream</span> <span class="string">auth_backend</span> &#123;</span><br><span class="line">    <span class="string">least_conn;</span></span><br><span class="line">    <span class="string">server</span> <span class="string">auth-server-1:8000</span> <span class="string">weight=3;</span></span><br><span class="line">    <span class="string">server</span> <span class="string">auth-server-2:8000</span> <span class="string">weight=3;</span></span><br><span class="line">    <span class="string">server</span> <span class="string">auth-server-3:8000</span> <span class="string">weight=2;</span></span><br><span class="line">    <span class="string">keepalive</span> <span class="number">32</span><span class="string">;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">server</span> &#123;</span><br><span class="line">    <span class="string">listen</span> <span class="number">443</span> <span class="string">ssl;</span></span><br><span class="line">    <span class="string">server_name</span> <span class="string">auth.example.com;</span></span><br><span class="line">    </span><br><span class="line">    <span class="string">location</span> <span class="string">/api/v1/auth</span> &#123;</span><br><span class="line">        <span class="string">proxy_pass</span> <span class="string">http://auth_backend;</span></span><br><span class="line">        <span class="string">proxy_set_header</span> <span class="string">Host</span> <span class="string">$host;</span></span><br><span class="line">        <span class="string">proxy_set_header</span> <span class="string">X-Real-IP</span> <span class="string">$remote_addr;</span></span><br><span class="line">        <span class="string">proxy_set_header</span> <span class="string">X-Forwarded-For</span> <span class="string">$proxy_add_x_forwarded_for;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Session affinity for stateful sessions</span></span><br><span class="line">        <span class="string">ip_hash;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Horizontal-Scaling-Architecture"><a href="#Horizontal-Scaling-Architecture" class="headerlink" title="Horizontal Scaling Architecture"></a>Horizontal Scaling Architecture</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">graph TB</span><br><span class="line">    A[Load Balancer] --&gt; B[Auth Service 1]</span><br><span class="line">    A --&gt; C[Auth Service 2]</span><br><span class="line">    A --&gt; D[Auth Service 3]</span><br><span class="line">    </span><br><span class="line">    B --&gt; E[Redis Cluster]</span><br><span class="line">    C --&gt; E</span><br><span class="line">    D --&gt; E</span><br><span class="line">    </span><br><span class="line">    B --&gt; F[PostgreSQL Primary]</span><br><span class="line">    C --&gt; G[PostgreSQL Replica 1]</span><br><span class="line">    D --&gt; H[PostgreSQL Replica 2]</span><br><span class="line">    </span><br><span class="line">    F --&gt; G</span><br><span class="line">    F --&gt; H</span><br><span class="line">    </span><br><span class="line">    I[Message Queue] --&gt; B</span><br><span class="line">    I --&gt; C</span><br><span class="line">    I --&gt; D</span><br></pre></td></tr></table></figure>

<h3 id="Performance-Optimization-Checklist"><a href="#Performance-Optimization-Checklist" class="headerlink" title="Performance Optimization Checklist"></a>Performance Optimization Checklist</h3><ul>
<li><p><input disabled="" type="checkbox"> 
<strong>Database Optimization</strong></p>
<ul>
<li>Proper indexing on frequently queried columns</li>
<li>Connection pooling</li>
<li>Read replicas for user lookups</li>
<li>Query optimization for complex permission checks</li>
</ul>
</li>
<li><p><input disabled="" type="checkbox"> 
<strong>Caching Strategy</strong></p>
<ul>
<li>Redis for session storage</li>
<li>Cache user permissions and roles</li>
<li>CDN for static assets</li>
<li>HTTP caching headers</li>
</ul>
</li>
<li><p><input disabled="" type="checkbox"> 
<strong>Network Optimization</strong></p>
<ul>
<li>Compress responses (gzip)</li>
<li>Minimize API round trips</li>
<li>Use HTTP&#x2F;2</li>
<li>Implement proper timeout configurations</li>
</ul>
</li>
<li><p><input disabled="" type="checkbox"> 
<strong>Code Optimization</strong></p>
<ul>
<li>Async&#x2F;await for I&#x2F;O operations</li>
<li>Batch database operations</li>
<li>Lazy loading for user data</li>
<li>Efficient JWT token verification</li>
</ul>
</li>
</ul>
<p><strong>Interview Question:</strong> <em>“How would you handle 10,000 concurrent login requests while maintaining sub-200ms response times?”</em></p>
<hr>
<h2 id="Advanced-Topics"><a href="#Advanced-Topics" class="headerlink" title="Advanced Topics"></a>Advanced Topics</h2><h3 id="Multi-Factor-Authentication-MFA"><a href="#Multi-Factor-Authentication-MFA" class="headerlink" title="Multi-Factor Authentication (MFA)"></a>Multi-Factor Authentication (MFA)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># TOTP implementation example</span></span><br><span class="line"><span class="keyword">import</span> pyotp</span><br><span class="line"><span class="keyword">import</span> qrcode</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MFAService</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">generate_secret</span>(<span class="params">self, user_email: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Generate TOTP secret for user&quot;&quot;&quot;</span></span><br><span class="line">        secret = pyotp.random_base32()</span><br><span class="line">        <span class="keyword">return</span> secret</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">generate_qr_code</span>(<span class="params">self, user_email: <span class="built_in">str</span>, secret: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Generate QR code for authenticator app setup&quot;&quot;&quot;</span></span><br><span class="line">        totp_uri = pyotp.totp.TOTP(secret).provisioning_uri(</span><br><span class="line">            name=user_email,</span><br><span class="line">            issuer_name=<span class="string">&quot;Your App Name&quot;</span></span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        qr = qrcode.QRCode(version=<span class="number">1</span>, box_size=<span class="number">10</span>, border=<span class="number">5</span>)</span><br><span class="line">        qr.add_data(totp_uri)</span><br><span class="line">        qr.make(fit=<span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">        img = qr.make_image(fill=<span class="string">&#x27;black&#x27;</span>, back_color=<span class="string">&#x27;white&#x27;</span>)</span><br><span class="line">        buffer = BytesIO()</span><br><span class="line">        img.save(buffer, <span class="built_in">format</span>=<span class="string">&#x27;PNG&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> buffer.getvalue()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify_totp</span>(<span class="params">self, secret: <span class="built_in">str</span>, token: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Verify TOTP token&quot;&quot;&quot;</span></span><br><span class="line">        totp = pyotp.TOTP(secret)</span><br><span class="line">        <span class="keyword">return</span> totp.verify(token, valid_window=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Zero-Trust-Architecture"><a href="#Zero-Trust-Architecture" class="headerlink" title="Zero-Trust Architecture"></a>Zero-Trust Architecture</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">graph TB</span><br><span class="line">    A[User Request] --&gt; B[Identity Verification]</span><br><span class="line">    B --&gt; C[Device Trust Check]</span><br><span class="line">    C --&gt; D[Network Analysis]</span><br><span class="line">    D --&gt; E[Risk Assessment]</span><br><span class="line">    E --&gt; F[Conditional Access]</span><br><span class="line">    F --&gt; G[Continuous Monitoring]</span><br><span class="line">    </span><br><span class="line">    B --&gt; H[MFA Required?]</span><br><span class="line">    C --&gt; I[Device Compliance]</span><br><span class="line">    D --&gt; J[Location Analysis]</span><br><span class="line">    E --&gt; K[Behavioral Analytics]</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/system-design/" rel="tag"># system-design</a>
              <a href="/tags/user-login-system/" rel="tag"># user login system</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/06/12/Design-Grey-Service-Router-Guide/" rel="prev" title="Design Grey Service Router Guide">
                  <i class="fa fa-angle-left"></i> Design Grey Service Router Guide
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Charlie Feng</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
